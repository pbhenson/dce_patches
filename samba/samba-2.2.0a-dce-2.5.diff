diff -d -r -c samba-2.2.0a/docs/textdocs/README.DCEDFS samba-2.2.0a-dce-2.5/docs/textdocs/README.DCEDFS
*** samba-2.2.0a/docs/textdocs/README.DCEDFS	Sat Jun 28 16:29:02 1997
--- samba-2.2.0a-dce-2.5/docs/textdocs/README.DCEDFS	Tue Jul 24 17:51:30 2001
***************
*** 1,78 ****
! Contributor:	Jim Doyle <doyle@oec.com>
! Date:		06-02-95
! Status:		Current but needs updating
  
! Subject:	Basic DCE/DFS Support for SAMBA 1.9.13
! =============================================================================
  
! Functionality:
! --------------
! 	
! 	Per-instance authentication for DCE/DFS.
!  
! Missing Functionality in this Implementation:
! ---------------------------------------------
  
! 	* No automatic refresh of credentials
  
- 	  To do so would not be that hard.. One could simply
- 	  stash the clear-text key in memory, spawn a key management
- 	  thread to wake up right before credentials expire and
- 	  refresh the login context.
  
! 	* No UNIX Signals support (SIGCLD, SIGPIPE, SIGHUP, SIGBUS, SIGSEGV)
  
  
! 	  There is no support for signal processing in Samba daemons
! 	  that need to authenticate with DCE. The explanation for this
! 	  is that the smbd is linked against thread-safe libraries in
! 	  order to be able to use DCE authentication mechanisms. 
! 	  Because smbd uses signal() and fork(), it represents the
! 	  worst case scenario for DCE portability. In order
! 	  to properly support signals in a forked server environment,
! 	  some rework of smbd is needed in order to properly
! 	  construct, shutdown and reconstruct asynchronous signal
! 	  handling threads and synchronous signal traps across the
! 	  parent and child. I have not had contiguous time to work
! 	  on it, I expect it to be a weeks worth of work to cleanly
! 	  integrate thread-safe signal handing into the code and 
! 	  test it. Until I can get to this task, I will leave it up
! 	  to someone adventurous enough to engineer it and negotiate
! 	  with Andrew to integrate the changes into the mainline branch.
  
! 	  The lack of full signal support means that you cannot
! 	  rely upon SIGHUP-ing the parent daemon to refresh
!           the configuration data. Likewise, you cannot take advantage
! 	  of the builtin SIGBUS/SIGSEGV traps to diagnose failures.
! 	  You will have to halt Samba in order to make changes
! 	  and then have them take effect.
  
- 	  The SMBD server as it stands is suitable to use if you
- 	  already have experience with configuring and running
- 	  SAMBA.
  
! Tested Platforms:
! -----------------
  
! 		HP-UX 9.05 / HP-UX DCE 1.2.1
! 		AIX 3.2.5  / AIX DCE/6000 1.3
! 		DEC OSF-1 3.0 / DEC DCE 1.3
  
- Building:
- ---------
  
! 	- Uncomment the the appropriate block in the Makefile
! 	  for the platform you wish to build on.
  
! 	- Samples of Samba server configuration files for our
! 	  DFS environment are included in samples.dcedfs/
  
  
  
! Bugs, Suggestions, etc..
! --------------------------
  
- 	Please post them to the mailing list. 
- 	That way I will see them and they will become part of 
- 	the archives so others can share the knowledge.
  
--- 1,165 ----
! DCE authentication/DFS fileset support (version 2.5) for samba 2.2.0a
! ---------------------------------------------------------------------
  
! The following configure options control the level of DCE/DFS support
! available:
  
! --with-dce
  
!   Include basic DCE support, which allows plaintext authentication.
!   Only one DCE-authenticated connection at a time is allowed.
  
  
! --with-dce-encrypted
  
+   Include support for Microsoft challenge/response authentication.
+   This requires the sec_auth package available at
  
!     http://www.csupomona.edu/~henson/www/projects/sec_auth/
  
!   Encrypted password support allows use of the 'encrypt passwords'
!   option in your smb.conf file. It also supports the
!   'update encrypted' option, which allows you to automatically
!   collect the necessary data for encrypted password operation while
!   running in plaintext password mode.
  
  
! --with-dce-refresh
  
!   Include support for automatically refreshing DCE credentials.
!   This requires storing the password in memory, so is a security
!   vs. convenience tradeoff.
  
  
! --with-dce-wts
  
!   Include support for Window Terminal Server style connection
!   multiplexing, allowing multiple DCE-authenticated users to connect
!   simultaneously. This option requires the availability of
!   resetpag() and installpag() in your DCE library. If credentials
!   are stored some place other than /opt/dcelocal/var/security/creds
!   on your platform, edit the file source/smbd/dcedfs.c and change
!   the DCE_CREDS_DIR and DCE_CREDS_DIR_LEN definitions.
  
  
+ --with-dce-ibm-kludge
  
!   Include a workaround for the broken sec_login_valid_and_cert_ident()
!   call in newer versions of IBM DCE, including DCE 3.1 for Solaris 7/8
!   and AIX, and some earlier versions of DCE for AIX. If credentials
!   are stored some place other than /opt/dcelocal/var/security/creds
!   on your platform, edit the file source/smbd/dcedfs.c and change 
!   the DCE_CREDS_DIR and DCE_CREDS_DIR_LEN definitions.
  
  
+ --with-dfs
+ 
+   Include support for DFS fileset quota reporting (also requires the
+   --with-quotas option) and saner interpretation of DFS acls. This
+   option requires the availability of a DFS API development kit.
+   Kits for Solaris and AIX are available from 
+ 
+     http://www.transarc.ibm.com/Product/EFS/DFS/libdcedfs/
+ 
+   Note that as distributed, the kit names the library libdfs. samba
+   expects this library to be named libdcedfs. Rename it, symlink it,
+   or update the samba Makefile.
+ 
+ 
+ --with-calpoly-underscore
+ 
+   Include support for allowing underscore characters in services
+   names (by default, samba will replace underscores with slashes).
+   Note that this option has absolutely nothing to do with DCE/DFS,
+   and I didn't used to include it in the patch. However, I'd always
+   forget to implement it when upgrading, so now you're stuck with it.
+ 
+ 
+ Changes
+ -------
+ 
+ 2.5 - Updated for samba 2.2.0a.
+ 
+     - Reintroduced Windows Terminal Server support. This time I
+       think it works.
+ 
+     - Added workaround for broken sec_login_valid_and_cert_ident()
+       call in newer versions of IBM DCE.
+ 
+     - Included --with-calpoly-underscore option in patch. Previously
+       an internal-only option.
+ 
+     - Fixed incorrect quota reporting when usage exceeded quota.
+       Thanks to Markus Zahn <Markus.Zahn@RZ.Uni-Augsburg.DE> for
+       patch.
+ 
+ 
+ 2.0 - Removed the vestiges of Windows Terminal Server support. This
+       version will only allow one DCE-authenticated user per server
+       process.
+ 
+     - Added DCE context refreshing.
+ 
+     - Updated for samba 2.0.7.
+ 
+ 
+ 1.6 - Support for Windows Terminal Server type clients did not work out
+       quite as planned. Due to the peculiar behavior of
+       sec_login_set_context, which generates a new hard link to the
+       credentials on every call, the systems credentials directory
+       quickly ran out of inodes. This temporary fix release removes that
+       support, but leaves the framework and hopefully a future release
+       will implement the functionality without the credential explosion
+       problem.
+ 
+ 
+ 1.5 - Updated for samba 2.0.5a.
+ 
+     - Updated encrypted password authentication support to be compliant
+       with sec_auth 1.0 API.
+ 
+     - Improved encrypted password fault tolerance when multiple sec_auth
+       servers are available.
+ 
+     - Added support for Windows Terminal Server type clients that
+       multiplex multiple users over a single connection. Note that this
+       support has not yet been tested, although theoretically it should
+       work fine ;)...
+ 
+ 
+ 1.0 - Updated for samba 2.0.4b.
+ 
+     - Added support for encrypted passwords.
+ 
+ 
+ 0.5 - First publicly released version.
+ 
+ 
+ Feedback/Availability
+ ---------------------
+ 
+ Please report problems/requests to <henson@acm.org>.
+ 
+ The latest version of this patch is currently available at:
+ 
+      http://www.csupomona.edu/~henson/www/projects/dce_patches/samba/
+ 
+ 
+ ---------------------------------------------------------------------------
+   Copyright (C) 1999-2001 Paul B. Henson <henson@acm.org>
+ 
+    This patch is free software; you can redistribute it and/or modify
+    it under the terms of the GNU General Public License as published by
+    the Free Software Foundation; either version 1, or (at your option)
+    any later version.
+ 
+    This patch is distributed in the hope that it will be useful,
+    but WITHOUT ANY WARRANTY; without even the implied warranty of
+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+    GNU General Public License for more details.
+ 
+    For a copy of the GNU General Public License, write to the Free
+    Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ 
+    The GNU General Public License is, as of this writing, also available
+    at http://www.gnu.org/copyleft/gpl.html
diff -d -r -c samba-2.2.0a/source/Makefile.in samba-2.2.0a-dce-2.5/source/Makefile.in
*** samba-2.2.0a/source/Makefile.in	Sun Apr 15 18:26:21 2001
--- samba-2.2.0a-dce-2.5/source/Makefile.in	Fri Jul  6 12:42:34 2001
***************
*** 151,162 ****
  		 rpc_client/cli_lsarpc.o rpc_client/cli_connect.o \
  		 rpc_client/cli_use.o rpc_client/cli_login.o \
  		 rpc_client/cli_spoolss_notify.o rpc_client/ncacn_np_use.o \
! 		 lib/util_list.o
  
  LOCKING_OBJ = locking/locking.o locking/brlock.o locking/posix.o
  
  PASSDB_OBJ = passdb/passdb.o passdb/smbpassfile.o passdb/smbpass.o passdb/secrets.o \
!              passdb/pass_check.o passdb/ldap.o passdb/nispass.o passdb/smbpasschange.o \
  	     passdb/tdbpass.o passdb/pampass.o
  
  PROFILE_OBJ = profile/profile.o
--- 151,162 ----
  		 rpc_client/cli_lsarpc.o rpc_client/cli_connect.o \
  		 rpc_client/cli_use.o rpc_client/cli_login.o \
  		 rpc_client/cli_spoolss_notify.o rpc_client/ncacn_np_use.o \
! 		 lib/util_list.o smbd/dcedfs.o
  
  LOCKING_OBJ = locking/locking.o locking/brlock.o locking/posix.o
  
  PASSDB_OBJ = passdb/passdb.o passdb/smbpassfile.o passdb/smbpass.o passdb/secrets.o \
!              passdb/pass_check.o passdb/dce_pass.o passdb/ldap.o passdb/nispass.o passdb/smbpasschange.o \
  	     passdb/tdbpass.o passdb/pampass.o
  
  PROFILE_OBJ = profile/profile.o
***************
*** 167,173 ****
  
  SMBD_OBJ1 = smbd/server.o smbd/files.o smbd/chgpasswd.o smbd/connection.o \
              smbd/dfree.o smbd/dir.o smbd/password.o smbd/conn.o smbd/fileio.o \
!             smbd/ipc.o smbd/lanman.o smbd/mangle.o smbd/negprot.o \
              smbd/message.o smbd/nttrans.o smbd/pipes.o \
              smbd/reply.o smbd/trans2.o smbd/uid.o \
  	    smbd/dosmode.o smbd/filename.o smbd/open.o smbd/close.o \
--- 167,173 ----
  
  SMBD_OBJ1 = smbd/server.o smbd/files.o smbd/chgpasswd.o smbd/connection.o \
              smbd/dfree.o smbd/dir.o smbd/password.o smbd/conn.o smbd/fileio.o \
!             smbd/dcedfs.o smbd/ipc.o smbd/lanman.o smbd/mangle.o smbd/negprot.o \
              smbd/message.o smbd/nttrans.o smbd/pipes.o \
              smbd/reply.o smbd/trans2.o smbd/uid.o \
  	    smbd/dosmode.o smbd/filename.o smbd/open.o smbd/close.o \
***************
*** 208,214 ****
             $(LIB_OBJ)
  
  SWAT_OBJ = web/cgi.o web/diagnose.o web/startstop.o web/statuspage.o \
!            web/swat.o $(PRINTING_OBJ) $(LIBSMB_OBJ) $(LOCKING_OBJ) \
             $(PARAM_OBJ) $(PASSDB_OBJ) $(RPC_PARSE_OBJ) \
             $(UBIQX_OBJ) $(LIB_OBJ) 
  
--- 208,214 ----
             $(LIB_OBJ)
  
  SWAT_OBJ = web/cgi.o web/diagnose.o web/startstop.o web/statuspage.o \
!            web/swat.o smbd/dcedfs.o $(PRINTING_OBJ) $(LIBSMB_OBJ) $(LOCKING_OBJ) \
             $(PARAM_OBJ) $(PASSDB_OBJ) $(RPC_PARSE_OBJ) \
             $(UBIQX_OBJ) $(LIB_OBJ) 
  
***************
*** 241,247 ****
                  $(UBIQX_OBJ) $(RPC_PARSE_OBJ) $(RPC_CLIENT_OBJ) $(LIB_OBJ)
  
  RPCCLIENT_OBJ1 = rpcclient/rpcclient.o rpcclient/cmd_spoolss.o \
! 		rpcclient/cmd_samr.o rpcclient/cmd_lsarpc.o
  
  RPCCLIENT_OBJ = $(RPCCLIENT_OBJ1) \
               $(PARAM_OBJ) $(LIBSMB_OBJ) $(UBIQX_OBJ) $(LIB_OBJ) \
--- 241,247 ----
                  $(UBIQX_OBJ) $(RPC_PARSE_OBJ) $(RPC_CLIENT_OBJ) $(LIB_OBJ)
  
  RPCCLIENT_OBJ1 = rpcclient/rpcclient.o rpcclient/cmd_spoolss.o \
! 		rpcclient/cmd_samr.o rpcclient/cmd_lsarpc.o smbd/dcedfs.o
  
  RPCCLIENT_OBJ = $(RPCCLIENT_OBJ1) \
               $(PARAM_OBJ) $(LIBSMB_OBJ) $(UBIQX_OBJ) $(LIB_OBJ) \
***************
*** 288,294 ****
  LOCKTEST_OBJ = utils/locktest.o $(LOCKING_OBJ) $(LIBSMB_OBJ) $(PARAM_OBJ) \
                   $(UBIQX_OBJ) $(LIB_OBJ)
  
! SMBCACLS_OBJ = utils/smbcacls.o $(LOCKING_OBJ) $(LIBSMB_OBJ) $(PARAM_OBJ) \
  				$(UBIQX_OBJ) $(LIB_OBJ) $(RPC_PARSE_OBJ) $(PASSDB_OBJ) \
  				$(LIBMSRPC_OBJ)
  
--- 288,294 ----
  LOCKTEST_OBJ = utils/locktest.o $(LOCKING_OBJ) $(LIBSMB_OBJ) $(PARAM_OBJ) \
                   $(UBIQX_OBJ) $(LIB_OBJ)
  
! SMBCACLS_OBJ = utils/smbcacls.o smbd/dcedfs.o $(LOCKING_OBJ) $(LIBSMB_OBJ) $(PARAM_OBJ) \
  				$(UBIQX_OBJ) $(LIB_OBJ) $(RPC_PARSE_OBJ) $(PASSDB_OBJ) \
  				$(LIBMSRPC_OBJ)
  
diff -d -r -c samba-2.2.0a/source/acconfig.h samba-2.2.0a-dce-2.5/source/acconfig.h
*** samba-2.2.0a/source/acconfig.h	Mon Apr 16 22:44:24 2001
--- samba-2.2.0a-dce-2.5/source/acconfig.h	Mon Jul  2 10:53:47 2001
***************
*** 18,24 ****
--- 18,30 ----
  #undef HAVE_SHORT_INO_T
  #undef WITH_SMBWRAPPER
  #undef WITH_AFS
+ #undef WITH_DCE
+ #undef WITH_DCE_ENCRYPTED
+ #undef WITH_DCE_REFRESH
+ #undef WITH_DCE_WTS
+ #undef WITH_DCE_IBM_KLUDGE
  #undef WITH_DFS
+ #undef WITH_CALPOLY_UNDERSCORE
  #undef SUNOS5
  #undef SUNOS4
  #undef LINUX
diff -d -r -c samba-2.2.0a/source/configure samba-2.2.0a-dce-2.5/source/configure
*** samba-2.2.0a/source/configure	Mon Apr 16 22:44:24 2001
--- samba-2.2.0a-dce-2.5/source/configure	Mon Jul  2 17:44:10 2001
***************
*** 46,53 ****
    --with-afs     Include AFS support
    --without-afs  Don't include AFS support (default)"
  ac_help="$ac_help
!   --with-dfs     Include DFS support
!   --without-dfs  Don't include DFS support (default)"
  ac_help="$ac_help
    --with-krb4=base-dir     Include Kerberos IV support
    --without-krb4          Don't include Kerberos IV support (default)"
--- 46,71 ----
    --with-afs     Include AFS support
    --without-afs  Don't include AFS support (default)"
  ac_help="$ac_help
!   --with-dce     Include DCE plaintext authentication support
!   --without-dce  Don't include DCE plaintext authentication support (default)"
! ac_help="$ac_help
!   --with-dce-encrypted     Include DCE encrypted authentication support
!   --without-dce-encrypted  Don't include DCE encrypted authentication support (default)"
! ac_help="$ac_help
!   --with-dce-refresh     Include DCE context refresh support
!   --without-dce-refresh  Don't include DCE context refresh support (default)"
! ac_help="$ac_help
!   --with-dce-wts  Include DCE Windows terminal server support
!   --without-dce-wts Don't include DCE Windows terminal server support (default)"
! ac_help="$ac_help
!   --with-dce-ibm-kludge  Work around broken IBM DCE security API
!   --without-dce-ibm-kludge Don't work around broken IBM DCE security API (default)"
! ac_help="$ac_help
!   --with-dfs  Include DFS support
!   --without-dfs Don't include DFS support (default)"
! ac_help="$ac_help
!   --with-calpoly-underscore  Allow underscores in share names
!   --without-calpoly-underscore Don't allow underscores in share names (default)"
  ac_help="$ac_help
    --with-krb4=base-dir     Include Kerberos IV support
    --without-krb4          Don't include Kerberos IV support (default)"
***************
*** 768,774 ****
  # Extract the first word of "gcc", so it can be a program name with args.
  set dummy gcc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:772: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 786,792 ----
  # Extract the first word of "gcc", so it can be a program name with args.
  set dummy gcc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:790: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 798,804 ****
    # Extract the first word of "cc", so it can be a program name with args.
  set dummy cc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:802: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 816,822 ----
    # Extract the first word of "cc", so it can be a program name with args.
  set dummy cc; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:820: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 849,855 ****
        # Extract the first word of "cl", so it can be a program name with args.
  set dummy cl; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:853: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 867,873 ----
        # Extract the first word of "cl", so it can be a program name with args.
  set dummy cl; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:871: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 881,887 ****
  fi
  
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
! echo "configure:885: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
  
  ac_ext=c
  # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
--- 899,905 ----
  fi
  
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
! echo "configure:903: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
  
  ac_ext=c
  # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
***************
*** 892,903 ****
  
  cat > conftest.$ac_ext << EOF
  
! #line 896 "configure"
  #include "confdefs.h"
  
  main(){return(0);}
  EOF
! if { (eval echo configure:901: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    ac_cv_prog_cc_works=yes
    # If we can't run a trivial program, we are probably using a cross compiler.
    if (./conftest; exit) 2>/dev/null; then
--- 910,921 ----
  
  cat > conftest.$ac_ext << EOF
  
! #line 914 "configure"
  #include "confdefs.h"
  
  main(){return(0);}
  EOF
! if { (eval echo configure:919: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    ac_cv_prog_cc_works=yes
    # If we can't run a trivial program, we are probably using a cross compiler.
    if (./conftest; exit) 2>/dev/null; then
***************
*** 923,934 ****
    { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
  fi
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
! echo "configure:927: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
  echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
  cross_compiling=$ac_cv_prog_cc_cross
  
  echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
! echo "configure:932: checking whether we are using GNU C" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 941,952 ----
    { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
  fi
  echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
! echo "configure:945: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
  echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
  cross_compiling=$ac_cv_prog_cc_cross
  
  echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
! echo "configure:950: checking whether we are using GNU C" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 937,943 ****
    yes;
  #endif
  EOF
! if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:941: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
    ac_cv_prog_gcc=yes
  else
    ac_cv_prog_gcc=no
--- 955,961 ----
    yes;
  #endif
  EOF
! if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:959: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
    ac_cv_prog_gcc=yes
  else
    ac_cv_prog_gcc=no
***************
*** 956,962 ****
  ac_save_CFLAGS="$CFLAGS"
  CFLAGS=
  echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
! echo "configure:960: checking whether ${CC-cc} accepts -g" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 974,980 ----
  ac_save_CFLAGS="$CFLAGS"
  CFLAGS=
  echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
! echo "configure:978: checking whether ${CC-cc} accepts -g" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1018,1024 ****
  # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
  # ./install, which can be erroneously created by make from ./install.sh.
  echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
! echo "configure:1022: checking for a BSD compatible install" >&5
  if test -z "$INSTALL"; then
  if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1036,1042 ----
  # SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
  # ./install, which can be erroneously created by make from ./install.sh.
  echo $ac_n "checking for a BSD compatible install""... $ac_c" 1>&6
! echo "configure:1040: checking for a BSD compatible install" >&5
  if test -z "$INSTALL"; then
  if eval "test \"`echo '$''{'ac_cv_path_install'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1070,1081 ****
  
  test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
  
! for ac_prog in gawk mawk nawk awk
  do
  # Extract the first word of "$ac_prog", so it can be a program name with args.
  set dummy $ac_prog; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1079: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_AWK'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1088,1099 ----
  
  test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
  
! for ac_prog in mawk gawk nawk awk
  do
  # Extract the first word of "$ac_prog", so it can be a program name with args.
  set dummy $ac_prog; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1097: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_AWK'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1180,1186 ****
  fi
  
  echo $ac_n "checking host system type""... $ac_c" 1>&6
! echo "configure:1184: checking host system type" >&5
  
  host_alias=$host
  case "$host_alias" in
--- 1198,1204 ----
  fi
  
  echo $ac_n "checking host system type""... $ac_c" 1>&6
! echo "configure:1202: checking host system type" >&5
  
  host_alias=$host
  case "$host_alias" in
***************
*** 1201,1207 ****
  echo "$ac_t""$host" 1>&6
  
  echo $ac_n "checking build system type""... $ac_c" 1>&6
! echo "configure:1205: checking build system type" >&5
  
  build_alias=$build
  case "$build_alias" in
--- 1219,1225 ----
  echo "$ac_t""$host" 1>&6
  
  echo $ac_n "checking build system type""... $ac_c" 1>&6
! echo "configure:1223: checking build system type" >&5
  
  build_alias=$build
  case "$build_alias" in
***************
*** 1221,1227 ****
  # Extract the first word of "ranlib", so it can be a program name with args.
  set dummy ranlib; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1225: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1239,1245 ----
  # Extract the first word of "ranlib", so it can be a program name with args.
  set dummy ranlib; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:1243: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1260,1266 ****
  if test "$ac_cv_prog_gcc" = yes; then
    # Check if gcc -print-prog-name=ld gives a path.
    echo $ac_n "checking for ld used by GCC""... $ac_c" 1>&6
! echo "configure:1264: checking for ld used by GCC" >&5
    ac_prog=`($CC -print-prog-name=ld) 2>&5`
    case "$ac_prog" in
      # Accept absolute paths.
--- 1278,1284 ----
  if test "$ac_cv_prog_gcc" = yes; then
    # Check if gcc -print-prog-name=ld gives a path.
    echo $ac_n "checking for ld used by GCC""... $ac_c" 1>&6
! echo "configure:1282: checking for ld used by GCC" >&5
    ac_prog=`($CC -print-prog-name=ld) 2>&5`
    case "$ac_prog" in
      # Accept absolute paths.
***************
*** 1284,1293 ****
    esac
  elif test "$with_gnu_ld" = yes; then
    echo $ac_n "checking for GNU ld""... $ac_c" 1>&6
! echo "configure:1288: checking for GNU ld" >&5
  else
    echo $ac_n "checking for non-GNU ld""... $ac_c" 1>&6
! echo "configure:1291: checking for non-GNU ld" >&5
  fi
  if eval "test \"`echo '$''{'ac_cv_path_LD'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 1302,1311 ----
    esac
  elif test "$with_gnu_ld" = yes; then
    echo $ac_n "checking for GNU ld""... $ac_c" 1>&6
! echo "configure:1306: checking for GNU ld" >&5
  else
    echo $ac_n "checking for non-GNU ld""... $ac_c" 1>&6
! echo "configure:1309: checking for non-GNU ld" >&5
  fi
  if eval "test \"`echo '$''{'ac_cv_path_LD'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 1322,1328 ****
  fi
  test -z "$LD" && { echo "configure: error: no acceptable ld found in \$PATH" 1>&2; exit 1; }
  echo $ac_n "checking if the linker ($LD) is GNU ld""... $ac_c" 1>&6
! echo "configure:1326: checking if the linker ($LD) is GNU ld" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gnu_ld'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1340,1346 ----
  fi
  test -z "$LD" && { echo "configure: error: no acceptable ld found in \$PATH" 1>&2; exit 1; }
  echo $ac_n "checking if the linker ($LD) is GNU ld""... $ac_c" 1>&6
! echo "configure:1344: checking if the linker ($LD) is GNU ld" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_gnu_ld'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1338,1344 ****
  
  
  echo $ac_n "checking for BSD-compatible nm""... $ac_c" 1>&6
! echo "configure:1342: checking for BSD-compatible nm" >&5
  if eval "test \"`echo '$''{'ac_cv_path_NM'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1356,1362 ----
  
  
  echo $ac_n "checking for BSD-compatible nm""... $ac_c" 1>&6
! echo "configure:1360: checking for BSD-compatible nm" >&5
  if eval "test \"`echo '$''{'ac_cv_path_NM'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1374,1380 ****
  echo "$ac_t""$NM" 1>&6
  
  echo $ac_n "checking whether ln -s works""... $ac_c" 1>&6
! echo "configure:1378: checking whether ln -s works" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_LN_S'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1392,1398 ----
  echo "$ac_t""$NM" 1>&6
  
  echo $ac_n "checking whether ln -s works""... $ac_c" 1>&6
! echo "configure:1396: checking whether ln -s works" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_LN_S'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1423,1430 ****
  case "$lt_target" in
  *-*-irix6*)
    # Find out which ABI we are using.
!   echo '#line 1427 "configure"' > conftest.$ac_ext
!   if { (eval echo configure:1428: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
      case "`/usr/bin/file conftest.o`" in
      *32-bit*)
        LD="${LD-ld} -32"
--- 1441,1448 ----
  case "$lt_target" in
  *-*-irix6*)
    # Find out which ABI we are using.
!   echo '#line 1445 "configure"' > conftest.$ac_ext
!   if { (eval echo configure:1446: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
      case "`/usr/bin/file conftest.o`" in
      *32-bit*)
        LD="${LD-ld} -32"
***************
*** 1445,1463 ****
    SAVE_CFLAGS="$CFLAGS"
    CFLAGS="$CFLAGS -belf"
    echo $ac_n "checking whether the C compiler needs -belf""... $ac_c" 1>&6
! echo "configure:1449: checking whether the C compiler needs -belf" >&5
  if eval "test \"`echo '$''{'lt_cv_cc_needs_belf'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1454 "configure"
  #include "confdefs.h"
  
  int main() {
  
  ; return 0; }
  EOF
! if { (eval echo configure:1461: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    lt_cv_cc_needs_belf=yes
  else
--- 1463,1481 ----
    SAVE_CFLAGS="$CFLAGS"
    CFLAGS="$CFLAGS -belf"
    echo $ac_n "checking whether the C compiler needs -belf""... $ac_c" 1>&6
! echo "configure:1467: checking whether the C compiler needs -belf" >&5
  if eval "test \"`echo '$''{'lt_cv_cc_needs_belf'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 1472 "configure"
  #include "confdefs.h"
  
  int main() {
  
  ; return 0; }
  EOF
! if { (eval echo configure:1479: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    lt_cv_cc_needs_belf=yes
  else
***************
*** 1562,1571 ****
  
  if test "x$CC" != xcc; then
    echo $ac_n "checking whether $CC and cc understand -c and -o together""... $ac_c" 1>&6
! echo "configure:1566: checking whether $CC and cc understand -c and -o together" >&5
  else
    echo $ac_n "checking whether cc understands -c and -o together""... $ac_c" 1>&6
! echo "configure:1569: checking whether cc understands -c and -o together" >&5
  fi
  set dummy $CC; ac_cc="`echo $2 |
  		       sed -e 's/[^a-zA-Z0-9_]/_/g' -e 's/^[0-9]/_/'`"
--- 1580,1589 ----
  
  if test "x$CC" != xcc; then
    echo $ac_n "checking whether $CC and cc understand -c and -o together""... $ac_c" 1>&6
! echo "configure:1584: checking whether $CC and cc understand -c and -o together" >&5
  else
    echo $ac_n "checking whether cc understands -c and -o together""... $ac_c" 1>&6
! echo "configure:1587: checking whether cc understands -c and -o together" >&5
  fi
  set dummy $CC; ac_cc="`echo $2 |
  		       sed -e 's/[^a-zA-Z0-9_]/_/g' -e 's/^[0-9]/_/'`"
***************
*** 1577,1592 ****
  # We do the test twice because some compilers refuse to overwrite an
  # existing .o file with -o, though they will create one.
  ac_try='${CC-cc} -c conftest.c -o conftest.o 1>&5'
! if { (eval echo configure:1581: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; } &&
!    test -f conftest.o && { (eval echo configure:1582: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; };
  then
    eval ac_cv_prog_cc_${ac_cc}_c_o=yes
    if test "x$CC" != xcc; then
      # Test first that cc exists at all.
!     if { ac_try='cc -c conftest.c 1>&5'; { (eval echo configure:1587: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; }; then
        ac_try='cc -c conftest.c -o conftest.o 1>&5'
!       if { (eval echo configure:1589: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; } &&
! 	 test -f conftest.o && { (eval echo configure:1590: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; };
        then
          # cc works too.
          :
--- 1595,1610 ----
  # We do the test twice because some compilers refuse to overwrite an
  # existing .o file with -o, though they will create one.
  ac_try='${CC-cc} -c conftest.c -o conftest.o 1>&5'
! if { (eval echo configure:1599: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; } &&
!    test -f conftest.o && { (eval echo configure:1600: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; };
  then
    eval ac_cv_prog_cc_${ac_cc}_c_o=yes
    if test "x$CC" != xcc; then
      # Test first that cc exists at all.
!     if { ac_try='cc -c conftest.c 1>&5'; { (eval echo configure:1605: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; }; then
        ac_try='cc -c conftest.c -o conftest.o 1>&5'
!       if { (eval echo configure:1607: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; } &&
! 	 test -f conftest.o && { (eval echo configure:1608: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; };
        then
          # cc works too.
          :
***************
*** 1620,1639 ****
  
  
  echo $ac_n "checking that the C compiler understands volatile""... $ac_c" 1>&6
! echo "configure:1624: checking that the C compiler understands volatile" >&5
  if eval "test \"`echo '$''{'samba_cv_volatile'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 1630 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  int main() {
  volatile int i = 0
  ; return 0; }
  EOF
! if { (eval echo configure:1637: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_volatile=yes
  else
--- 1638,1657 ----
  
  
  echo $ac_n "checking that the C compiler understands volatile""... $ac_c" 1>&6
! echo "configure:1642: checking that the C compiler understands volatile" >&5
  if eval "test \"`echo '$''{'samba_cv_volatile'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 1648 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  int main() {
  volatile int i = 0
  ; return 0; }
  EOF
! if { (eval echo configure:1655: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_volatile=yes
  else
***************
*** 1683,1689 ****
  fi
  
  echo $ac_n "checking host system type""... $ac_c" 1>&6
! echo "configure:1687: checking host system type" >&5
  
  host_alias=$host
  case "$host_alias" in
--- 1701,1707 ----
  fi
  
  echo $ac_n "checking host system type""... $ac_c" 1>&6
! echo "configure:1705: checking host system type" >&5
  
  host_alias=$host
  case "$host_alias" in
***************
*** 1704,1710 ****
  echo "$ac_t""$host" 1>&6
  
  echo $ac_n "checking target system type""... $ac_c" 1>&6
! echo "configure:1708: checking target system type" >&5
  
  target_alias=$target
  case "$target_alias" in
--- 1722,1728 ----
  echo "$ac_t""$host" 1>&6
  
  echo $ac_n "checking target system type""... $ac_c" 1>&6
! echo "configure:1726: checking target system type" >&5
  
  target_alias=$target
  case "$target_alias" in
***************
*** 1722,1728 ****
  echo "$ac_t""$target" 1>&6
  
  echo $ac_n "checking build system type""... $ac_c" 1>&6
! echo "configure:1726: checking build system type" >&5
  
  build_alias=$build
  case "$build_alias" in
--- 1740,1746 ----
  echo "$ac_t""$target" 1>&6
  
  echo $ac_n "checking build system type""... $ac_c" 1>&6
! echo "configure:1744: checking build system type" >&5
  
  build_alias=$build
  case "$build_alias" in
***************
*** 1756,1762 ****
  
      
      echo $ac_n "checking config.cache system type""... $ac_c" 1>&6
! echo "configure:1760: checking config.cache system type" >&5
      if { test x"${ac_cv_host_system_type+set}" = x"set" &&
           test x"$ac_cv_host_system_type" != x"$host"; } ||
         { test x"${ac_cv_build_system_type+set}" = x"set" &&
--- 1774,1780 ----
  
      
      echo $ac_n "checking config.cache system type""... $ac_c" 1>&6
! echo "configure:1778: checking config.cache system type" >&5
      if { test x"${ac_cv_host_system_type+set}" = x"set" &&
           test x"$ac_cv_host_system_type" != x"$host"; } ||
         { test x"${ac_cv_build_system_type+set}" = x"set" &&
***************
*** 1781,1787 ****
  # Try to work out if this is the native HPUX compiler that uses the -Ae flag.
      *hpux*)
        echo $ac_n "checking whether ${CC-cc} accepts -Ae""... $ac_c" 1>&6
! echo "configure:1785: checking whether ${CC-cc} accepts -Ae" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_Ae'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 1799,1805 ----
  # Try to work out if this is the native HPUX compiler that uses the -Ae flag.
      *hpux*)
        echo $ac_n "checking whether ${CC-cc} accepts -Ae""... $ac_c" 1>&6
! echo "configure:1803: checking whether ${CC-cc} accepts -Ae" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_Ae'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 1865,1878 ****
      *sysv4*)
        if test $host = mips-sni-sysv4 ; then
          echo $ac_n "checking for LFS support""... $ac_c" 1>&6
! echo "configure:1869: checking for LFS support" >&5
          old_CPPFLAGS="$CPPFLAGS"
          CPPFLAGS="-D_LARGEFILE64_SOURCE $CPPFLAGS"
          if test "$cross_compiling" = yes; then
    SINIX_LFS_SUPPORT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 1876 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
--- 1883,1896 ----
      *sysv4*)
        if test $host = mips-sni-sysv4 ; then
          echo $ac_n "checking for LFS support""... $ac_c" 1>&6
! echo "configure:1887: checking for LFS support" >&5
          old_CPPFLAGS="$CPPFLAGS"
          CPPFLAGS="-D_LARGEFILE64_SOURCE $CPPFLAGS"
          if test "$cross_compiling" = yes; then
    SINIX_LFS_SUPPORT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 1894 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
***************
*** 1884,1890 ****
  #endif
  }
  EOF
! if { (eval echo configure:1888: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    SINIX_LFS_SUPPORT=yes
  else
--- 1902,1908 ----
  #endif
  }
  EOF
! if { (eval echo configure:1906: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    SINIX_LFS_SUPPORT=yes
  else
***************
*** 1911,1924 ****
  #
      *linux*)
          echo $ac_n "checking for LFS support""... $ac_c" 1>&6
! echo "configure:1915: checking for LFS support" >&5
          old_CPPFLAGS="$CPPFLAGS"
          CPPFLAGS="-D_LARGEFILE64_SOURCE -D_GNU_SOURCE $CPPFLAGS"
         if test "$cross_compiling" = yes; then
    LINUX_LFS_SUPPORT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 1922 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
--- 1929,1942 ----
  #
      *linux*)
          echo $ac_n "checking for LFS support""... $ac_c" 1>&6
! echo "configure:1933: checking for LFS support" >&5
          old_CPPFLAGS="$CPPFLAGS"
          CPPFLAGS="-D_LARGEFILE64_SOURCE -D_GNU_SOURCE $CPPFLAGS"
         if test "$cross_compiling" = yes; then
    LINUX_LFS_SUPPORT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 1940 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
***************
*** 1956,1962 ****
  }
  
  EOF
! if { (eval echo configure:1960: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    LINUX_LFS_SUPPORT=yes
  else
--- 1974,1980 ----
  }
  
  EOF
! if { (eval echo configure:1978: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    LINUX_LFS_SUPPORT=yes
  else
***************
*** 1977,1990 ****
  
      *hurd*)
          echo $ac_n "checking for LFS support""... $ac_c" 1>&6
! echo "configure:1981: checking for LFS support" >&5
          old_CPPFLAGS="$CPPFLAGS"
          CPPFLAGS="-D_LARGEFILE64_SOURCE -D_GNU_SOURCE $CPPFLAGS"
          if test "$cross_compiling" = yes; then
    GLIBC_LFS_SUPPORT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 1988 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
--- 1995,2008 ----
  
      *hurd*)
          echo $ac_n "checking for LFS support""... $ac_c" 1>&6
! echo "configure:1999: checking for LFS support" >&5
          old_CPPFLAGS="$CPPFLAGS"
          CPPFLAGS="-D_LARGEFILE64_SOURCE -D_GNU_SOURCE $CPPFLAGS"
          if test "$cross_compiling" = yes; then
    GLIBC_LFS_SUPPORT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 2006 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
***************
*** 1996,2002 ****
  #endif
  }
  EOF
! if { (eval echo configure:2000: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    GLIBC_LFS_SUPPORT=yes
  else
--- 2014,2020 ----
  #endif
  }
  EOF
! if { (eval echo configure:2018: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    GLIBC_LFS_SUPPORT=yes
  else
***************
*** 2018,2038 ****
  esac
  
  echo $ac_n "checking for inline""... $ac_c" 1>&6
! echo "configure:2022: checking for inline" >&5
  if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_inline=no
  for ac_kw in inline __inline__ __inline; do
    cat > conftest.$ac_ext <<EOF
! #line 2029 "configure"
  #include "confdefs.h"
  
  int main() {
  } $ac_kw foo() {
  ; return 0; }
  EOF
! if { (eval echo configure:2036: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_inline=$ac_kw; break
  else
--- 2036,2056 ----
  esac
  
  echo $ac_n "checking for inline""... $ac_c" 1>&6
! echo "configure:2040: checking for inline" >&5
  if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_inline=no
  for ac_kw in inline __inline__ __inline; do
    cat > conftest.$ac_ext <<EOF
! #line 2047 "configure"
  #include "confdefs.h"
  
  int main() {
  } $ac_kw foo() {
  ; return 0; }
  EOF
! if { (eval echo configure:2054: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_inline=$ac_kw; break
  else
***************
*** 2058,2064 ****
  esac
  
  echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
! echo "configure:2062: checking how to run the C preprocessor" >&5
  # On Suns, sometimes $CPP names a directory.
  if test -n "$CPP" && test -d "$CPP"; then
    CPP=
--- 2076,2082 ----
  esac
  
  echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
! echo "configure:2080: checking how to run the C preprocessor" >&5
  # On Suns, sometimes $CPP names a directory.
  if test -n "$CPP" && test -d "$CPP"; then
    CPP=
***************
*** 2073,2085 ****
    # On the NeXT, cc -E runs the code through the compiler's parser,
    # not just through cpp.
    cat > conftest.$ac_ext <<EOF
! #line 2077 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2083: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
--- 2091,2103 ----
    # On the NeXT, cc -E runs the code through the compiler's parser,
    # not just through cpp.
    cat > conftest.$ac_ext <<EOF
! #line 2095 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2101: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
***************
*** 2090,2102 ****
    rm -rf conftest*
    CPP="${CC-cc} -E -traditional-cpp"
    cat > conftest.$ac_ext <<EOF
! #line 2094 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2100: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
--- 2108,2120 ----
    rm -rf conftest*
    CPP="${CC-cc} -E -traditional-cpp"
    cat > conftest.$ac_ext <<EOF
! #line 2112 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2118: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
***************
*** 2107,2119 ****
    rm -rf conftest*
    CPP="${CC-cc} -nologo -E"
    cat > conftest.$ac_ext <<EOF
! #line 2111 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2117: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
--- 2125,2137 ----
    rm -rf conftest*
    CPP="${CC-cc} -nologo -E"
    cat > conftest.$ac_ext <<EOF
! #line 2129 "configure"
  #include "confdefs.h"
  #include <assert.h>
  Syntax Error
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2135: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    :
***************
*** 2138,2149 ****
  echo "$ac_t""$CPP" 1>&6
  
  echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
! echo "configure:2142: checking for ANSI C header files" >&5
  if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2147 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <stdarg.h>
--- 2156,2167 ----
  echo "$ac_t""$CPP" 1>&6
  
  echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
! echo "configure:2160: checking for ANSI C header files" >&5
  if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2165 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <stdarg.h>
***************
*** 2151,2157 ****
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2155: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2169,2175 ----
  #include <float.h>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2173: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2168,2174 ****
  if test $ac_cv_header_stdc = yes; then
    # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2172 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
--- 2186,2192 ----
  if test $ac_cv_header_stdc = yes; then
    # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2190 "configure"
  #include "confdefs.h"
  #include <string.h>
  EOF
***************
*** 2186,2192 ****
  if test $ac_cv_header_stdc = yes; then
    # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2190 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
--- 2204,2210 ----
  if test $ac_cv_header_stdc = yes; then
    # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
  cat > conftest.$ac_ext <<EOF
! #line 2208 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  EOF
***************
*** 2207,2213 ****
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 2211 "configure"
  #include "confdefs.h"
  #include <ctype.h>
  #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
--- 2225,2231 ----
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 2229 "configure"
  #include "confdefs.h"
  #include <ctype.h>
  #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
***************
*** 2218,2224 ****
  exit (0); }
  
  EOF
! if { (eval echo configure:2222: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    :
  else
--- 2236,2242 ----
  exit (0); }
  
  EOF
! if { (eval echo configure:2240: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    :
  else
***************
*** 2246,2257 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr that defines DIR""... $ac_c" 1>&6
! echo "configure:2250: checking for $ac_hdr that defines DIR" >&5
  if eval "test \"`echo '$''{'ac_cv_header_dirent_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2255 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <$ac_hdr>
--- 2264,2275 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr that defines DIR""... $ac_c" 1>&6
! echo "configure:2268: checking for $ac_hdr that defines DIR" >&5
  if eval "test \"`echo '$''{'ac_cv_header_dirent_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2273 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <$ac_hdr>
***************
*** 2259,2265 ****
  DIR *dirp = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:2263: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    eval "ac_cv_header_dirent_$ac_safe=yes"
  else
--- 2277,2283 ----
  DIR *dirp = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:2281: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    eval "ac_cv_header_dirent_$ac_safe=yes"
  else
***************
*** 2284,2290 ****
  # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
  if test $ac_header_dirent = dirent.h; then
  echo $ac_n "checking for opendir in -ldir""... $ac_c" 1>&6
! echo "configure:2288: checking for opendir in -ldir" >&5
  ac_lib_var=`echo dir'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2302,2308 ----
  # Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.
  if test $ac_header_dirent = dirent.h; then
  echo $ac_n "checking for opendir in -ldir""... $ac_c" 1>&6
! echo "configure:2306: checking for opendir in -ldir" >&5
  ac_lib_var=`echo dir'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2292,2298 ****
    ac_save_LIBS="$LIBS"
  LIBS="-ldir  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2296 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2310,2316 ----
    ac_save_LIBS="$LIBS"
  LIBS="-ldir  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2314 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2303,2309 ****
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2307: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2321,2327 ----
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2325: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2325,2331 ****
  
  else
  echo $ac_n "checking for opendir in -lx""... $ac_c" 1>&6
! echo "configure:2329: checking for opendir in -lx" >&5
  ac_lib_var=`echo x'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 2343,2349 ----
  
  else
  echo $ac_n "checking for opendir in -lx""... $ac_c" 1>&6
! echo "configure:2347: checking for opendir in -lx" >&5
  ac_lib_var=`echo x'_'opendir | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 2333,2339 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lx  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2337 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 2351,2357 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lx  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 2355 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 2344,2350 ****
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2348: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 2362,2368 ----
  opendir()
  ; return 0; }
  EOF
! if { (eval echo configure:2366: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 2367,2378 ****
  fi
  
  echo $ac_n "checking whether time.h and sys/time.h may both be included""... $ac_c" 1>&6
! echo "configure:2371: checking whether time.h and sys/time.h may both be included" >&5
  if eval "test \"`echo '$''{'ac_cv_header_time'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2376 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/time.h>
--- 2385,2396 ----
  fi
  
  echo $ac_n "checking whether time.h and sys/time.h may both be included""... $ac_c" 1>&6
! echo "configure:2389: checking whether time.h and sys/time.h may both be included" >&5
  if eval "test \"`echo '$''{'ac_cv_header_time'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2394 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/time.h>
***************
*** 2381,2387 ****
  struct tm *tp;
  ; return 0; }
  EOF
! if { (eval echo configure:2385: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_time=yes
  else
--- 2399,2405 ----
  struct tm *tp;
  ; return 0; }
  EOF
! if { (eval echo configure:2403: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_time=yes
  else
***************
*** 2402,2413 ****
  fi
  
  echo $ac_n "checking for sys/wait.h that is POSIX.1 compatible""... $ac_c" 1>&6
! echo "configure:2406: checking for sys/wait.h that is POSIX.1 compatible" >&5
  if eval "test \"`echo '$''{'ac_cv_header_sys_wait_h'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2411 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/wait.h>
--- 2420,2431 ----
  fi
  
  echo $ac_n "checking for sys/wait.h that is POSIX.1 compatible""... $ac_c" 1>&6
! echo "configure:2424: checking for sys/wait.h that is POSIX.1 compatible" >&5
  if eval "test \"`echo '$''{'ac_cv_header_sys_wait_h'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2429 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/wait.h>
***************
*** 2423,2429 ****
  s = WIFEXITED (s) ? WEXITSTATUS (s) : 1;
  ; return 0; }
  EOF
! if { (eval echo configure:2427: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_sys_wait_h=yes
  else
--- 2441,2447 ----
  s = WIFEXITED (s) ? WEXITSTATUS (s) : 1;
  ; return 0; }
  EOF
! if { (eval echo configure:2445: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_sys_wait_h=yes
  else
***************
*** 2447,2463 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2451: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2456 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2461: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2465,2481 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2469: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2474 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2479: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2487,2503 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2491: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2496 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2501: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2505,2521 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2509: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2514 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2519: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2527,2543 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2531: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2536 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2541: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2545,2561 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2549: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2554 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2559: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2567,2583 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2571: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2576 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2581: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2585,2601 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2589: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2594 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2599: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2607,2623 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2611: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2616 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2621: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2625,2641 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2629: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2634 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2639: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2647,2663 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2651: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2656 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2661: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2665,2681 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2669: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2674 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2679: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2687,2703 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2691: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2696 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2701: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2705,2721 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2709: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2714 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2719: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2730,2743 ****
  case "$host_os" in
      *hpux*)
  		cat > conftest.$ac_ext <<EOF
! #line 2734 "configure"
  #include "confdefs.h"
  #include <shadow.h>
  int main() {
  struct spwd testme
  ; return 0; }
  EOF
! if { (eval echo configure:2741: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_shadow_h=yes
  else
--- 2748,2761 ----
  case "$host_os" in
      *hpux*)
  		cat > conftest.$ac_ext <<EOF
! #line 2752 "configure"
  #include "confdefs.h"
  #include <shadow.h>
  int main() {
  struct spwd testme
  ; return 0; }
  EOF
! if { (eval echo configure:2759: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_header_shadow_h=yes
  else
***************
*** 2759,2775 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2763: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2768 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2773: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2777,2793 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2781: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2786 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2791: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2799,2815 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2803: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2808 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2813: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2817,2833 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2821: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2826 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2831: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2839,2855 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2843: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2848 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2853: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2857,2873 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2861: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2866 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2871: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2879,2895 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2883: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2888 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2893: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2897,2913 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2901: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2906 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2911: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2919,2935 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2923: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2928 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2933: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2937,2953 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2941: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2946 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2951: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 2961,2977 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2965: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2970 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2975: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 2979,2995 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:2983: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 2988 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:2993: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 3003,3019 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:3007: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3012 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3017: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 3021,3037 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:3025: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3030 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:3035: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 3041,3047 ****
  
  
  echo $ac_n "checking size of int""... $ac_c" 1>&6
! echo "configure:3045: checking size of int" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3059,3065 ----
  
  
  echo $ac_n "checking size of int""... $ac_c" 1>&6
! echo "configure:3063: checking size of int" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3049,3055 ****
    ac_cv_sizeof_int=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 3053 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3067,3073 ----
    ac_cv_sizeof_int=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 3071 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3060,3066 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3064: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_int=`cat conftestval`
  else
--- 3078,3084 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3082: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_int=`cat conftestval`
  else
***************
*** 3080,3086 ****
  
  
  echo $ac_n "checking size of long""... $ac_c" 1>&6
! echo "configure:3084: checking size of long" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_long'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3098,3104 ----
  
  
  echo $ac_n "checking size of long""... $ac_c" 1>&6
! echo "configure:3102: checking size of long" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_long'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3088,3094 ****
    ac_cv_sizeof_long=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 3092 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3106,3112 ----
    ac_cv_sizeof_long=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 3110 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3099,3105 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3103: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_long=`cat conftestval`
  else
--- 3117,3123 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3121: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_long=`cat conftestval`
  else
***************
*** 3119,3125 ****
  
  
  echo $ac_n "checking size of short""... $ac_c" 1>&6
! echo "configure:3123: checking size of short" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_short'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 3137,3143 ----
  
  
  echo $ac_n "checking size of short""... $ac_c" 1>&6
! echo "configure:3141: checking size of short" >&5
  if eval "test \"`echo '$''{'ac_cv_sizeof_short'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 3127,3133 ****
    ac_cv_sizeof_short=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 3131 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
--- 3145,3151 ----
    ac_cv_sizeof_short=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 3149 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main()
***************
*** 3138,3144 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:3142: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_short=`cat conftestval`
  else
--- 3156,3162 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:3160: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_sizeof_short=`cat conftestval`
  else
***************
*** 3159,3170 ****
  
  
  echo $ac_n "checking for working const""... $ac_c" 1>&6
! echo "configure:3163: checking for working const" >&5
  if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3168 "configure"
  #include "confdefs.h"
  
  int main() {
--- 3177,3188 ----
  
  
  echo $ac_n "checking for working const""... $ac_c" 1>&6
! echo "configure:3181: checking for working const" >&5
  if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3186 "configure"
  #include "confdefs.h"
  
  int main() {
***************
*** 3213,3219 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:3217: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_const=yes
  else
--- 3231,3237 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:3235: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_const=yes
  else
***************
*** 3234,3254 ****
  fi
  
  echo $ac_n "checking for inline""... $ac_c" 1>&6
! echo "configure:3238: checking for inline" >&5
  if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_inline=no
  for ac_kw in inline __inline__ __inline; do
    cat > conftest.$ac_ext <<EOF
! #line 3245 "configure"
  #include "confdefs.h"
  
  int main() {
  } $ac_kw foo() {
  ; return 0; }
  EOF
! if { (eval echo configure:3252: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_inline=$ac_kw; break
  else
--- 3252,3272 ----
  fi
  
  echo $ac_n "checking for inline""... $ac_c" 1>&6
! echo "configure:3256: checking for inline" >&5
  if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_inline=no
  for ac_kw in inline __inline__ __inline; do
    cat > conftest.$ac_ext <<EOF
! #line 3263 "configure"
  #include "confdefs.h"
  
  int main() {
  } $ac_kw foo() {
  ; return 0; }
  EOF
! if { (eval echo configure:3270: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_inline=$ac_kw; break
  else
***************
*** 3274,3287 ****
  esac
  
  echo $ac_n "checking whether byte ordering is bigendian""... $ac_c" 1>&6
! echo "configure:3278: checking whether byte ordering is bigendian" >&5
  if eval "test \"`echo '$''{'ac_cv_c_bigendian'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_bigendian=unknown
  # See if sys/param.h defines the BYTE_ORDER macro.
  cat > conftest.$ac_ext <<EOF
! #line 3285 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/param.h>
--- 3292,3305 ----
  esac
  
  echo $ac_n "checking whether byte ordering is bigendian""... $ac_c" 1>&6
! echo "configure:3296: checking whether byte ordering is bigendian" >&5
  if eval "test \"`echo '$''{'ac_cv_c_bigendian'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    ac_cv_c_bigendian=unknown
  # See if sys/param.h defines the BYTE_ORDER macro.
  cat > conftest.$ac_ext <<EOF
! #line 3303 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/param.h>
***************
*** 3292,3302 ****
  #endif
  ; return 0; }
  EOF
! if { (eval echo configure:3296: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    # It does; now see whether it defined to BIG_ENDIAN or not.
  cat > conftest.$ac_ext <<EOF
! #line 3300 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/param.h>
--- 3310,3320 ----
  #endif
  ; return 0; }
  EOF
! if { (eval echo configure:3314: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    # It does; now see whether it defined to BIG_ENDIAN or not.
  cat > conftest.$ac_ext <<EOF
! #line 3318 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/param.h>
***************
*** 3307,3313 ****
  #endif
  ; return 0; }
  EOF
! if { (eval echo configure:3311: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_bigendian=yes
  else
--- 3325,3331 ----
  #endif
  ; return 0; }
  EOF
! if { (eval echo configure:3329: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_c_bigendian=yes
  else
***************
*** 3327,3333 ****
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 3331 "configure"
  #include "confdefs.h"
  main () {
    /* Are we little or big endian?  From Harbison&Steele.  */
--- 3345,3351 ----
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 3349 "configure"
  #include "confdefs.h"
  main () {
    /* Are we little or big endian?  From Harbison&Steele.  */
***************
*** 3340,3346 ****
    exit (u.c[sizeof (long) - 1] == 1);
  }
  EOF
! if { (eval echo configure:3344: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_c_bigendian=no
  else
--- 3358,3364 ----
    exit (u.c[sizeof (long) - 1] == 1);
  }
  EOF
! if { (eval echo configure:3362: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_c_bigendian=no
  else
***************
*** 3364,3377 ****
  fi
  
  echo $ac_n "checking whether char is unsigned""... $ac_c" 1>&6
! echo "configure:3368: checking whether char is unsigned" >&5
  if eval "test \"`echo '$''{'ac_cv_c_char_unsigned'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    if test "$GCC" = yes; then
    # GCC predefines this symbol on systems where it applies.
  cat > conftest.$ac_ext <<EOF
! #line 3375 "configure"
  #include "confdefs.h"
  #ifdef __CHAR_UNSIGNED__
    yes
--- 3382,3395 ----
  fi
  
  echo $ac_n "checking whether char is unsigned""... $ac_c" 1>&6
! echo "configure:3386: checking whether char is unsigned" >&5
  if eval "test \"`echo '$''{'ac_cv_c_char_unsigned'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    if test "$GCC" = yes; then
    # GCC predefines this symbol on systems where it applies.
  cat > conftest.$ac_ext <<EOF
! #line 3393 "configure"
  #include "confdefs.h"
  #ifdef __CHAR_UNSIGNED__
    yes
***************
*** 3393,3399 ****
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 3397 "configure"
  #include "confdefs.h"
  /* volatile prevents gcc2 from optimizing the test away on sparcs.  */
  #if !defined(__STDC__) || __STDC__ != 1
--- 3411,3417 ----
      { echo "configure: error: can not run test program while cross compiling" 1>&2; exit 1; }
  else
    cat > conftest.$ac_ext <<EOF
! #line 3415 "configure"
  #include "confdefs.h"
  /* volatile prevents gcc2 from optimizing the test away on sparcs.  */
  #if !defined(__STDC__) || __STDC__ != 1
***************
*** 3403,3409 ****
    volatile char c = 255; exit(c < 0);
  }
  EOF
! if { (eval echo configure:3407: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_c_char_unsigned=yes
  else
--- 3421,3427 ----
    volatile char c = 255; exit(c < 0);
  }
  EOF
! if { (eval echo configure:3425: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_c_char_unsigned=yes
  else
***************
*** 3428,3439 ****
  
  
  echo $ac_n "checking return type of signal handlers""... $ac_c" 1>&6
! echo "configure:3432: checking return type of signal handlers" >&5
  if eval "test \"`echo '$''{'ac_cv_type_signal'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3437 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <signal.h>
--- 3446,3457 ----
  
  
  echo $ac_n "checking return type of signal handlers""... $ac_c" 1>&6
! echo "configure:3450: checking return type of signal handlers" >&5
  if eval "test \"`echo '$''{'ac_cv_type_signal'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3455 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <signal.h>
***************
*** 3450,3456 ****
  int i;
  ; return 0; }
  EOF
! if { (eval echo configure:3454: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_type_signal=void
  else
--- 3468,3474 ----
  int i;
  ; return 0; }
  EOF
! if { (eval echo configure:3472: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_type_signal=void
  else
***************
*** 3469,3480 ****
  
  
  echo $ac_n "checking for uid_t in sys/types.h""... $ac_c" 1>&6
! echo "configure:3473: checking for uid_t in sys/types.h" >&5
  if eval "test \"`echo '$''{'ac_cv_type_uid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3478 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  EOF
--- 3487,3498 ----
  
  
  echo $ac_n "checking for uid_t in sys/types.h""... $ac_c" 1>&6
! echo "configure:3491: checking for uid_t in sys/types.h" >&5
  if eval "test \"`echo '$''{'ac_cv_type_uid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3496 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  EOF
***************
*** 3503,3514 ****
  fi
  
  echo $ac_n "checking for mode_t""... $ac_c" 1>&6
! echo "configure:3507: checking for mode_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3512 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3521,3532 ----
  fi
  
  echo $ac_n "checking for mode_t""... $ac_c" 1>&6
! echo "configure:3525: checking for mode_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_mode_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3530 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3536,3547 ****
  fi
  
  echo $ac_n "checking for off_t""... $ac_c" 1>&6
! echo "configure:3540: checking for off_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_off_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3545 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3554,3565 ----
  fi
  
  echo $ac_n "checking for off_t""... $ac_c" 1>&6
! echo "configure:3558: checking for off_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_off_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3563 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3569,3580 ****
  fi
  
  echo $ac_n "checking for size_t""... $ac_c" 1>&6
! echo "configure:3573: checking for size_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3578 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3587,3598 ----
  fi
  
  echo $ac_n "checking for size_t""... $ac_c" 1>&6
! echo "configure:3591: checking for size_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3596 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3602,3613 ****
  fi
  
  echo $ac_n "checking for pid_t""... $ac_c" 1>&6
! echo "configure:3606: checking for pid_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3611 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3620,3631 ----
  fi
  
  echo $ac_n "checking for pid_t""... $ac_c" 1>&6
! echo "configure:3624: checking for pid_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_pid_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3629 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3635,3646 ****
  fi
  
  echo $ac_n "checking for st_rdev in struct stat""... $ac_c" 1>&6
! echo "configure:3639: checking for st_rdev in struct stat" >&5
  if eval "test \"`echo '$''{'ac_cv_struct_st_rdev'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3644 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/stat.h>
--- 3653,3664 ----
  fi
  
  echo $ac_n "checking for st_rdev in struct stat""... $ac_c" 1>&6
! echo "configure:3657: checking for st_rdev in struct stat" >&5
  if eval "test \"`echo '$''{'ac_cv_struct_st_rdev'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3662 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/stat.h>
***************
*** 3648,3654 ****
  struct stat s; s.st_rdev;
  ; return 0; }
  EOF
! if { (eval echo configure:3652: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_struct_st_rdev=yes
  else
--- 3666,3672 ----
  struct stat s; s.st_rdev;
  ; return 0; }
  EOF
! if { (eval echo configure:3670: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_struct_st_rdev=yes
  else
***************
*** 3669,3680 ****
  fi
  
  echo $ac_n "checking for d_off in dirent""... $ac_c" 1>&6
! echo "configure:3673: checking for d_off in dirent" >&5
  if eval "test \"`echo '$''{'ac_cv_dirent_d_off'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3678 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
--- 3687,3698 ----
  fi
  
  echo $ac_n "checking for d_off in dirent""... $ac_c" 1>&6
! echo "configure:3691: checking for d_off in dirent" >&5
  if eval "test \"`echo '$''{'ac_cv_dirent_d_off'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3696 "configure"
  #include "confdefs.h"
  
  #include <unistd.h>
***************
*** 3684,3690 ****
  struct dirent d; d.d_off;
  ; return 0; }
  EOF
! if { (eval echo configure:3688: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_dirent_d_off=yes
  else
--- 3702,3708 ----
  struct dirent d; d.d_off;
  ; return 0; }
  EOF
! if { (eval echo configure:3706: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    ac_cv_dirent_d_off=yes
  else
***************
*** 3705,3716 ****
  fi
  
  echo $ac_n "checking for ino_t""... $ac_c" 1>&6
! echo "configure:3709: checking for ino_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_ino_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3714 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3723,3734 ----
  fi
  
  echo $ac_n "checking for ino_t""... $ac_c" 1>&6
! echo "configure:3727: checking for ino_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_ino_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3732 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3738,3749 ****
  fi
  
  echo $ac_n "checking for loff_t""... $ac_c" 1>&6
! echo "configure:3742: checking for loff_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_loff_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3747 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3756,3767 ----
  fi
  
  echo $ac_n "checking for loff_t""... $ac_c" 1>&6
! echo "configure:3760: checking for loff_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_loff_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3765 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3771,3782 ****
  fi
  
  echo $ac_n "checking for offset_t""... $ac_c" 1>&6
! echo "configure:3775: checking for offset_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_offset_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3780 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3789,3800 ----
  fi
  
  echo $ac_n "checking for offset_t""... $ac_c" 1>&6
! echo "configure:3793: checking for offset_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_offset_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3798 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3804,3815 ****
  fi
  
  echo $ac_n "checking for ssize_t""... $ac_c" 1>&6
! echo "configure:3808: checking for ssize_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_ssize_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3813 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3822,3833 ----
  fi
  
  echo $ac_n "checking for ssize_t""... $ac_c" 1>&6
! echo "configure:3826: checking for ssize_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_ssize_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3831 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3837,3848 ****
  fi
  
  echo $ac_n "checking for wchar_t""... $ac_c" 1>&6
! echo "configure:3841: checking for wchar_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_wchar_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3846 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
--- 3855,3866 ----
  fi
  
  echo $ac_n "checking for wchar_t""... $ac_c" 1>&6
! echo "configure:3859: checking for wchar_t" >&5
  if eval "test \"`echo '$''{'ac_cv_type_wchar_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 3864 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if STDC_HEADERS
***************
*** 3872,3878 ****
  
  # we need libcups for CUPS support...
  echo $ac_n "checking for httpConnect in -lcups""... $ac_c" 1>&6
! echo "configure:3876: checking for httpConnect in -lcups" >&5
  ac_lib_var=`echo cups'_'httpConnect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 3890,3896 ----
  
  # we need libcups for CUPS support...
  echo $ac_n "checking for httpConnect in -lcups""... $ac_c" 1>&6
! echo "configure:3894: checking for httpConnect in -lcups" >&5
  ac_lib_var=`echo cups'_'httpConnect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 3880,3886 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lcups  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3884 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 3898,3904 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lcups  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3902 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 3891,3897 ****
  httpConnect()
  ; return 0; }
  EOF
! if { (eval echo configure:3895: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 3909,3915 ----
  httpConnect()
  ; return 0; }
  EOF
! if { (eval echo configure:3913: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 3921,3927 ****
  
  # we need libdl for PAM and the new VFS code
  echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
! echo "configure:3925: checking for dlopen in -ldl" >&5
  ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 3939,3945 ----
  
  # we need libdl for PAM and the new VFS code
  echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
! echo "configure:3943: checking for dlopen in -ldl" >&5
  ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 3929,3935 ****
    ac_save_LIBS="$LIBS"
  LIBS="-ldl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3933 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 3947,3953 ----
    ac_save_LIBS="$LIBS"
  LIBS="-ldl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 3951 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 3940,3946 ****
  dlopen()
  ; return 0; }
  EOF
! if { (eval echo configure:3944: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 3958,3964 ----
  dlopen()
  ; return 0; }
  EOF
! if { (eval echo configure:3962: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 3966,3978 ****
  
  
  echo $ac_n "checking for sig_atomic_t type""... $ac_c" 1>&6
! echo "configure:3970: checking for sig_atomic_t type" >&5
  if eval "test \"`echo '$''{'samba_cv_sig_atomic_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 3976 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
--- 3984,3996 ----
  
  
  echo $ac_n "checking for sig_atomic_t type""... $ac_c" 1>&6
! echo "configure:3988: checking for sig_atomic_t type" >&5
  if eval "test \"`echo '$''{'samba_cv_sig_atomic_t'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 3994 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
***************
*** 3985,3991 ****
  sig_atomic_t i = 0
  ; return 0; }
  EOF
! if { (eval echo configure:3989: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_sig_atomic_t=yes
  else
--- 4003,4009 ----
  sig_atomic_t i = 0
  ; return 0; }
  EOF
! if { (eval echo configure:4007: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_sig_atomic_t=yes
  else
***************
*** 4006,4025 ****
  fi
  
  echo $ac_n "checking for errno in errno.h""... $ac_c" 1>&6
! echo "configure:4010: checking for errno in errno.h" >&5
  if eval "test \"`echo '$''{'samba_cv_errno'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 4016 "configure"
  #include "confdefs.h"
  #include <errno.h>
  int main() {
  int i = errno
  ; return 0; }
  EOF
! if { (eval echo configure:4023: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_errno=yes
  else
--- 4024,4043 ----
  fi
  
  echo $ac_n "checking for errno in errno.h""... $ac_c" 1>&6
! echo "configure:4028: checking for errno in errno.h" >&5
  if eval "test \"`echo '$''{'samba_cv_errno'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 4034 "configure"
  #include "confdefs.h"
  #include <errno.h>
  int main() {
  int i = errno
  ; return 0; }
  EOF
! if { (eval echo configure:4041: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_errno=yes
  else
***************
*** 4041,4060 ****
  
  # stupid glibc has the functions but no declaration. grrrr.
  echo $ac_n "checking for setresuid declaration""... $ac_c" 1>&6
! echo "configure:4045: checking for setresuid declaration" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresuid_decl'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 4051 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  int main() {
  int i = (int)setresuid
  ; return 0; }
  EOF
! if { (eval echo configure:4058: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_have_setresuid_decl=yes
  else
--- 4059,4078 ----
  
  # stupid glibc has the functions but no declaration. grrrr.
  echo $ac_n "checking for setresuid declaration""... $ac_c" 1>&6
! echo "configure:4063: checking for setresuid declaration" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresuid_decl'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 4069 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  int main() {
  int i = (int)setresuid
  ; return 0; }
  EOF
! if { (eval echo configure:4076: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_have_setresuid_decl=yes
  else
***************
*** 4076,4095 ****
  
  # stupid glibc has the functions but no declaration. grrrr.
  echo $ac_n "checking for setresgid declaration""... $ac_c" 1>&6
! echo "configure:4080: checking for setresgid declaration" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresgid_decl'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 4086 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  int main() {
  int i = (int)setresgid
  ; return 0; }
  EOF
! if { (eval echo configure:4093: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_have_setresgid_decl=yes
  else
--- 4094,4113 ----
  
  # stupid glibc has the functions but no declaration. grrrr.
  echo $ac_n "checking for setresgid declaration""... $ac_c" 1>&6
! echo "configure:4098: checking for setresgid declaration" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresgid_decl'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 4104 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  int main() {
  int i = (int)setresgid
  ; return 0; }
  EOF
! if { (eval echo configure:4111: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_have_setresgid_decl=yes
  else
***************
*** 4112,4118 ****
  # and glibc has setresuid under linux but the function does
  # nothing until kernel 2.1.44! very dumb.
  echo $ac_n "checking for real setresuid""... $ac_c" 1>&6
! echo "configure:4116: checking for real setresuid" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresuid'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4130,4136 ----
  # and glibc has setresuid under linux but the function does
  # nothing until kernel 2.1.44! very dumb.
  echo $ac_n "checking for real setresuid""... $ac_c" 1>&6
! echo "configure:4134: checking for real setresuid" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresuid'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4121,4132 ****
    samba_cv_have_setresuid=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 4125 "configure"
  #include "confdefs.h"
  #include <errno.h>
  main() { setresuid(1,1,1); setresuid(2,2,2); exit(errno==EPERM?0:1);}
  EOF
! if { (eval echo configure:4130: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_have_setresuid=yes
  else
--- 4139,4150 ----
    samba_cv_have_setresuid=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 4143 "configure"
  #include "confdefs.h"
  #include <errno.h>
  main() { setresuid(1,1,1); setresuid(2,2,2); exit(errno==EPERM?0:1);}
  EOF
! if { (eval echo configure:4148: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_have_setresuid=yes
  else
***************
*** 4151,4157 ****
  # Do the same check for setresguid...
  #
  echo $ac_n "checking for real setresgid""... $ac_c" 1>&6
! echo "configure:4155: checking for real setresgid" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresgid'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4169,4175 ----
  # Do the same check for setresguid...
  #
  echo $ac_n "checking for real setresgid""... $ac_c" 1>&6
! echo "configure:4173: checking for real setresgid" >&5
  if eval "test \"`echo '$''{'samba_cv_have_setresgid'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4160,4172 ****
    samba_cv_have_setresgid=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 4164 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  #include <errno.h>
  main() { errno = 0; setresgid(1,1,1); exit(errno != 0 ? (errno==EPERM ? 0 : 1) : 0);}
  EOF
! if { (eval echo configure:4170: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_have_setresgid=yes
  else
--- 4178,4190 ----
    samba_cv_have_setresgid=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 4182 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  #include <errno.h>
  main() { errno = 0; setresgid(1,1,1); exit(errno != 0 ? (errno==EPERM ? 0 : 1) : 0);}
  EOF
! if { (eval echo configure:4188: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_have_setresgid=yes
  else
***************
*** 4189,4195 ****
  fi
  
  echo $ac_n "checking for 8-bit clean memcmp""... $ac_c" 1>&6
! echo "configure:4193: checking for 8-bit clean memcmp" >&5
  if eval "test \"`echo '$''{'ac_cv_func_memcmp_clean'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 4207,4213 ----
  fi
  
  echo $ac_n "checking for 8-bit clean memcmp""... $ac_c" 1>&6
! echo "configure:4211: checking for 8-bit clean memcmp" >&5
  if eval "test \"`echo '$''{'ac_cv_func_memcmp_clean'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 4197,4203 ****
    ac_cv_func_memcmp_clean=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4201 "configure"
  #include "confdefs.h"
  
  main()
--- 4215,4221 ----
    ac_cv_func_memcmp_clean=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 4219 "configure"
  #include "confdefs.h"
  
  main()
***************
*** 4207,4213 ****
  }
  
  EOF
! if { (eval echo configure:4211: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_func_memcmp_clean=yes
  else
--- 4225,4231 ----
  }
  
  EOF
! if { (eval echo configure:4229: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    ac_cv_func_memcmp_clean=yes
  else
***************
*** 4230,4241 ****
  for ac_func in crypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4234: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4239 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 4248,4259 ----
  for ac_func in crypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4252: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4257 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 4258,4264 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:4262: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 4276,4282 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:4280: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 4284,4290 ****
  
  if test x"$ac_cv_func_crypt" = x"no"; then
      echo $ac_n "checking for crypt in -lcrypt""... $ac_c" 1>&6
! echo "configure:4288: checking for crypt in -lcrypt" >&5
  ac_lib_var=`echo crypt'_'crypt | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4302,4308 ----
  
  if test x"$ac_cv_func_crypt" = x"no"; then
      echo $ac_n "checking for crypt in -lcrypt""... $ac_c" 1>&6
! echo "configure:4306: checking for crypt in -lcrypt" >&5
  ac_lib_var=`echo crypt'_'crypt | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4292,4298 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lcrypt  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4296 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4310,4316 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lcrypt  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4314 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4303,4309 ****
  crypt()
  ; return 0; }
  EOF
! if { (eval echo configure:4307: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4321,4327 ----
  crypt()
  ; return 0; }
  EOF
! if { (eval echo configure:4325: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4335,4341 ****
  
  # test for where we get readline() from
  echo $ac_n "checking whether to use readline""... $ac_c" 1>&6
! echo "configure:4339: checking whether to use readline" >&5
  # Check whether --with-readline or --without-readline was given.
  if test "${with_readline+set}" = set; then
    withval="$with_readline"
--- 4353,4359 ----
  
  # test for where we get readline() from
  echo $ac_n "checking whether to use readline""... $ac_c" 1>&6
! echo "configure:4357: checking whether to use readline" >&5
  # Check whether --with-readline or --without-readline was given.
  if test "${with_readline+set}" = set; then
    withval="$with_readline"
***************
*** 4347,4363 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4351: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4356 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4361: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4365,4381 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4369: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4374 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4379: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4387,4403 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4391: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4396 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4401: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4405,4421 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4409: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4414 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4419: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4428,4444 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4432: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4437 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4442: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4446,4462 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4450: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4455 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4460: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4461,4467 ****
   
        for termlib in ncurses curses termcap terminfo termlib; do
         echo $ac_n "checking for tgetent in -l${termlib}""... $ac_c" 1>&6
! echo "configure:4465: checking for tgetent in -l${termlib}" >&5
  ac_lib_var=`echo ${termlib}'_'tgetent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4479,4485 ----
   
        for termlib in ncurses curses termcap terminfo termlib; do
         echo $ac_n "checking for tgetent in -l${termlib}""... $ac_c" 1>&6
! echo "configure:4483: checking for tgetent in -l${termlib}" >&5
  ac_lib_var=`echo ${termlib}'_'tgetent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4469,4475 ****
    ac_save_LIBS="$LIBS"
  LIBS="-l${termlib}  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4473 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4487,4493 ----
    ac_save_LIBS="$LIBS"
  LIBS="-l${termlib}  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4491 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4480,4486 ****
  tgetent()
  ; return 0; }
  EOF
! if { (eval echo configure:4484: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4498,4504 ----
  tgetent()
  ; return 0; }
  EOF
! if { (eval echo configure:4502: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4502,4508 ****
  
        done
        echo $ac_n "checking for rl_callback_handler_install in -lreadline""... $ac_c" 1>&6
! echo "configure:4506: checking for rl_callback_handler_install in -lreadline" >&5
  ac_lib_var=`echo readline'_'rl_callback_handler_install | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4520,4526 ----
  
        done
        echo $ac_n "checking for rl_callback_handler_install in -lreadline""... $ac_c" 1>&6
! echo "configure:4524: checking for rl_callback_handler_install in -lreadline" >&5
  ac_lib_var=`echo readline'_'rl_callback_handler_install | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4510,4516 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lreadline $TERMLIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4514 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4528,4534 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lreadline $TERMLIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4532 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4521,4527 ****
  rl_callback_handler_install()
  ; return 0; }
  EOF
! if { (eval echo configure:4525: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4539,4545 ----
  rl_callback_handler_install()
  ; return 0; }
  EOF
! if { (eval echo configure:4543: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4572,4588 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4576: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4581 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4586: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4590,4606 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4594: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4599 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4604: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4612,4628 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4616: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4621 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4626: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4630,4646 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4634: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4639 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4644: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4653,4669 ****
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4657: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4662 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4667: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
--- 4671,4687 ----
  do
  ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
  echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
! echo "configure:4675: checking for $ac_hdr" >&5
  if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4680 "configure"
  #include "confdefs.h"
  #include <$ac_hdr>
  EOF
  ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
! { (eval echo configure:4685: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
  ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
  if test -z "$ac_err"; then
    rm -rf conftest*
***************
*** 4686,4692 ****
   
        for termlib in ncurses curses termcap terminfo termlib; do
         echo $ac_n "checking for tgetent in -l${termlib}""... $ac_c" 1>&6
! echo "configure:4690: checking for tgetent in -l${termlib}" >&5
  ac_lib_var=`echo ${termlib}'_'tgetent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4704,4710 ----
   
        for termlib in ncurses curses termcap terminfo termlib; do
         echo $ac_n "checking for tgetent in -l${termlib}""... $ac_c" 1>&6
! echo "configure:4708: checking for tgetent in -l${termlib}" >&5
  ac_lib_var=`echo ${termlib}'_'tgetent | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4694,4700 ****
    ac_save_LIBS="$LIBS"
  LIBS="-l${termlib}  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4698 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4712,4718 ----
    ac_save_LIBS="$LIBS"
  LIBS="-l${termlib}  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4716 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4705,4711 ****
  tgetent()
  ; return 0; }
  EOF
! if { (eval echo configure:4709: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4723,4729 ----
  tgetent()
  ; return 0; }
  EOF
! if { (eval echo configure:4727: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4727,4733 ****
  
        done
        echo $ac_n "checking for rl_callback_handler_install in -lreadline""... $ac_c" 1>&6
! echo "configure:4731: checking for rl_callback_handler_install in -lreadline" >&5
  ac_lib_var=`echo readline'_'rl_callback_handler_install | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4745,4751 ----
  
        done
        echo $ac_n "checking for rl_callback_handler_install in -lreadline""... $ac_c" 1>&6
! echo "configure:4749: checking for rl_callback_handler_install in -lreadline" >&5
  ac_lib_var=`echo readline'_'rl_callback_handler_install | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4735,4741 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lreadline $TERMLIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4739 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4753,4759 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lreadline $TERMLIBS $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4757 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4746,4752 ****
  rl_callback_handler_install()
  ; return 0; }
  EOF
! if { (eval echo configure:4750: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4764,4770 ----
  rl_callback_handler_install()
  ; return 0; }
  EOF
! if { (eval echo configure:4768: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4801,4812 ****
  for ac_func in connect
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4805: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4810 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 4819,4830 ----
  for ac_func in connect
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:4823: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 4828 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 4829,4835 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:4833: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 4847,4853 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:4851: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 4857,4863 ****
      case "$LIBS" in
      *-lnsl*) ;;
      *) echo $ac_n "checking for printf in -lnsl_s""... $ac_c" 1>&6
! echo "configure:4861: checking for printf in -lnsl_s" >&5
  ac_lib_var=`echo nsl_s'_'printf | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4875,4881 ----
      case "$LIBS" in
      *-lnsl*) ;;
      *) echo $ac_n "checking for printf in -lnsl_s""... $ac_c" 1>&6
! echo "configure:4879: checking for printf in -lnsl_s" >&5
  ac_lib_var=`echo nsl_s'_'printf | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4865,4871 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl_s  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4869 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4883,4889 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl_s  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4887 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4876,4882 ****
  printf()
  ; return 0; }
  EOF
! if { (eval echo configure:4880: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4894,4900 ----
  printf()
  ; return 0; }
  EOF
! if { (eval echo configure:4898: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4907,4913 ****
      case "$LIBS" in
      *-lnsl*) ;;
      *) echo $ac_n "checking for printf in -lnsl""... $ac_c" 1>&6
! echo "configure:4911: checking for printf in -lnsl" >&5
  ac_lib_var=`echo nsl'_'printf | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4925,4931 ----
      case "$LIBS" in
      *-lnsl*) ;;
      *) echo $ac_n "checking for printf in -lnsl""... $ac_c" 1>&6
! echo "configure:4929: checking for printf in -lnsl" >&5
  ac_lib_var=`echo nsl'_'printf | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4915,4921 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4919 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4933,4939 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4937 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4926,4932 ****
  printf()
  ; return 0; }
  EOF
! if { (eval echo configure:4930: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4944,4950 ----
  printf()
  ; return 0; }
  EOF
! if { (eval echo configure:4948: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 4957,4963 ****
      case "$LIBS" in
      *-lsocket*) ;;
      *) echo $ac_n "checking for connect in -lsocket""... $ac_c" 1>&6
! echo "configure:4961: checking for connect in -lsocket" >&5
  ac_lib_var=`echo socket'_'connect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 4975,4981 ----
      case "$LIBS" in
      *-lsocket*) ;;
      *) echo $ac_n "checking for connect in -lsocket""... $ac_c" 1>&6
! echo "configure:4979: checking for connect in -lsocket" >&5
  ac_lib_var=`echo socket'_'connect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 4965,4971 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsocket  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4969 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 4983,4989 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsocket  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 4987 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 4976,4982 ****
  connect()
  ; return 0; }
  EOF
! if { (eval echo configure:4980: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 4994,5000 ----
  connect()
  ; return 0; }
  EOF
! if { (eval echo configure:4998: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 5007,5013 ****
      case "$LIBS" in
      *-linet*) ;;
      *) echo $ac_n "checking for connect in -linet""... $ac_c" 1>&6
! echo "configure:5011: checking for connect in -linet" >&5
  ac_lib_var=`echo inet'_'connect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 5025,5031 ----
      case "$LIBS" in
      *-linet*) ;;
      *) echo $ac_n "checking for connect in -linet""... $ac_c" 1>&6
! echo "configure:5029: checking for connect in -linet" >&5
  ac_lib_var=`echo inet'_'connect | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 5015,5021 ****
    ac_save_LIBS="$LIBS"
  LIBS="-linet  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5019 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 5033,5039 ----
    ac_save_LIBS="$LIBS"
  LIBS="-linet  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5037 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 5026,5032 ****
  connect()
  ; return 0; }
  EOF
! if { (eval echo configure:5030: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 5044,5050 ----
  connect()
  ; return 0; }
  EOF
! if { (eval echo configure:5048: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 5070,5081 ****
  for ac_func in yp_get_default_domain
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5074: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5079 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5088,5099 ----
  for ac_func in yp_get_default_domain
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5092: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5097 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5098,5104 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5102: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5116,5122 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5120: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5124,5130 ****
  
  if test x"$ac_cv_func_yp_get_default_domain" = x"no"; then
  	echo $ac_n "checking for yp_get_default_domain in -lnsl""... $ac_c" 1>&6
! echo "configure:5128: checking for yp_get_default_domain in -lnsl" >&5
  ac_lib_var=`echo nsl'_'yp_get_default_domain | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 5142,5148 ----
  
  if test x"$ac_cv_func_yp_get_default_domain" = x"no"; then
  	echo $ac_n "checking for yp_get_default_domain in -lnsl""... $ac_c" 1>&6
! echo "configure:5146: checking for yp_get_default_domain in -lnsl" >&5
  ac_lib_var=`echo nsl'_'yp_get_default_domain | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 5132,5138 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5136 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 5150,5156 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lnsl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 5154 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 5143,5149 ****
  yp_get_default_domain()
  ; return 0; }
  EOF
! if { (eval echo configure:5147: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 5161,5167 ----
  yp_get_default_domain()
  ; return 0; }
  EOF
! if { (eval echo configure:5165: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 5173,5184 ****
  for ac_func in execl
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5177: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5182 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5191,5202 ----
  for ac_func in execl
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5195: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5200 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5201,5207 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5205: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5219,5225 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5223: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5234,5245 ****
  for ac_func in waitpid getcwd strdup strtoul strerror chown fchown chmod fchmod chroot
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5238: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5243 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5252,5263 ----
  for ac_func in waitpid getcwd strdup strtoul strerror chown fchown chmod fchmod chroot
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5256: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5261 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5262,5268 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5266: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5280,5286 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5284: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5289,5300 ****
  for ac_func in fstat strchr utime utimes getrlimit fsync bzero memset
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5293: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5298 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5307,5318 ----
  for ac_func in fstat strchr utime utimes getrlimit fsync bzero memset
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5311: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5316 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5317,5323 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5321: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5335,5341 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5339: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5344,5355 ****
  for ac_func in memmove vsnprintf snprintf setsid glob strpbrk pipe crypt16 getauthuid
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5348: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5353 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5362,5373 ----
  for ac_func in memmove vsnprintf snprintf setsid glob strpbrk pipe crypt16 getauthuid
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5366: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5371 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5372,5378 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5376: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5390,5396 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5394: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5399,5410 ****
  for ac_func in strftime sigprocmask sigblock sigaction innetgr setnetgrent getnetgrent endnetgrent
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5403: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5408 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5417,5428 ----
  for ac_func in strftime sigprocmask sigblock sigaction innetgr setnetgrent getnetgrent endnetgrent
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5421: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5426 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5427,5433 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5431: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5445,5451 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5449: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5454,5465 ****
  for ac_func in initgroups select poll rdchk getgrnam getgrent pathconf
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5458: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5463 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5472,5483 ----
  for ac_func in initgroups select poll rdchk getgrnam getgrent pathconf
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5476: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5481 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5482,5488 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5486: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5500,5506 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5504: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5509,5520 ****
  for ac_func in setpriv setgidx setuidx setgroups sysconf mktime rename ftruncate stat64 fstat64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5513: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5518 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5527,5538 ----
  for ac_func in setpriv setgidx setuidx setgroups sysconf mktime rename ftruncate stat64 fstat64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5531: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5536 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5537,5543 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5541: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5555,5561 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5559: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5564,5575 ****
  for ac_func in lstat64 fopen64 atexit grantpt dup2 lseek64 ftruncate64 readdir64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5568: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5573 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5582,5593 ----
  for ac_func in lstat64 fopen64 atexit grantpt dup2 lseek64 ftruncate64 readdir64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5586: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5591 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5592,5598 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5596: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5610,5616 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5614: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5619,5630 ****
  for ac_func in fseek64 fseeko64 ftell64 ftello64 setluid getpwanam setlinebuf
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5623: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5628 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5637,5648 ----
  for ac_func in fseek64 fseeko64 ftell64 ftello64 setluid getpwanam setlinebuf
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5641: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5646 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5647,5653 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5651: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5665,5671 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5669: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5674,5685 ****
  for ac_func in srandom random srand rand setenv usleep strcasecmp fcvt fcvtl
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5678: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5683 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5692,5703 ----
  for ac_func in srandom random srand rand setenv usleep strcasecmp fcvt fcvtl
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5696: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5701 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5702,5708 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5706: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5720,5726 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5724: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5731,5742 ****
  for ac_func in syscall
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5735: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5740 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5749,5760 ----
  for ac_func in syscall
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5753: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5758 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5759,5765 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5763: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5777,5783 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5781: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5787,5798 ****
  for ac_func in _dup _dup2 _opendir _readdir _seekdir _telldir _closedir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5791: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5796 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5805,5816 ----
  for ac_func in _dup _dup2 _opendir _readdir _seekdir _telldir _closedir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5809: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5814 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5815,5821 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5819: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5833,5839 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5837: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5842,5853 ****
  for ac_func in __dup __dup2 __opendir __readdir __seekdir __telldir __closedir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5846: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5851 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5860,5871 ----
  for ac_func in __dup __dup2 __opendir __readdir __seekdir __telldir __closedir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5864: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5869 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5870,5876 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5874: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5888,5894 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5892: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5897,5908 ****
  for ac_func in __getcwd _getcwd
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5901: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5906 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5915,5926 ----
  for ac_func in __getcwd _getcwd
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5919: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5924 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5925,5931 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5929: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5943,5949 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:5947: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 5952,5963 ****
  for ac_func in __xstat __fxstat __lxstat
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5956: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5961 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 5970,5981 ----
  for ac_func in __xstat __fxstat __lxstat
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:5974: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 5979 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 5980,5986 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:5984: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 5998,6004 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6002: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6007,6018 ****
  for ac_func in _stat _lstat _fstat __stat __lstat __fstat
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6011: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6016 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6025,6036 ----
  for ac_func in _stat _lstat _fstat __stat __lstat __fstat
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6029: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6034 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6035,6041 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6039: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6053,6059 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6057: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6062,6073 ****
  for ac_func in _acl __acl _facl __facl _open __open _chdir __chdir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6066: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6071 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6080,6091 ----
  for ac_func in _acl __acl _facl __facl _open __open _chdir __chdir
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6084: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6089 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6090,6096 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6094: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6108,6114 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6112: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6117,6128 ****
  for ac_func in _close __close _fchdir __fchdir _fcntl __fcntl
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6121: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6126 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6135,6146 ----
  for ac_func in _close __close _fchdir __fchdir _fcntl __fcntl
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6139: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6144 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6145,6151 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6149: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6163,6169 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6167: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6172,6183 ****
  for ac_func in getdents _getdents __getdents _lseek __lseek _read __read
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6176: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6181 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6190,6201 ----
  for ac_func in getdents _getdents __getdents _lseek __lseek _read __read
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6194: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6199 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6200,6206 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6204: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6218,6224 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6222: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6227,6238 ****
  for ac_func in _write __write _fork __fork
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6231: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6236 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6245,6256 ----
  for ac_func in _write __write _fork __fork
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6249: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6254 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6255,6261 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6259: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6273,6279 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6277: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6282,6293 ****
  for ac_func in _stat64 __stat64 _fstat64 __fstat64 _lstat64 __lstat64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6286: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6291 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6300,6311 ----
  for ac_func in _stat64 __stat64 _fstat64 __fstat64 _lstat64 __lstat64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6304: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6309 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6310,6316 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6314: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6328,6334 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6332: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6337,6348 ****
  for ac_func in __sys_llseek llseek _llseek __llseek readdir64 _readdir64 __readdir64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6341: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6346 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6355,6366 ----
  for ac_func in __sys_llseek llseek _llseek __llseek readdir64 _readdir64 __readdir64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6359: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6364 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6365,6371 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6369: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6383,6389 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6387: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6392,6403 ****
  for ac_func in pread _pread __pread pread64 _pread64 __pread64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6396: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6401 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6410,6421 ----
  for ac_func in pread _pread __pread pread64 _pread64 __pread64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6414: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6419 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6420,6426 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6424: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6438,6444 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6442: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6447,6458 ****
  for ac_func in pwrite _pwrite __pwrite pwrite64 _pwrite64 __pwrite64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6451: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6456 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6465,6476 ----
  for ac_func in pwrite _pwrite __pwrite pwrite64 _pwrite64 __pwrite64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6469: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6474 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6475,6481 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6479: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6493,6499 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6497: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6502,6513 ****
  for ac_func in open64 _open64 __open64 creat64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6506: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6511 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6520,6531 ----
  for ac_func in open64 _open64 __open64 creat64
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6524: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6529 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6530,6536 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6534: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6548,6554 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6552: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6561,6569 ****
  
  if test x$ac_cv_func_stat64 = xno ; then
    echo $ac_n "checking for stat64 in <sys/stat.h>""... $ac_c" 1>&6
! echo "configure:6565: checking for stat64 in <sys/stat.h>" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6567 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 6579,6587 ----
  
  if test x$ac_cv_func_stat64 = xno ; then
    echo $ac_n "checking for stat64 in <sys/stat.h>""... $ac_c" 1>&6
! echo "configure:6583: checking for stat64 in <sys/stat.h>" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6585 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 6575,6581 ****
  struct stat64 st64; exit(stat64(".",&st64));
  ; return 0; }
  EOF
! if { (eval echo configure:6579: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_cv_func_stat64=yes
  else
--- 6593,6599 ----
  struct stat64 st64; exit(stat64(".",&st64));
  ; return 0; }
  EOF
! if { (eval echo configure:6597: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_cv_func_stat64=yes
  else
***************
*** 6594,6602 ****
  
  if test x$ac_cv_func_lstat64 = xno ; then
    echo $ac_n "checking for lstat64 in <sys/stat.h>""... $ac_c" 1>&6
! echo "configure:6598: checking for lstat64 in <sys/stat.h>" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6600 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 6612,6620 ----
  
  if test x$ac_cv_func_lstat64 = xno ; then
    echo $ac_n "checking for lstat64 in <sys/stat.h>""... $ac_c" 1>&6
! echo "configure:6616: checking for lstat64 in <sys/stat.h>" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6618 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 6608,6614 ****
  struct stat64 st64; exit(lstat64(".",&st64));
  ; return 0; }
  EOF
! if { (eval echo configure:6612: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_cv_func_lstat64=yes
  else
--- 6626,6632 ----
  struct stat64 st64; exit(lstat64(".",&st64));
  ; return 0; }
  EOF
! if { (eval echo configure:6630: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_cv_func_lstat64=yes
  else
***************
*** 6627,6635 ****
  
  if test x$ac_cv_func_fstat64 = xno ; then
    echo $ac_n "checking for fstat64 in <sys/stat.h>""... $ac_c" 1>&6
! echo "configure:6631: checking for fstat64 in <sys/stat.h>" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6633 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 6645,6653 ----
  
  if test x$ac_cv_func_fstat64 = xno ; then
    echo $ac_n "checking for fstat64 in <sys/stat.h>""... $ac_c" 1>&6
! echo "configure:6649: checking for fstat64 in <sys/stat.h>" >&5
    cat > conftest.$ac_ext <<EOF
! #line 6651 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 6641,6647 ****
  struct stat64 st64; exit(fstat64(0,&st64));
  ; return 0; }
  EOF
! if { (eval echo configure:6645: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_cv_func_fstat64=yes
  else
--- 6659,6665 ----
  struct stat64 st64; exit(fstat64(0,&st64));
  ; return 0; }
  EOF
! if { (eval echo configure:6663: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    ac_cv_func_fstat64=yes
  else
***************
*** 6666,6672 ****
  
  if test x$ac_cv_func_strcasecmp = xno ; then
  	echo $ac_n "checking for strcasecmp in -lresolv""... $ac_c" 1>&6
! echo "configure:6670: checking for strcasecmp in -lresolv" >&5
  ac_lib_var=`echo resolv'_'strcasecmp | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 6684,6690 ----
  
  if test x$ac_cv_func_strcasecmp = xno ; then
  	echo $ac_n "checking for strcasecmp in -lresolv""... $ac_c" 1>&6
! echo "configure:6688: checking for strcasecmp in -lresolv" >&5
  ac_lib_var=`echo resolv'_'strcasecmp | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 6674,6680 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lresolv  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 6678 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 6692,6698 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lresolv  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 6696 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 6685,6691 ****
  strcasecmp()
  ; return 0; }
  EOF
! if { (eval echo configure:6689: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 6703,6709 ----
  strcasecmp()
  ; return 0; }
  EOF
! if { (eval echo configure:6707: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 6721,6732 ****
    *-lsecurity*) for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6725: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6730 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6739,6750 ----
    *-lsecurity*) for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6743: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6748 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6749,6755 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6753: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6767,6773 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6771: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6774,6780 ****
  done
   ;;
    *) echo $ac_n "checking for putprpwnam in -lsecurity""... $ac_c" 1>&6
! echo "configure:6778: checking for putprpwnam in -lsecurity" >&5
  ac_lib_var=`echo security'_'putprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 6792,6798 ----
  done
   ;;
    *) echo $ac_n "checking for putprpwnam in -lsecurity""... $ac_c" 1>&6
! echo "configure:6796: checking for putprpwnam in -lsecurity" >&5
  ac_lib_var=`echo security'_'putprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 6782,6788 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 6786 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 6800,6806 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 6804 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 6793,6799 ****
  putprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:6797: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 6811,6817 ----
  putprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:6815: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 6823,6834 ****
       for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6827: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6832 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6841,6852 ----
       for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6845: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6850 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6851,6857 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6855: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6869,6875 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6873: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6882,6893 ****
    *-lsec*) for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6886: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6891 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 6900,6911 ----
    *-lsec*) for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6904: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6909 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 6910,6916 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:6914: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 6928,6934 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:6932: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 6935,6941 ****
  done
   ;;
    *) echo $ac_n "checking for putprpwnam in -lsec""... $ac_c" 1>&6
! echo "configure:6939: checking for putprpwnam in -lsec" >&5
  ac_lib_var=`echo sec'_'putprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 6953,6959 ----
  done
   ;;
    *) echo $ac_n "checking for putprpwnam in -lsec""... $ac_c" 1>&6
! echo "configure:6957: checking for putprpwnam in -lsec" >&5
  ac_lib_var=`echo sec'_'putprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 6943,6949 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 6947 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 6961,6967 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 6965 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 6954,6960 ****
  putprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:6958: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 6972,6978 ----
  putprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:6976: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 6984,6995 ****
       for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:6988: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 6993 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7002,7013 ----
       for ac_func in putprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7006: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7011 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7012,7018 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7016: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7030,7036 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7034: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7044,7055 ****
    *-lsecurity*) for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7048: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7053 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7062,7073 ----
    *-lsecurity*) for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7066: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7071 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7072,7078 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7076: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7090,7096 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7094: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7097,7103 ****
  done
   ;;
    *) echo $ac_n "checking for set_auth_parameters in -lsecurity""... $ac_c" 1>&6
! echo "configure:7101: checking for set_auth_parameters in -lsecurity" >&5
  ac_lib_var=`echo security'_'set_auth_parameters | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 7115,7121 ----
  done
   ;;
    *) echo $ac_n "checking for set_auth_parameters in -lsecurity""... $ac_c" 1>&6
! echo "configure:7119: checking for set_auth_parameters in -lsecurity" >&5
  ac_lib_var=`echo security'_'set_auth_parameters | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 7105,7111 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7109 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 7123,7129 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7127 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 7116,7122 ****
  set_auth_parameters()
  ; return 0; }
  EOF
! if { (eval echo configure:7120: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 7134,7140 ----
  set_auth_parameters()
  ; return 0; }
  EOF
! if { (eval echo configure:7138: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 7146,7157 ****
       for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7150: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7155 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7164,7175 ----
       for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7168: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7173 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7174,7180 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7178: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7192,7198 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7196: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7205,7216 ****
    *-lsec*) for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7209: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7214 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7223,7234 ----
    *-lsec*) for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7227: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7232 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7233,7239 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7237: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7251,7257 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7255: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7258,7264 ****
  done
   ;;
    *) echo $ac_n "checking for set_auth_parameters in -lsec""... $ac_c" 1>&6
! echo "configure:7262: checking for set_auth_parameters in -lsec" >&5
  ac_lib_var=`echo sec'_'set_auth_parameters | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 7276,7282 ----
  done
   ;;
    *) echo $ac_n "checking for set_auth_parameters in -lsec""... $ac_c" 1>&6
! echo "configure:7280: checking for set_auth_parameters in -lsec" >&5
  ac_lib_var=`echo sec'_'set_auth_parameters | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 7266,7272 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7270 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 7284,7290 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7288 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 7277,7283 ****
  set_auth_parameters()
  ; return 0; }
  EOF
! if { (eval echo configure:7281: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 7295,7301 ----
  set_auth_parameters()
  ; return 0; }
  EOF
! if { (eval echo configure:7299: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 7307,7318 ****
       for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7311: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7316 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7325,7336 ----
       for ac_func in set_auth_parameters
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7329: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7334 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7335,7341 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7339: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7353,7359 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7357: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7368,7379 ****
    *-lgen*) for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7372: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7377 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7386,7397 ----
    *-lgen*) for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7390: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7395 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7396,7402 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7400: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7414,7420 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7418: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7421,7427 ****
  done
   ;;
    *) echo $ac_n "checking for getspnam in -lgen""... $ac_c" 1>&6
! echo "configure:7425: checking for getspnam in -lgen" >&5
  ac_lib_var=`echo gen'_'getspnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 7439,7445 ----
  done
   ;;
    *) echo $ac_n "checking for getspnam in -lgen""... $ac_c" 1>&6
! echo "configure:7443: checking for getspnam in -lgen" >&5
  ac_lib_var=`echo gen'_'getspnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 7429,7435 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lgen  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7433 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 7447,7453 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lgen  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7451 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 7440,7446 ****
  getspnam()
  ; return 0; }
  EOF
! if { (eval echo configure:7444: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 7458,7464 ----
  getspnam()
  ; return 0; }
  EOF
! if { (eval echo configure:7462: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 7470,7481 ****
       for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7474: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7479 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7488,7499 ----
       for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7492: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7497 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7498,7504 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7502: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7516,7522 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7520: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7530,7541 ****
    *-lsecurity*) for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7534: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7539 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7548,7559 ----
    *-lsecurity*) for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7552: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7557 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7558,7564 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7562: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7576,7582 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7580: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7583,7589 ****
  done
   ;;
    *) echo $ac_n "checking for getspnam in -lsecurity""... $ac_c" 1>&6
! echo "configure:7587: checking for getspnam in -lsecurity" >&5
  ac_lib_var=`echo security'_'getspnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 7601,7607 ----
  done
   ;;
    *) echo $ac_n "checking for getspnam in -lsecurity""... $ac_c" 1>&6
! echo "configure:7605: checking for getspnam in -lsecurity" >&5
  ac_lib_var=`echo security'_'getspnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 7591,7597 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7595 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 7609,7615 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7613 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 7602,7608 ****
  getspnam()
  ; return 0; }
  EOF
! if { (eval echo configure:7606: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 7620,7626 ----
  getspnam()
  ; return 0; }
  EOF
! if { (eval echo configure:7624: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 7632,7643 ****
       for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7636: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7641 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7650,7661 ----
       for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7654: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7659 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7660,7666 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7664: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7678,7684 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7682: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7691,7702 ****
    *-lsec*) for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7695: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7700 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7709,7720 ----
    *-lsec*) for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7713: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7718 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7719,7725 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7723: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7737,7743 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7741: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7744,7750 ****
  done
   ;;
    *) echo $ac_n "checking for getspnam in -lsec""... $ac_c" 1>&6
! echo "configure:7748: checking for getspnam in -lsec" >&5
  ac_lib_var=`echo sec'_'getspnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 7762,7768 ----
  done
   ;;
    *) echo $ac_n "checking for getspnam in -lsec""... $ac_c" 1>&6
! echo "configure:7766: checking for getspnam in -lsec" >&5
  ac_lib_var=`echo sec'_'getspnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 7752,7758 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7756 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 7770,7776 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7774 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 7763,7769 ****
  getspnam()
  ; return 0; }
  EOF
! if { (eval echo configure:7767: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 7781,7787 ----
  getspnam()
  ; return 0; }
  EOF
! if { (eval echo configure:7785: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 7793,7804 ****
       for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7797: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7802 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7811,7822 ----
       for ac_func in getspnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7815: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7820 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7821,7827 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7825: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7839,7845 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7843: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7853,7864 ****
    *-lsecurity*) for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7857: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7862 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7871,7882 ----
    *-lsecurity*) for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7875: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7880 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7881,7887 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7885: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 7899,7905 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:7903: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 7906,7912 ****
  done
   ;;
    *) echo $ac_n "checking for bigcrypt in -lsecurity""... $ac_c" 1>&6
! echo "configure:7910: checking for bigcrypt in -lsecurity" >&5
  ac_lib_var=`echo security'_'bigcrypt | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 7924,7930 ----
  done
   ;;
    *) echo $ac_n "checking for bigcrypt in -lsecurity""... $ac_c" 1>&6
! echo "configure:7928: checking for bigcrypt in -lsecurity" >&5
  ac_lib_var=`echo security'_'bigcrypt | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 7914,7920 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7918 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 7932,7938 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 7936 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 7925,7931 ****
  bigcrypt()
  ; return 0; }
  EOF
! if { (eval echo configure:7929: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 7943,7949 ----
  bigcrypt()
  ; return 0; }
  EOF
! if { (eval echo configure:7947: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 7955,7966 ****
       for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7959: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7964 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 7973,7984 ----
       for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:7977: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 7982 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 7983,7989 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:7987: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8001,8007 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8005: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8014,8025 ****
    *-lsec*) for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8018: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8023 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 8032,8043 ----
    *-lsec*) for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8036: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8041 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 8042,8048 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:8046: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8060,8066 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8064: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8067,8073 ****
  done
   ;;
    *) echo $ac_n "checking for bigcrypt in -lsec""... $ac_c" 1>&6
! echo "configure:8071: checking for bigcrypt in -lsec" >&5
  ac_lib_var=`echo sec'_'bigcrypt | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 8085,8091 ----
  done
   ;;
    *) echo $ac_n "checking for bigcrypt in -lsec""... $ac_c" 1>&6
! echo "configure:8089: checking for bigcrypt in -lsec" >&5
  ac_lib_var=`echo sec'_'bigcrypt | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 8075,8081 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 8079 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 8093,8099 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 8097 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 8086,8092 ****
  bigcrypt()
  ; return 0; }
  EOF
! if { (eval echo configure:8090: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 8104,8110 ----
  bigcrypt()
  ; return 0; }
  EOF
! if { (eval echo configure:8108: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 8116,8127 ****
       for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8120: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8125 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 8134,8145 ----
       for ac_func in bigcrypt
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8138: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8143 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 8144,8150 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:8148: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8162,8168 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8166: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8176,8187 ****
    *-lsecurity*) for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8180: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8185 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 8194,8205 ----
    *-lsecurity*) for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8198: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8203 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 8204,8210 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:8208: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8222,8228 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8226: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8229,8235 ****
  done
   ;;
    *) echo $ac_n "checking for getprpwnam in -lsecurity""... $ac_c" 1>&6
! echo "configure:8233: checking for getprpwnam in -lsecurity" >&5
  ac_lib_var=`echo security'_'getprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 8247,8253 ----
  done
   ;;
    *) echo $ac_n "checking for getprpwnam in -lsecurity""... $ac_c" 1>&6
! echo "configure:8251: checking for getprpwnam in -lsecurity" >&5
  ac_lib_var=`echo security'_'getprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 8237,8243 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 8241 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 8255,8261 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsecurity  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 8259 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 8248,8254 ****
  getprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:8252: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 8266,8272 ----
  getprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:8270: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 8278,8289 ****
       for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8282: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8287 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 8296,8307 ----
       for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8300: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8305 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 8306,8312 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:8310: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8324,8330 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8328: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8337,8348 ****
    *-lsec*) for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8341: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8346 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 8355,8366 ----
    *-lsec*) for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8359: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8364 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 8365,8371 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:8369: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8383,8389 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8387: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8390,8396 ****
  done
   ;;
    *) echo $ac_n "checking for getprpwnam in -lsec""... $ac_c" 1>&6
! echo "configure:8394: checking for getprpwnam in -lsec" >&5
  ac_lib_var=`echo sec'_'getprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 8408,8414 ----
  done
   ;;
    *) echo $ac_n "checking for getprpwnam in -lsec""... $ac_c" 1>&6
! echo "configure:8412: checking for getprpwnam in -lsec" >&5
  ac_lib_var=`echo sec'_'getprpwnam | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 8398,8404 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 8402 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 8416,8422 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lsec  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 8420 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 8409,8415 ****
  getprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:8413: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 8427,8433 ----
  getprpwnam()
  ; return 0; }
  EOF
! if { (eval echo configure:8431: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 8439,8450 ****
       for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8443: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8448 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 8457,8468 ----
       for ac_func in getprpwnam
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:8461: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 8466 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 8467,8473 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:8471: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 8485,8491 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:8489: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 8572,8578 ****
  		*dgux*) # Extract the first word of "groff", so it can be a program name with args.
  set dummy groff; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:8576: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_ROFF'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8590,8596 ----
  		*dgux*) # Extract the first word of "groff", so it can be a program name with args.
  set dummy groff; ac_word=$2
  echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
! echo "configure:8594: checking for $ac_word" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_ROFF'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8627,8633 ****
  
  # try to work out how to produce pic code with this compiler
  echo $ac_n "checking whether ${CC-cc} accepts -fpic""... $ac_c" 1>&6
! echo "configure:8631: checking whether ${CC-cc} accepts -fpic" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_fpic'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8645,8651 ----
  
  # try to work out how to produce pic code with this compiler
  echo $ac_n "checking whether ${CC-cc} accepts -fpic""... $ac_c" 1>&6
! echo "configure:8649: checking whether ${CC-cc} accepts -fpic" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_fpic'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8647,8653 ****
  fi
  if test x$PICFLAG = x; then
    echo $ac_n "checking whether ${CC-cc} accepts -KPIC""... $ac_c" 1>&6
! echo "configure:8651: checking whether ${CC-cc} accepts -KPIC" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_KPIC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8665,8671 ----
  fi
  if test x$PICFLAG = x; then
    echo $ac_n "checking whether ${CC-cc} accepts -KPIC""... $ac_c" 1>&6
! echo "configure:8669: checking whether ${CC-cc} accepts -KPIC" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_KPIC'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8668,8674 ****
  fi
  if test x$PICFLAG = x; then
    echo $ac_n "checking whether ${CC-cc} accepts -Kpic""... $ac_c" 1>&6
! echo "configure:8672: checking whether ${CC-cc} accepts -Kpic" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_Kpic'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8686,8692 ----
  fi
  if test x$PICFLAG = x; then
    echo $ac_n "checking whether ${CC-cc} accepts -Kpic""... $ac_c" 1>&6
! echo "configure:8690: checking whether ${CC-cc} accepts -Kpic" >&5
  if eval "test \"`echo '$''{'ac_cv_prog_cc_Kpic'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8691,8697 ****
  ################
  
  echo $ac_n "checking for long long""... $ac_c" 1>&6
! echo "configure:8695: checking for long long" >&5
  if eval "test \"`echo '$''{'samba_cv_have_longlong'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8709,8715 ----
  ################
  
  echo $ac_n "checking for long long""... $ac_c" 1>&6
! echo "configure:8713: checking for long long" >&5
  if eval "test \"`echo '$''{'samba_cv_have_longlong'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8700,8711 ****
    samba_cv_have_longlong=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8704 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main() { long long x = 1000000; x *= x; exit(((x/1000000) == 1000000)? 0: 1); }
  EOF
! if { (eval echo configure:8709: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_have_longlong=yes
  else
--- 8718,8729 ----
    samba_cv_have_longlong=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8722 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main() { long long x = 1000000; x *= x; exit(((x/1000000) == 1000000)? 0: 1); }
  EOF
! if { (eval echo configure:8727: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_have_longlong=yes
  else
***************
*** 8732,8751 ****
  # AIX needs this.
  
  echo $ac_n "checking for LL suffix on long long integers""... $ac_c" 1>&6
! echo "configure:8736: checking for LL suffix on long long integers" >&5
  if eval "test \"`echo '$''{'samba_cv_compiler_supports_ll'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 8742 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
  long long i = 0x8000000000LL
  ; return 0; }
  EOF
! if { (eval echo configure:8749: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_compiler_supports_ll=yes
  else
--- 8750,8769 ----
  # AIX needs this.
  
  echo $ac_n "checking for LL suffix on long long integers""... $ac_c" 1>&6
! echo "configure:8754: checking for LL suffix on long long integers" >&5
  if eval "test \"`echo '$''{'samba_cv_compiler_supports_ll'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
      cat > conftest.$ac_ext <<EOF
! #line 8760 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
  long long i = 0x8000000000LL
  ; return 0; }
  EOF
! if { (eval echo configure:8767: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_compiler_supports_ll=yes
  else
***************
*** 8767,8773 ****
  
    
  echo $ac_n "checking for 64 bit off_t""... $ac_c" 1>&6
! echo "configure:8771: checking for 64 bit off_t" >&5
  if eval "test \"`echo '$''{'samba_cv_SIZEOF_OFF_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8785,8791 ----
  
    
  echo $ac_n "checking for 64 bit off_t""... $ac_c" 1>&6
! echo "configure:8789: checking for 64 bit off_t" >&5
  if eval "test \"`echo '$''{'samba_cv_SIZEOF_OFF_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8776,8788 ****
    samba_cv_SIZEOF_OFF_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8780 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  #include <sys/stat.h>
  main() { exit((sizeof(off_t) == 8) ? 0 : 1); }
  EOF
! if { (eval echo configure:8786: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_SIZEOF_OFF_T=yes
  else
--- 8794,8806 ----
    samba_cv_SIZEOF_OFF_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8798 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  #include <sys/stat.h>
  main() { exit((sizeof(off_t) == 8) ? 0 : 1); }
  EOF
! if { (eval echo configure:8804: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_SIZEOF_OFF_T=yes
  else
***************
*** 8805,8811 ****
  fi
  
  echo $ac_n "checking for off64_t""... $ac_c" 1>&6
! echo "configure:8809: checking for off64_t" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_OFF64_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8823,8829 ----
  fi
  
  echo $ac_n "checking for off64_t""... $ac_c" 1>&6
! echo "configure:8827: checking for off64_t" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_OFF64_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8814,8820 ****
    samba_cv_HAVE_OFF64_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8818 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 8832,8838 ----
    samba_cv_HAVE_OFF64_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8836 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 8824,8830 ****
  #include <sys/stat.h>
  main() { struct stat64 st; off64_t s; if (sizeof(off_t) == sizeof(off64_t)) exit(1); exit((lstat64("/dev/null", &st)==0)?0:1); }
  EOF
! if { (eval echo configure:8828: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_OFF64_T=yes
  else
--- 8842,8848 ----
  #include <sys/stat.h>
  main() { struct stat64 st; off64_t s; if (sizeof(off_t) == sizeof(off64_t)) exit(1); exit((lstat64("/dev/null", &st)==0)?0:1); }
  EOF
! if { (eval echo configure:8846: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_OFF64_T=yes
  else
***************
*** 8847,8853 ****
  fi
  
  echo $ac_n "checking for 64 bit ino_t""... $ac_c" 1>&6
! echo "configure:8851: checking for 64 bit ino_t" >&5
  if eval "test \"`echo '$''{'samba_cv_SIZEOF_INO_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8865,8871 ----
  fi
  
  echo $ac_n "checking for 64 bit ino_t""... $ac_c" 1>&6
! echo "configure:8869: checking for 64 bit ino_t" >&5
  if eval "test \"`echo '$''{'samba_cv_SIZEOF_INO_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8856,8868 ****
    samba_cv_SIZEOF_INO_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8860 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  #include <sys/stat.h>
  main() { exit((sizeof(ino_t) == 8) ? 0 : 1); }
  EOF
! if { (eval echo configure:8866: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_SIZEOF_INO_T=yes
  else
--- 8874,8886 ----
    samba_cv_SIZEOF_INO_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8878 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  #include <sys/stat.h>
  main() { exit((sizeof(ino_t) == 8) ? 0 : 1); }
  EOF
! if { (eval echo configure:8884: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_SIZEOF_INO_T=yes
  else
***************
*** 8885,8891 ****
  fi
  
  echo $ac_n "checking for ino64_t""... $ac_c" 1>&6
! echo "configure:8889: checking for ino64_t" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_INO64_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8903,8909 ----
  fi
  
  echo $ac_n "checking for ino64_t""... $ac_c" 1>&6
! echo "configure:8907: checking for ino64_t" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_INO64_T'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8894,8900 ****
    samba_cv_HAVE_INO64_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8898 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 8912,8918 ----
    samba_cv_HAVE_INO64_T=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8916 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 8904,8910 ****
  #include <sys/stat.h>
  main() { struct stat64 st; ino64_t s; if (sizeof(ino_t) == sizeof(ino64_t)) exit(1); exit((lstat64("/dev/null", &st)==0)?0:1); }
  EOF
! if { (eval echo configure:8908: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_INO64_T=yes
  else
--- 8922,8928 ----
  #include <sys/stat.h>
  main() { struct stat64 st; ino64_t s; if (sizeof(ino_t) == sizeof(ino64_t)) exit(1); exit((lstat64("/dev/null", &st)==0)?0:1); }
  EOF
! if { (eval echo configure:8926: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_INO64_T=yes
  else
***************
*** 8927,8939 ****
  fi
  
  echo $ac_n "checking for struct dirent64""... $ac_c" 1>&6
! echo "configure:8931: checking for struct dirent64" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_STRUCT_DIRENT64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 8937 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 8945,8957 ----
  fi
  
  echo $ac_n "checking for struct dirent64""... $ac_c" 1>&6
! echo "configure:8949: checking for struct dirent64" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_STRUCT_DIRENT64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 8955 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 8945,8951 ****
  struct dirent64 de;
  ; return 0; }
  EOF
! if { (eval echo configure:8949: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_STRUCT_DIRENT64=yes
  else
--- 8963,8969 ----
  struct dirent64 de;
  ; return 0; }
  EOF
! if { (eval echo configure:8967: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_STRUCT_DIRENT64=yes
  else
***************
*** 8966,8972 ****
  fi
  
  echo $ac_n "checking for unsigned char""... $ac_c" 1>&6
! echo "configure:8970: checking for unsigned char" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UNSIGNED_CHAR'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 8984,8990 ----
  fi
  
  echo $ac_n "checking for unsigned char""... $ac_c" 1>&6
! echo "configure:8988: checking for unsigned char" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UNSIGNED_CHAR'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 8975,8986 ****
    samba_cv_HAVE_UNSIGNED_CHAR=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8979 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main() { char c; c=250; exit((c > 0)?0:1); }
  EOF
! if { (eval echo configure:8984: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_UNSIGNED_CHAR=yes
  else
--- 8993,9004 ----
    samba_cv_HAVE_UNSIGNED_CHAR=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 8997 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  main() { char c; c=250; exit((c > 0)?0:1); }
  EOF
! if { (eval echo configure:9002: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_UNSIGNED_CHAR=yes
  else
***************
*** 9003,9015 ****
  fi
  
  echo $ac_n "checking for sin_len in sock""... $ac_c" 1>&6
! echo "configure:9007: checking for sin_len in sock" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_SOCK_SIN_LEN'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9013 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/socket.h>
--- 9021,9033 ----
  fi
  
  echo $ac_n "checking for sin_len in sock""... $ac_c" 1>&6
! echo "configure:9025: checking for sin_len in sock" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_SOCK_SIN_LEN'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9031 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/socket.h>
***************
*** 9018,9024 ****
  struct sockaddr_in sock; sock.sin_len = sizeof(sock);
  ; return 0; }
  EOF
! if { (eval echo configure:9022: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_SOCK_SIN_LEN=yes
  else
--- 9036,9042 ----
  struct sockaddr_in sock; sock.sin_len = sizeof(sock);
  ; return 0; }
  EOF
! if { (eval echo configure:9040: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_SOCK_SIN_LEN=yes
  else
***************
*** 9039,9051 ****
  fi
  
  echo $ac_n "checking whether seekdir returns void""... $ac_c" 1>&6
! echo "configure:9043: checking whether seekdir returns void" >&5
  if eval "test \"`echo '$''{'samba_cv_SEEKDIR_RETURNS_VOID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9049 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <dirent.h>
--- 9057,9069 ----
  fi
  
  echo $ac_n "checking whether seekdir returns void""... $ac_c" 1>&6
! echo "configure:9061: checking whether seekdir returns void" >&5
  if eval "test \"`echo '$''{'samba_cv_SEEKDIR_RETURNS_VOID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9067 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <dirent.h>
***************
*** 9054,9060 ****
  return 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9058: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_SEEKDIR_RETURNS_VOID=yes
  else
--- 9072,9078 ----
  return 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9076: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_SEEKDIR_RETURNS_VOID=yes
  else
***************
*** 9075,9094 ****
  fi
  
  echo $ac_n "checking for __FILE__ macro""... $ac_c" 1>&6
! echo "configure:9079: checking for __FILE__ macro" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FILE_MACRO'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9085 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
  printf("%s\n", __FILE__);
  ; return 0; }
  EOF
! if { (eval echo configure:9092: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_FILE_MACRO=yes
  else
--- 9093,9112 ----
  fi
  
  echo $ac_n "checking for __FILE__ macro""... $ac_c" 1>&6
! echo "configure:9097: checking for __FILE__ macro" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FILE_MACRO'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9103 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
  printf("%s\n", __FILE__);
  ; return 0; }
  EOF
! if { (eval echo configure:9110: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_FILE_MACRO=yes
  else
***************
*** 9109,9128 ****
  fi
  
  echo $ac_n "checking for __FUNCTION__ macro""... $ac_c" 1>&6
! echo "configure:9113: checking for __FUNCTION__ macro" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FUNCTION_MACRO'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9119 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
  printf("%s\n", __FUNCTION__);
  ; return 0; }
  EOF
! if { (eval echo configure:9126: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_FUNCTION_MACRO=yes
  else
--- 9127,9146 ----
  fi
  
  echo $ac_n "checking for __FUNCTION__ macro""... $ac_c" 1>&6
! echo "configure:9131: checking for __FUNCTION__ macro" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FUNCTION_MACRO'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9137 "configure"
  #include "confdefs.h"
  #include <stdio.h>
  int main() {
  printf("%s\n", __FUNCTION__);
  ; return 0; }
  EOF
! if { (eval echo configure:9144: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_FUNCTION_MACRO=yes
  else
***************
*** 9143,9149 ****
  fi
  
  echo $ac_n "checking if gettimeofday takes tz argument""... $ac_c" 1>&6
! echo "configure:9147: checking if gettimeofday takes tz argument" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_GETTIMEOFDAY_TZ'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 9161,9167 ----
  fi
  
  echo $ac_n "checking if gettimeofday takes tz argument""... $ac_c" 1>&6
! echo "configure:9165: checking if gettimeofday takes tz argument" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_GETTIMEOFDAY_TZ'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 9152,9165 ****
    samba_cv_HAVE_GETTIMEOFDAY_TZ=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9156 "configure"
  #include "confdefs.h"
  
  #include <sys/time.h>
  #include <unistd.h>
  main() { struct timeval tv; exit(gettimeofday(&tv, NULL));}
  EOF
! if { (eval echo configure:9163: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_GETTIMEOFDAY_TZ=yes
  else
--- 9170,9183 ----
    samba_cv_HAVE_GETTIMEOFDAY_TZ=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9174 "configure"
  #include "confdefs.h"
  
  #include <sys/time.h>
  #include <unistd.h>
  main() { struct timeval tv; exit(gettimeofday(&tv, NULL));}
  EOF
! if { (eval echo configure:9181: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_GETTIMEOFDAY_TZ=yes
  else
***************
*** 9183,9189 ****
  
  
  echo $ac_n "checking for broken readdir""... $ac_c" 1>&6
! echo "configure:9187: checking for broken readdir" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_BROKEN_READDIR'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 9201,9207 ----
  
  
  echo $ac_n "checking for broken readdir""... $ac_c" 1>&6
! echo "configure:9205: checking for broken readdir" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_BROKEN_READDIR'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 9192,9198 ****
    samba_cv_HAVE_BROKEN_READDIR=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9196 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <dirent.h>
--- 9210,9216 ----
    samba_cv_HAVE_BROKEN_READDIR=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9214 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <dirent.h>
***************
*** 9200,9206 ****
  if (di && di->d_name[-2] == '.' && di->d_name[-1] == 0 &&
  di->d_name[0] == 0) exit(0); exit(1);} 
  EOF
! if { (eval echo configure:9204: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_BROKEN_READDIR=yes
  else
--- 9218,9224 ----
  if (di && di->d_name[-2] == '.' && di->d_name[-1] == 0 &&
  di->d_name[0] == 0) exit(0); exit(1);} 
  EOF
! if { (eval echo configure:9222: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_BROKEN_READDIR=yes
  else
***************
*** 9223,9235 ****
  fi
  
  echo $ac_n "checking for utimbuf""... $ac_c" 1>&6
! echo "configure:9227: checking for utimbuf" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UTIMBUF'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9233 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utime.h>
--- 9241,9253 ----
  fi
  
  echo $ac_n "checking for utimbuf""... $ac_c" 1>&6
! echo "configure:9245: checking for utimbuf" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UTIMBUF'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9251 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utime.h>
***************
*** 9237,9243 ****
  struct utimbuf tbuf;  tbuf.actime = 0; tbuf.modtime = 1; exit(utime("foo.c",&tbuf));
  ; return 0; }
  EOF
! if { (eval echo configure:9241: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UTIMBUF=yes
  else
--- 9255,9261 ----
  struct utimbuf tbuf;  tbuf.actime = 0; tbuf.modtime = 1; exit(utime("foo.c",&tbuf));
  ; return 0; }
  EOF
! if { (eval echo configure:9259: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UTIMBUF=yes
  else
***************
*** 9261,9272 ****
  for ac_func in pututline pututxline updwtmp updwtmpx getutmpx
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:9265: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 9270 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
--- 9279,9290 ----
  for ac_func in pututline pututxline updwtmp updwtmpx getutmpx
  do
  echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
! echo "configure:9283: checking for $ac_func" >&5
  if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 9288 "configure"
  #include "confdefs.h"
  /* System header to define __stub macros and hopefully few prototypes,
      which can conflict with char $ac_func(); below.  */
***************
*** 9289,9295 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:9293: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
--- 9307,9313 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:9311: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_func_$ac_func=yes"
  else
***************
*** 9315,9327 ****
  
  
  echo $ac_n "checking for ut_name in utmp""... $ac_c" 1>&6
! echo "configure:9319: checking for ut_name in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_NAME'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9325 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9333,9345 ----
  
  
  echo $ac_n "checking for ut_name in utmp""... $ac_c" 1>&6
! echo "configure:9337: checking for ut_name in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_NAME'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9343 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9329,9335 ****
  struct utmp ut;  ut.ut_name[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9333: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_NAME=yes
  else
--- 9347,9353 ----
  struct utmp ut;  ut.ut_name[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9351: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_NAME=yes
  else
***************
*** 9350,9362 ****
  fi 
  
  echo $ac_n "checking for ut_user in utmp""... $ac_c" 1>&6
! echo "configure:9354: checking for ut_user in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_USER'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9360 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9368,9380 ----
  fi 
  
  echo $ac_n "checking for ut_user in utmp""... $ac_c" 1>&6
! echo "configure:9372: checking for ut_user in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_USER'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9378 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9364,9370 ****
  struct utmp ut;  ut.ut_user[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9368: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_USER=yes
  else
--- 9382,9388 ----
  struct utmp ut;  ut.ut_user[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9386: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_USER=yes
  else
***************
*** 9385,9397 ****
  fi 
  
  echo $ac_n "checking for ut_id in utmp""... $ac_c" 1>&6
! echo "configure:9389: checking for ut_id in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_ID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9395 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9403,9415 ----
  fi 
  
  echo $ac_n "checking for ut_id in utmp""... $ac_c" 1>&6
! echo "configure:9407: checking for ut_id in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_ID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9413 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9399,9405 ****
  struct utmp ut;  ut.ut_id[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9403: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_ID=yes
  else
--- 9417,9423 ----
  struct utmp ut;  ut.ut_id[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9421: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_ID=yes
  else
***************
*** 9420,9432 ****
  fi 
  
  echo $ac_n "checking for ut_host in utmp""... $ac_c" 1>&6
! echo "configure:9424: checking for ut_host in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_HOST'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9430 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9438,9450 ----
  fi 
  
  echo $ac_n "checking for ut_host in utmp""... $ac_c" 1>&6
! echo "configure:9442: checking for ut_host in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_HOST'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9448 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9434,9440 ****
  struct utmp ut;  ut.ut_host[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9438: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_HOST=yes
  else
--- 9452,9458 ----
  struct utmp ut;  ut.ut_host[0] = 'a';
  ; return 0; }
  EOF
! if { (eval echo configure:9456: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_HOST=yes
  else
***************
*** 9455,9467 ****
  fi 
  
  echo $ac_n "checking for ut_time in utmp""... $ac_c" 1>&6
! echo "configure:9459: checking for ut_time in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_TIME'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9465 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9473,9485 ----
  fi 
  
  echo $ac_n "checking for ut_time in utmp""... $ac_c" 1>&6
! echo "configure:9477: checking for ut_time in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_TIME'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9483 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9469,9475 ****
  struct utmp ut;  time_t t; ut.ut_time = t;
  ; return 0; }
  EOF
! if { (eval echo configure:9473: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_TIME=yes
  else
--- 9487,9493 ----
  struct utmp ut;  time_t t; ut.ut_time = t;
  ; return 0; }
  EOF
! if { (eval echo configure:9491: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_TIME=yes
  else
***************
*** 9490,9502 ****
  fi 
  
  echo $ac_n "checking for ut_tv in utmp""... $ac_c" 1>&6
! echo "configure:9494: checking for ut_tv in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_TV'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9500 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9508,9520 ----
  fi 
  
  echo $ac_n "checking for ut_tv in utmp""... $ac_c" 1>&6
! echo "configure:9512: checking for ut_tv in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_TV'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9518 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9504,9510 ****
  struct utmp ut;  struct timeval tv; ut.ut_tv = tv;
  ; return 0; }
  EOF
! if { (eval echo configure:9508: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_TV=yes
  else
--- 9522,9528 ----
  struct utmp ut;  struct timeval tv; ut.ut_tv = tv;
  ; return 0; }
  EOF
! if { (eval echo configure:9526: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_TV=yes
  else
***************
*** 9525,9537 ****
  fi 
  
  echo $ac_n "checking for ut_type in utmp""... $ac_c" 1>&6
! echo "configure:9529: checking for ut_type in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_TYPE'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9535 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9543,9555 ----
  fi 
  
  echo $ac_n "checking for ut_type in utmp""... $ac_c" 1>&6
! echo "configure:9547: checking for ut_type in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_TYPE'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9553 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9539,9545 ****
  struct utmp ut;  ut.ut_type = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9543: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_TYPE=yes
  else
--- 9557,9563 ----
  struct utmp ut;  ut.ut_type = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9561: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_TYPE=yes
  else
***************
*** 9560,9572 ****
  fi 
  
  echo $ac_n "checking for ut_pid in utmp""... $ac_c" 1>&6
! echo "configure:9564: checking for ut_pid in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_PID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9570 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9578,9590 ----
  fi 
  
  echo $ac_n "checking for ut_pid in utmp""... $ac_c" 1>&6
! echo "configure:9582: checking for ut_pid in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_PID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9588 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9574,9580 ****
  struct utmp ut;  ut.ut_pid = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9578: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_PID=yes
  else
--- 9592,9598 ----
  struct utmp ut;  ut.ut_pid = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9596: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_PID=yes
  else
***************
*** 9595,9607 ****
  fi 
  
  echo $ac_n "checking for ut_exit in utmp""... $ac_c" 1>&6
! echo "configure:9599: checking for ut_exit in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_EXIT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9605 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9613,9625 ----
  fi 
  
  echo $ac_n "checking for ut_exit in utmp""... $ac_c" 1>&6
! echo "configure:9617: checking for ut_exit in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_EXIT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9623 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9609,9615 ****
  struct utmp ut;  ut.ut_exit.e_exit = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9613: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_EXIT=yes
  else
--- 9627,9633 ----
  struct utmp ut;  ut.ut_exit.e_exit = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9631: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_EXIT=yes
  else
***************
*** 9630,9642 ****
  fi 
  
  echo $ac_n "checking for ut_addr in utmp""... $ac_c" 1>&6
! echo "configure:9634: checking for ut_addr in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_ADDR'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9640 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9648,9660 ----
  fi 
  
  echo $ac_n "checking for ut_addr in utmp""... $ac_c" 1>&6
! echo "configure:9652: checking for ut_addr in utmp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UT_UT_ADDR'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9658 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9644,9650 ****
  struct utmp ut;  ut.ut_addr = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9648: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_ADDR=yes
  else
--- 9662,9668 ----
  struct utmp ut;  ut.ut_addr = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9666: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UT_UT_ADDR=yes
  else
***************
*** 9666,9678 ****
  
  if test x$ac_cv_func_pututline = xyes ; then
    echo $ac_n "checking whether pututline returns pointer""... $ac_c" 1>&6
! echo "configure:9670: checking whether pututline returns pointer" >&5
  if eval "test \"`echo '$''{'samba_cv_PUTUTLINE_RETURNS_UTMP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
    cat > conftest.$ac_ext <<EOF
! #line 9676 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
--- 9684,9696 ----
  
  if test x$ac_cv_func_pututline = xyes ; then
    echo $ac_n "checking whether pututline returns pointer""... $ac_c" 1>&6
! echo "configure:9688: checking whether pututline returns pointer" >&5
  if eval "test \"`echo '$''{'samba_cv_PUTUTLINE_RETURNS_UTMP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
    cat > conftest.$ac_ext <<EOF
! #line 9694 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmp.h>
***************
*** 9680,9686 ****
  struct utmp utarg; struct utmp *utreturn; utreturn = pututline(&utarg);
  ; return 0; }
  EOF
! if { (eval echo configure:9684: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_PUTUTLINE_RETURNS_UTMP=yes
  else
--- 9698,9704 ----
  struct utmp utarg; struct utmp *utreturn; utreturn = pututline(&utarg);
  ; return 0; }
  EOF
! if { (eval echo configure:9702: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_PUTUTLINE_RETURNS_UTMP=yes
  else
***************
*** 9702,9714 ****
  fi
  
  echo $ac_n "checking for ut_syslen in utmpx""... $ac_c" 1>&6
! echo "configure:9706: checking for ut_syslen in utmpx" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UX_UT_SYSLEN'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9712 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmpx.h>
--- 9720,9732 ----
  fi
  
  echo $ac_n "checking for ut_syslen in utmpx""... $ac_c" 1>&6
! echo "configure:9724: checking for ut_syslen in utmpx" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UX_UT_SYSLEN'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9730 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <utmpx.h>
***************
*** 9716,9722 ****
  struct utmpx ux;  ux.ut_syslen = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9720: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UX_UT_SYSLEN=yes
  else
--- 9734,9740 ----
  struct utmpx ux;  ux.ut_syslen = 0;
  ; return 0; }
  EOF
! if { (eval echo configure:9738: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UX_UT_SYSLEN=yes
  else
***************
*** 9737,9743 ****
  fi 
  
  echo $ac_n "checking for Linux kernel oplocks""... $ac_c" 1>&6
! echo "configure:9741: checking for Linux kernel oplocks" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_OPLOCKS_LINUX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 9755,9761 ----
  fi 
  
  echo $ac_n "checking for Linux kernel oplocks""... $ac_c" 1>&6
! echo "configure:9759: checking for Linux kernel oplocks" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_OPLOCKS_LINUX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 9746,9752 ****
    samba_cv_HAVE_KERNEL_OPLOCKS_LINUX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9750 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
--- 9764,9770 ----
    samba_cv_HAVE_KERNEL_OPLOCKS_LINUX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9768 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
***************
*** 9760,9766 ****
  }
  
  EOF
! if { (eval echo configure:9764: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_KERNEL_OPLOCKS_LINUX=yes
  else
--- 9778,9784 ----
  }
  
  EOF
! if { (eval echo configure:9782: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_KERNEL_OPLOCKS_LINUX=yes
  else
***************
*** 9783,9789 ****
  fi
  
  echo $ac_n "checking for kernel change notify support""... $ac_c" 1>&6
! echo "configure:9787: checking for kernel change notify support" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_CHANGE_NOTIFY'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 9801,9807 ----
  fi
  
  echo $ac_n "checking for kernel change notify support""... $ac_c" 1>&6
! echo "configure:9805: checking for kernel change notify support" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_CHANGE_NOTIFY'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 9792,9798 ****
    samba_cv_HAVE_KERNEL_CHANGE_NOTIFY=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9796 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
--- 9810,9816 ----
    samba_cv_HAVE_KERNEL_CHANGE_NOTIFY=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9814 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
***************
*** 9806,9812 ****
  }
  
  EOF
! if { (eval echo configure:9810: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_KERNEL_CHANGE_NOTIFY=yes
  else
--- 9824,9830 ----
  }
  
  EOF
! if { (eval echo configure:9828: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_KERNEL_CHANGE_NOTIFY=yes
  else
***************
*** 9829,9835 ****
  fi
  
  echo $ac_n "checking for kernel share modes""... $ac_c" 1>&6
! echo "configure:9833: checking for kernel share modes" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_SHARE_MODES'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 9847,9853 ----
  fi
  
  echo $ac_n "checking for kernel share modes""... $ac_c" 1>&6
! echo "configure:9851: checking for kernel share modes" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_SHARE_MODES'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 9838,9844 ****
    samba_cv_HAVE_KERNEL_SHARE_MODES=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9842 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
--- 9856,9862 ----
    samba_cv_HAVE_KERNEL_SHARE_MODES=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9860 "configure"
  #include "confdefs.h"
  
  #include <sys/types.h>
***************
*** 9854,9860 ****
  }
  
  EOF
! if { (eval echo configure:9858: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_KERNEL_SHARE_MODES=yes
  else
--- 9872,9878 ----
  }
  
  EOF
! if { (eval echo configure:9876: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_KERNEL_SHARE_MODES=yes
  else
***************
*** 9880,9892 ****
  
  
  echo $ac_n "checking for IRIX kernel oplock type definitions""... $ac_c" 1>&6
! echo "configure:9884: checking for IRIX kernel oplock type definitions" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_OPLOCKS_IRIX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9890 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <fcntl.h>
--- 9898,9910 ----
  
  
  echo $ac_n "checking for IRIX kernel oplock type definitions""... $ac_c" 1>&6
! echo "configure:9902: checking for IRIX kernel oplock type definitions" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_KERNEL_OPLOCKS_IRIX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9908 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <fcntl.h>
***************
*** 9894,9900 ****
  oplock_stat_t t; t.os_state = OP_REVOKE; t.os_dev = 1; t.os_ino = 1;
  ; return 0; }
  EOF
! if { (eval echo configure:9898: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_KERNEL_OPLOCKS_IRIX=yes
  else
--- 9912,9918 ----
  oplock_stat_t t; t.os_state = OP_REVOKE; t.os_dev = 1; t.os_ino = 1;
  ; return 0; }
  EOF
! if { (eval echo configure:9916: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_KERNEL_OPLOCKS_IRIX=yes
  else
***************
*** 9915,9921 ****
  fi
  
  echo $ac_n "checking for irix specific capabilities""... $ac_c" 1>&6
! echo "configure:9919: checking for irix specific capabilities" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IRIX_SPECIFIC_CAPABILITIES'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 9933,9939 ----
  fi
  
  echo $ac_n "checking for irix specific capabilities""... $ac_c" 1>&6
! echo "configure:9937: checking for irix specific capabilities" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IRIX_SPECIFIC_CAPABILITIES'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 9924,9930 ****
    samba_cv_HAVE_IRIX_SPECIFIC_CAPABILITIES=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9928 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/capability.h>
--- 9942,9948 ----
    samba_cv_HAVE_IRIX_SPECIFIC_CAPABILITIES=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 9946 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/capability.h>
***************
*** 9939,9945 ****
  }
  
  EOF
! if { (eval echo configure:9943: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IRIX_SPECIFIC_CAPABILITIES=yes
  else
--- 9957,9963 ----
  }
  
  EOF
! if { (eval echo configure:9961: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IRIX_SPECIFIC_CAPABILITIES=yes
  else
***************
*** 9967,9979 ****
  #
  
  echo $ac_n "checking for int16 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:9971: checking for int16 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_INT16_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9977 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
--- 9985,9997 ----
  #
  
  echo $ac_n "checking for int16 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:9989: checking for int16 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_INT16_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 9995 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
***************
*** 9983,9989 ****
  int16 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:9987: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_INT16_FROM_RPC_RPC_H=yes
  else
--- 10001,10007 ----
  int16 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10005: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_INT16_FROM_RPC_RPC_H=yes
  else
***************
*** 10004,10016 ****
  fi
  
  echo $ac_n "checking for uint16 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10008: checking for uint16 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UINT16_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10014 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
--- 10022,10034 ----
  fi
  
  echo $ac_n "checking for uint16 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10026: checking for uint16 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UINT16_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10032 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
***************
*** 10020,10026 ****
  uint16 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10024: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UINT16_FROM_RPC_RPC_H=yes
  else
--- 10038,10044 ----
  uint16 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10042: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UINT16_FROM_RPC_RPC_H=yes
  else
***************
*** 10041,10053 ****
  fi
  
  echo $ac_n "checking for int32 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10045: checking for int32 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_INT32_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10051 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
--- 10059,10071 ----
  fi
  
  echo $ac_n "checking for int32 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10063: checking for int32 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_INT32_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10069 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
***************
*** 10057,10063 ****
  int32 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10061: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_INT32_FROM_RPC_RPC_H=yes
  else
--- 10075,10081 ----
  int32 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10079: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_INT32_FROM_RPC_RPC_H=yes
  else
***************
*** 10078,10090 ****
  fi
  
  echo $ac_n "checking for uint32 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10082: checking for uint32 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UINT32_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10088 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
--- 10096,10108 ----
  fi
  
  echo $ac_n "checking for uint32 typedef included by rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10100: checking for uint32 typedef included by rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_UINT32_FROM_RPC_RPC_H'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10106 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #if defined(HAVE_RPC_RPC_H)
***************
*** 10094,10100 ****
  uint32 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10098: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UINT32_FROM_RPC_RPC_H=yes
  else
--- 10112,10118 ----
  uint32 testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10116: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_UINT32_FROM_RPC_RPC_H=yes
  else
***************
*** 10116,10128 ****
  
  
  echo $ac_n "checking for conflicting AUTH_ERROR define in rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10120: checking for conflicting AUTH_ERROR define in rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_RPC_AUTH_ERROR_CONFLICT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10126 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_SECURITY_H
--- 10134,10146 ----
  
  
  echo $ac_n "checking for conflicting AUTH_ERROR define in rpc/rpc.h""... $ac_c" 1>&6
! echo "configure:10138: checking for conflicting AUTH_ERROR define in rpc/rpc.h" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_RPC_AUTH_ERROR_CONFLICT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 10144 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_SECURITY_H
***************
*** 10136,10142 ****
  int testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10140: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_RPC_AUTH_ERROR_CONFLICT=no
  else
--- 10154,10160 ----
  int testvar;
  ; return 0; }
  EOF
! if { (eval echo configure:10158: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_RPC_AUTH_ERROR_CONFLICT=no
  else
***************
*** 10157,10172 ****
  fi
  
  echo $ac_n "checking for test routines""... $ac_c" 1>&6
! echo "configure:10161: checking for test routines" >&5
  if test "$cross_compiling" = yes; then
    echo "configure: warning: cannot run when cross-compiling" 1>&2
  else
    cat > conftest.$ac_ext <<EOF
! #line 10166 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/trivial.c"
  EOF
! if { (eval echo configure:10170: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    echo "$ac_t""yes" 1>&6
  else
--- 10175,10190 ----
  fi
  
  echo $ac_n "checking for test routines""... $ac_c" 1>&6
! echo "configure:10179: checking for test routines" >&5
  if test "$cross_compiling" = yes; then
    echo "configure: warning: cannot run when cross-compiling" 1>&2
  else
    cat > conftest.$ac_ext <<EOF
! #line 10184 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/trivial.c"
  EOF
! if { (eval echo configure:10188: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    echo "$ac_t""yes" 1>&6
  else
***************
*** 10180,10186 ****
  
  
  echo $ac_n "checking for ftruncate extend""... $ac_c" 1>&6
! echo "configure:10184: checking for ftruncate extend" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FTRUNCATE_EXTEND'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10198,10204 ----
  
  
  echo $ac_n "checking for ftruncate extend""... $ac_c" 1>&6
! echo "configure:10202: checking for ftruncate extend" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FTRUNCATE_EXTEND'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10189,10199 ****
    samba_cv_HAVE_FTRUNCATE_EXTEND=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10193 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/ftruncate.c"
  EOF
! if { (eval echo configure:10197: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_FTRUNCATE_EXTEND=yes
  else
--- 10207,10217 ----
    samba_cv_HAVE_FTRUNCATE_EXTEND=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10211 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/ftruncate.c"
  EOF
! if { (eval echo configure:10215: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_FTRUNCATE_EXTEND=yes
  else
***************
*** 10216,10222 ****
  fi
  
  echo $ac_n "checking for broken getgroups""... $ac_c" 1>&6
! echo "configure:10220: checking for broken getgroups" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_BROKEN_GETGROUPS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10234,10240 ----
  fi
  
  echo $ac_n "checking for broken getgroups""... $ac_c" 1>&6
! echo "configure:10238: checking for broken getgroups" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_BROKEN_GETGROUPS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10225,10235 ****
    samba_cv_HAVE_BROKEN_GETGROUPS=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10229 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/getgroups.c"
  EOF
! if { (eval echo configure:10233: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_BROKEN_GETGROUPS=yes
  else
--- 10243,10253 ----
    samba_cv_HAVE_BROKEN_GETGROUPS=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10247 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/getgroups.c"
  EOF
! if { (eval echo configure:10251: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_BROKEN_GETGROUPS=yes
  else
***************
*** 10252,10258 ****
  fi
  
  echo $ac_n "checking whether getpass should be replaced""... $ac_c" 1>&6
! echo "configure:10256: checking whether getpass should be replaced" >&5
  if eval "test \"`echo '$''{'samba_cv_REPLACE_GETPASS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10270,10276 ----
  fi
  
  echo $ac_n "checking whether getpass should be replaced""... $ac_c" 1>&6
! echo "configure:10274: checking whether getpass should be replaced" >&5
  if eval "test \"`echo '$''{'samba_cv_REPLACE_GETPASS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10260,10266 ****
  SAVE_CPPFLAGS="$CPPFLAGS"
  CPPFLAGS="$CPPFLAGS -I${srcdir-.}/include -I${srcdir-.}/ubiqx -I${srcdir-.}/smbwrapper"
  cat > conftest.$ac_ext <<EOF
! #line 10264 "configure"
  #include "confdefs.h"
  
  #define REPLACE_GETPASS 1
--- 10278,10284 ----
  SAVE_CPPFLAGS="$CPPFLAGS"
  CPPFLAGS="$CPPFLAGS -I${srcdir-.}/include -I${srcdir-.}/ubiqx -I${srcdir-.}/smbwrapper"
  cat > conftest.$ac_ext <<EOF
! #line 10282 "configure"
  #include "confdefs.h"
  
  #define REPLACE_GETPASS 1
***************
*** 10273,10279 ****
  
  ; return 0; }
  EOF
! if { (eval echo configure:10277: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_REPLACE_GETPASS=yes
  else
--- 10291,10297 ----
  
  ; return 0; }
  EOF
! if { (eval echo configure:10295: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_REPLACE_GETPASS=yes
  else
***************
*** 10296,10302 ****
  fi
  
  echo $ac_n "checking for broken inet_ntoa""... $ac_c" 1>&6
! echo "configure:10300: checking for broken inet_ntoa" >&5
  if eval "test \"`echo '$''{'samba_cv_REPLACE_INET_NTOA'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10314,10320 ----
  fi
  
  echo $ac_n "checking for broken inet_ntoa""... $ac_c" 1>&6
! echo "configure:10318: checking for broken inet_ntoa" >&5
  if eval "test \"`echo '$''{'samba_cv_REPLACE_INET_NTOA'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10305,10311 ****
    samba_cv_REPLACE_INET_NTOA=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10309 "configure"
  #include "confdefs.h"
  
  #include <stdio.h>
--- 10323,10329 ----
    samba_cv_REPLACE_INET_NTOA=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10327 "configure"
  #include "confdefs.h"
  
  #include <stdio.h>
***************
*** 10319,10325 ****
      strcmp(inet_ntoa(ip),"120.86.52.18")) { exit(0); } 
  exit(1);}
  EOF
! if { (eval echo configure:10323: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_REPLACE_INET_NTOA=yes
  else
--- 10337,10343 ----
      strcmp(inet_ntoa(ip),"120.86.52.18")) { exit(0); } 
  exit(1);}
  EOF
! if { (eval echo configure:10341: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_REPLACE_INET_NTOA=yes
  else
***************
*** 10342,10348 ****
  fi
  
  echo $ac_n "checking for secure mkstemp""... $ac_c" 1>&6
! echo "configure:10346: checking for secure mkstemp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_SECURE_MKSTEMP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10360,10366 ----
  fi
  
  echo $ac_n "checking for secure mkstemp""... $ac_c" 1>&6
! echo "configure:10364: checking for secure mkstemp" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_SECURE_MKSTEMP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10351,10357 ****
    samba_cv_HAVE_SECURE_MKSTEMP=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10355 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <sys/types.h>
--- 10369,10375 ----
    samba_cv_HAVE_SECURE_MKSTEMP=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10373 "configure"
  #include "confdefs.h"
  #include <stdlib.h>
  #include <sys/types.h>
***************
*** 10368,10374 ****
    exit(0);
  }
  EOF
! if { (eval echo configure:10372: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_SECURE_MKSTEMP=yes
  else
--- 10386,10392 ----
    exit(0);
  }
  EOF
! if { (eval echo configure:10390: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_SECURE_MKSTEMP=yes
  else
***************
*** 10391,10397 ****
  fi
  
  echo $ac_n "checking for sysconf(_SC_NGROUPS_MAX)""... $ac_c" 1>&6
! echo "configure:10395: checking for sysconf(_SC_NGROUPS_MAX)" >&5
  if eval "test \"`echo '$''{'samba_cv_SYSCONF_SC_NGROUPS_MAX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10409,10415 ----
  fi
  
  echo $ac_n "checking for sysconf(_SC_NGROUPS_MAX)""... $ac_c" 1>&6
! echo "configure:10413: checking for sysconf(_SC_NGROUPS_MAX)" >&5
  if eval "test \"`echo '$''{'samba_cv_SYSCONF_SC_NGROUPS_MAX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10400,10411 ****
    samba_cv_SYSCONF_SC_NGROUPS_MAX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10404 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  main() { exit(sysconf(_SC_NGROUPS_MAX) == -1 ? 1 : 0); }
  EOF
! if { (eval echo configure:10409: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_SYSCONF_SC_NGROUPS_MAX=yes
  else
--- 10418,10429 ----
    samba_cv_SYSCONF_SC_NGROUPS_MAX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10422 "configure"
  #include "confdefs.h"
  #include <unistd.h>
  main() { exit(sysconf(_SC_NGROUPS_MAX) == -1 ? 1 : 0); }
  EOF
! if { (eval echo configure:10427: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_SYSCONF_SC_NGROUPS_MAX=yes
  else
***************
*** 10428,10434 ****
  fi
  
  echo $ac_n "checking for root""... $ac_c" 1>&6
! echo "configure:10432: checking for root" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_ROOT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10446,10452 ----
  fi
  
  echo $ac_n "checking for root""... $ac_c" 1>&6
! echo "configure:10450: checking for root" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_ROOT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10437,10447 ****
    samba_cv_HAVE_ROOT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10441 "configure"
  #include "confdefs.h"
  main() { exit(getuid() != 0); }
  EOF
! if { (eval echo configure:10445: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_ROOT=yes
  else
--- 10455,10465 ----
    samba_cv_HAVE_ROOT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10459 "configure"
  #include "confdefs.h"
  main() { exit(getuid() != 0); }
  EOF
! if { (eval echo configure:10463: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_ROOT=yes
  else
***************
*** 10469,10475 ****
  # look for a method of finding the list of network interfaces
  iface=no;
  echo $ac_n "checking for iface AIX""... $ac_c" 1>&6
! echo "configure:10473: checking for iface AIX" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IFACE_AIX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10487,10493 ----
  # look for a method of finding the list of network interfaces
  iface=no;
  echo $ac_n "checking for iface AIX""... $ac_c" 1>&6
! echo "configure:10491: checking for iface AIX" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IFACE_AIX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10478,10484 ****
    samba_cv_HAVE_IFACE_AIX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10482 "configure"
  #include "confdefs.h"
  
  #define HAVE_IFACE_AIX 1
--- 10496,10502 ----
    samba_cv_HAVE_IFACE_AIX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10500 "configure"
  #include "confdefs.h"
  
  #define HAVE_IFACE_AIX 1
***************
*** 10486,10492 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/interfaces.c"
  EOF
! if { (eval echo configure:10490: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IFACE_AIX=yes
  else
--- 10504,10510 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/interfaces.c"
  EOF
! if { (eval echo configure:10508: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IFACE_AIX=yes
  else
***************
*** 10510,10516 ****
  
  if test $iface = no; then
  echo $ac_n "checking for iface ifconf""... $ac_c" 1>&6
! echo "configure:10514: checking for iface ifconf" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IFACE_IFCONF'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10528,10534 ----
  
  if test $iface = no; then
  echo $ac_n "checking for iface ifconf""... $ac_c" 1>&6
! echo "configure:10532: checking for iface ifconf" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IFACE_IFCONF'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10519,10525 ****
    samba_cv_HAVE_IFACE_IFCONF=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10523 "configure"
  #include "confdefs.h"
  
  #define HAVE_IFACE_IFCONF 1
--- 10537,10543 ----
    samba_cv_HAVE_IFACE_IFCONF=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10541 "configure"
  #include "confdefs.h"
  
  #define HAVE_IFACE_IFCONF 1
***************
*** 10527,10533 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/interfaces.c"
  EOF
! if { (eval echo configure:10531: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IFACE_IFCONF=yes
  else
--- 10545,10551 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/interfaces.c"
  EOF
! if { (eval echo configure:10549: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IFACE_IFCONF=yes
  else
***************
*** 10552,10558 ****
  
  if test $iface = no; then
  echo $ac_n "checking for iface ifreq""... $ac_c" 1>&6
! echo "configure:10556: checking for iface ifreq" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IFACE_IFREQ'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10570,10576 ----
  
  if test $iface = no; then
  echo $ac_n "checking for iface ifreq""... $ac_c" 1>&6
! echo "configure:10574: checking for iface ifreq" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_IFACE_IFREQ'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10561,10567 ****
    samba_cv_HAVE_IFACE_IFREQ=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10565 "configure"
  #include "confdefs.h"
  
  #define HAVE_IFACE_IFREQ 1
--- 10579,10585 ----
    samba_cv_HAVE_IFACE_IFREQ=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10583 "configure"
  #include "confdefs.h"
  
  #define HAVE_IFACE_IFREQ 1
***************
*** 10569,10575 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/interfaces.c"
  EOF
! if { (eval echo configure:10573: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IFACE_IFREQ=yes
  else
--- 10587,10593 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/interfaces.c"
  EOF
! if { (eval echo configure:10591: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_IFACE_IFREQ=yes
  else
***************
*** 10598,10604 ****
  seteuid=no;
  if test $seteuid = no; then
  echo $ac_n "checking for setresuid""... $ac_c" 1>&6
! echo "configure:10602: checking for setresuid" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETRESUID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10616,10622 ----
  seteuid=no;
  if test $seteuid = no; then
  echo $ac_n "checking for setresuid""... $ac_c" 1>&6
! echo "configure:10620: checking for setresuid" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETRESUID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10607,10613 ****
    samba_cv_USE_SETRESUID=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10611 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
--- 10625,10631 ----
    samba_cv_USE_SETRESUID=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10629 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
***************
*** 10615,10621 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10619: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETRESUID=yes
  else
--- 10633,10639 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10637: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETRESUID=yes
  else
***************
*** 10641,10647 ****
  
  if test $seteuid = no; then
  echo $ac_n "checking for setreuid""... $ac_c" 1>&6
! echo "configure:10645: checking for setreuid" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETREUID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10659,10665 ----
  
  if test $seteuid = no; then
  echo $ac_n "checking for setreuid""... $ac_c" 1>&6
! echo "configure:10663: checking for setreuid" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETREUID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10650,10656 ****
    samba_cv_USE_SETREUID=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10654 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
--- 10668,10674 ----
    samba_cv_USE_SETREUID=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10672 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
***************
*** 10658,10664 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10662: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETREUID=yes
  else
--- 10676,10682 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10680: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETREUID=yes
  else
***************
*** 10683,10689 ****
  
  if test $seteuid = no; then
  echo $ac_n "checking for seteuid""... $ac_c" 1>&6
! echo "configure:10687: checking for seteuid" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETEUID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10701,10707 ----
  
  if test $seteuid = no; then
  echo $ac_n "checking for seteuid""... $ac_c" 1>&6
! echo "configure:10705: checking for seteuid" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETEUID'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10692,10698 ****
    samba_cv_USE_SETEUID=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10696 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
--- 10710,10716 ----
    samba_cv_USE_SETEUID=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10714 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
***************
*** 10700,10706 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10704: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETEUID=yes
  else
--- 10718,10724 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10722: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETEUID=yes
  else
***************
*** 10725,10731 ****
  
  if test $seteuid = no; then
  echo $ac_n "checking for setuidx""... $ac_c" 1>&6
! echo "configure:10729: checking for setuidx" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETUIDX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10743,10749 ----
  
  if test $seteuid = no; then
  echo $ac_n "checking for setuidx""... $ac_c" 1>&6
! echo "configure:10747: checking for setuidx" >&5
  if eval "test \"`echo '$''{'samba_cv_USE_SETUIDX'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10734,10740 ****
    samba_cv_USE_SETUIDX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10738 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
--- 10752,10758 ----
    samba_cv_USE_SETUIDX=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10756 "configure"
  #include "confdefs.h"
  
  #define AUTOCONF_TEST 1
***************
*** 10742,10748 ****
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10746: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETUIDX=yes
  else
--- 10760,10766 ----
  #include "confdefs.h"
  #include "${srcdir-.}/lib/util_sec.c"
  EOF
! if { (eval echo configure:10764: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_USE_SETUIDX=yes
  else
***************
*** 10767,10773 ****
  
  
  echo $ac_n "checking for working mmap""... $ac_c" 1>&6
! echo "configure:10771: checking for working mmap" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_MMAP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10785,10791 ----
  
  
  echo $ac_n "checking for working mmap""... $ac_c" 1>&6
! echo "configure:10789: checking for working mmap" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_MMAP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10776,10786 ****
    samba_cv_HAVE_MMAP=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10780 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/shared_mmap.c"
  EOF
! if { (eval echo configure:10784: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_MMAP=yes
  else
--- 10794,10804 ----
    samba_cv_HAVE_MMAP=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10798 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/shared_mmap.c"
  EOF
! if { (eval echo configure:10802: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_MMAP=yes
  else
***************
*** 10803,10809 ****
  fi
  
  echo $ac_n "checking for ftruncate needs root""... $ac_c" 1>&6
! echo "configure:10807: checking for ftruncate needs root" >&5
  if eval "test \"`echo '$''{'samba_cv_FTRUNCATE_NEEDS_ROOT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10821,10827 ----
  fi
  
  echo $ac_n "checking for ftruncate needs root""... $ac_c" 1>&6
! echo "configure:10825: checking for ftruncate needs root" >&5
  if eval "test \"`echo '$''{'samba_cv_FTRUNCATE_NEEDS_ROOT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10812,10822 ****
    samba_cv_FTRUNCATE_NEEDS_ROOT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10816 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/ftruncroot.c"
  EOF
! if { (eval echo configure:10820: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_FTRUNCATE_NEEDS_ROOT=yes
  else
--- 10830,10840 ----
    samba_cv_FTRUNCATE_NEEDS_ROOT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10834 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/ftruncroot.c"
  EOF
! if { (eval echo configure:10838: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_FTRUNCATE_NEEDS_ROOT=yes
  else
***************
*** 10839,10845 ****
  fi
  
  echo $ac_n "checking for fcntl locking""... $ac_c" 1>&6
! echo "configure:10843: checking for fcntl locking" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FCNTL_LOCK'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10857,10863 ----
  fi
  
  echo $ac_n "checking for fcntl locking""... $ac_c" 1>&6
! echo "configure:10861: checking for fcntl locking" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_FCNTL_LOCK'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10848,10858 ****
    samba_cv_HAVE_FCNTL_LOCK=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10852 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/fcntl_lock.c"
  EOF
! if { (eval echo configure:10856: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_FCNTL_LOCK=yes
  else
--- 10866,10876 ----
    samba_cv_HAVE_FCNTL_LOCK=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10870 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/fcntl_lock.c"
  EOF
! if { (eval echo configure:10874: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_FCNTL_LOCK=yes
  else
***************
*** 10875,10881 ****
  fi
  
  echo $ac_n "checking for broken (glibc2.1/x86) 64 bit fcntl locking""... $ac_c" 1>&6
! echo "configure:10879: checking for broken (glibc2.1/x86) 64 bit fcntl locking" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_BROKEN_FCNTL64_LOCKS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10893,10899 ----
  fi
  
  echo $ac_n "checking for broken (glibc2.1/x86) 64 bit fcntl locking""... $ac_c" 1>&6
! echo "configure:10897: checking for broken (glibc2.1/x86) 64 bit fcntl locking" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_BROKEN_FCNTL64_LOCKS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10884,10894 ****
    samba_cv_HAVE_BROKEN_FCNTL64_LOCKS=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10888 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/fcntl_lock64.c"
  EOF
! if { (eval echo configure:10892: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_BROKEN_FCNTL64_LOCKS=yes
  else
--- 10902,10912 ----
    samba_cv_HAVE_BROKEN_FCNTL64_LOCKS=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10906 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/fcntl_lock64.c"
  EOF
! if { (eval echo configure:10910: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_BROKEN_FCNTL64_LOCKS=yes
  else
***************
*** 10913,10919 ****
  
  
    echo $ac_n "checking for 64 bit fcntl locking""... $ac_c" 1>&6
! echo "configure:10917: checking for 64 bit fcntl locking" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_STRUCT_FLOCK64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10931,10937 ----
  
  
    echo $ac_n "checking for 64 bit fcntl locking""... $ac_c" 1>&6
! echo "configure:10935: checking for 64 bit fcntl locking" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_STRUCT_FLOCK64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10922,10928 ****
    samba_cv_HAVE_STRUCT_FLOCK64=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10926 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 10940,10946 ----
    samba_cv_HAVE_STRUCT_FLOCK64=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10944 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 10946,10952 ****
  #endif
  }
  EOF
! if { (eval echo configure:10950: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_STRUCT_FLOCK64=yes
  else
--- 10964,10970 ----
  #endif
  }
  EOF
! if { (eval echo configure:10968: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_STRUCT_FLOCK64=yes
  else
***************
*** 10971,10977 ****
  fi
  
  echo $ac_n "checking for a crypt that needs truncated salt""... $ac_c" 1>&6
! echo "configure:10975: checking for a crypt that needs truncated salt" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_TRUNCATED_SALT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 10989,10995 ----
  fi
  
  echo $ac_n "checking for a crypt that needs truncated salt""... $ac_c" 1>&6
! echo "configure:10993: checking for a crypt that needs truncated salt" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_TRUNCATED_SALT'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 10980,10990 ****
    samba_cv_HAVE_TRUNCATED_SALT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 10984 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/crypttest.c"
  EOF
! if { (eval echo configure:10988: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_TRUNCATED_SALT=no
  else
--- 10998,11008 ----
    samba_cv_HAVE_TRUNCATED_SALT=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 11002 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/crypttest.c"
  EOF
! if { (eval echo configure:11006: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    samba_cv_HAVE_TRUNCATED_SALT=no
  else
***************
*** 11007,11019 ****
  fi
  
  echo $ac_n "checking for broken nisplus include files""... $ac_c" 1>&6
! echo "configure:11011: checking for broken nisplus include files" >&5
  if eval "test \"`echo '$''{'samba_cv_BROKEN_NISPLUS_INCLUDE_FILES'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 11017 "configure"
  #include "confdefs.h"
  #include <sys/acl.h>
  #if defined(HAVE_RPCSVC_NIS_H)
--- 11025,11037 ----
  fi
  
  echo $ac_n "checking for broken nisplus include files""... $ac_c" 1>&6
! echo "configure:11029: checking for broken nisplus include files" >&5
  if eval "test \"`echo '$''{'samba_cv_BROKEN_NISPLUS_INCLUDE_FILES'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  cat > conftest.$ac_ext <<EOF
! #line 11035 "configure"
  #include "confdefs.h"
  #include <sys/acl.h>
  #if defined(HAVE_RPCSVC_NIS_H)
***************
*** 11023,11029 ****
  return 0;
  ; return 0; }
  EOF
! if { (eval echo configure:11027: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_BROKEN_NISPLUS_INCLUDE_FILES=no
  else
--- 11041,11047 ----
  return 0;
  ; return 0; }
  EOF
! if { (eval echo configure:11045: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_BROKEN_NISPLUS_INCLUDE_FILES=no
  else
***************
*** 11047,11053 ****
  #################################################
  # check for smbwrapper support
  echo $ac_n "checking whether to use smbwrapper""... $ac_c" 1>&6
! echo "configure:11051: checking whether to use smbwrapper" >&5
  # Check whether --with-smbwrapper or --without-smbwrapper was given.
  if test "${with_smbwrapper+set}" = set; then
    withval="$with_smbwrapper"
--- 11065,11071 ----
  #################################################
  # check for smbwrapper support
  echo $ac_n "checking whether to use smbwrapper""... $ac_c" 1>&6
! echo "configure:11069: checking whether to use smbwrapper" >&5
  # Check whether --with-smbwrapper or --without-smbwrapper was given.
  if test "${with_smbwrapper+set}" = set; then
    withval="$with_smbwrapper"
***************
*** 11091,11097 ****
  #################################################
  # check for the AFS filesystem
  echo $ac_n "checking whether to use AFS""... $ac_c" 1>&6
! echo "configure:11095: checking whether to use AFS" >&5
  # Check whether --with-afs or --without-afs was given.
  if test "${with_afs+set}" = set; then
    withval="$with_afs"
--- 11109,11115 ----
  #################################################
  # check for the AFS filesystem
  echo $ac_n "checking whether to use AFS""... $ac_c" 1>&6
! echo "configure:11113: checking whether to use AFS" >&5
  # Check whether --with-afs or --without-afs was given.
  if test "${with_afs+set}" = set; then
    withval="$with_afs"
***************
*** 11115,11123 ****
  
  
  #################################################
! # check for the DFS auth system
! echo $ac_n "checking whether to use DFS auth""... $ac_c" 1>&6
! echo "configure:11121: checking whether to use DFS auth" >&5
  # Check whether --with-dfs or --without-dfs was given.
  if test "${with_dfs+set}" = set; then
    withval="$with_dfs"
--- 11133,11274 ----
  
  
  #################################################
! # check for DCE plaintext authentication support
! echo $ac_n "checking whether to use DCE plaintext authentication""... $ac_c" 1>&6
! echo "configure:11139: checking whether to use DCE plaintext authentication" >&5
! # Check whether --with-dce or --without-dce was given.
! if test "${with_dce+set}" = set; then
!   withval="$with_dce"
!    case "$withval" in
!   yes)
!     echo "$ac_t""yes" 1>&6
!     cat >> confdefs.h <<\EOF
! #define WITH_DCE 1
! EOF
! 
!     LIBS="$LIBS -ldce -lpthread"
!     CFLAGS="$CFLAGS -D_REENTRANT"
!     ;;
!   *)
!     echo "$ac_t""no" 1>&6
!     ;;
!   esac 
! else
!   echo "$ac_t""no" 1>&6
! 
! fi
! 
! 
! 
! #################################################
! # check for DCE encrypted authentication support
! echo $ac_n "checking whether to use DCE encrypted authentication""... $ac_c" 1>&6
! echo "configure:11167: checking whether to use DCE encrypted authentication" >&5
! # Check whether --with-dce-encrypted or --without-dce-encrypted was given.
! if test "${with_dce_encrypted+set}" = set; then
!   withval="$with_dce_encrypted"
!    case "$withval" in
!   yes)
!     echo "$ac_t""yes" 1>&6
!     cat >> confdefs.h <<\EOF
! #define WITH_DCE_ENCRYPTED 1
! EOF
! 
!     LIBS="$LIBS -lsec_auth"
!     ;;
!   *)
!     echo "$ac_t""no" 1>&6
!     ;;
!   esac 
! else
!   echo "$ac_t""no" 1>&6
! 
! fi
! 
! 
! 
! #################################################
! # check for DCE context refresh support
! echo $ac_n "checking whether to use DCE context refresh""... $ac_c" 1>&6
! echo "configure:11194: checking whether to use DCE context refresh" >&5
! # Check whether --with-dce-refresh or --without-dce-refresh was given.
! if test "${with_dce_refresh+set}" = set; then
!   withval="$with_dce_refresh"
!    case "$withval" in
!   yes)
!     echo "$ac_t""yes" 1>&6
!     cat >> confdefs.h <<\EOF
! #define WITH_DCE_REFRESH 1
! EOF
! 
!     ;;
!   *)
!     echo "$ac_t""no" 1>&6
!     ;;
!   esac 
! else
!   echo "$ac_t""no" 1>&6
! 
! fi
! 
! 
! 
! #################################################
! # check for DCE Windows terminal server (multiuser) support
! echo $ac_n "checking whether to use DCE Windows terminal server""... $ac_c" 1>&6
! echo "configure:11220: checking whether to use DCE Windows terminal server" >&5
! # Check whether --with-dce-wts or --without-dce-wts was given.
! if test "${with_dce_wts+set}" = set; then
!   withval="$with_dce_wts"
!    case "$withval" in
!   yes)
!     echo "$ac_t""yes" 1>&6
!     cat >> confdefs.h <<\EOF
! #define WITH_DCE_WTS 1
! EOF
! 
!     ;;
!   *)
!     echo "$ac_t""no" 1>&6
!     ;;
!   esac 
! else
!   echo "$ac_t""no" 1>&6
! 
! fi
! 
! 
! 
! #################################################
! # check for DCE IBM kludge support
! echo $ac_n "checking whether to work around broken IBM DCE security API""... $ac_c" 1>&6
! echo "configure:11246: checking whether to work around broken IBM DCE security API" >&5
! # Check whether --with-dce-ibm-kludge or --without-dce-ibm-kludge was given.
! if test "${with_dce_ibm_kludge+set}" = set; then
!   withval="$with_dce_ibm_kludge"
!    case "$withval" in
!   yes)
!     echo "$ac_t""yes" 1>&6
!     cat >> confdefs.h <<\EOF
! #define WITH_DCE_IBM_KLUDGE 1
! EOF
! 
!     ;;
!   *)
!     echo "$ac_t""no" 1>&6
!     ;;
!   esac 
! else
!   echo "$ac_t""no" 1>&6
! 
! fi
! 
! 
! 
! #################################################
! # check for DFS support
! echo $ac_n "checking whether to use DFS""... $ac_c" 1>&6
! echo "configure:11272: checking whether to use DFS" >&5
  # Check whether --with-dfs or --without-dfs was given.
  if test "${with_dfs+set}" = set; then
    withval="$with_dfs"
***************
*** 11128,11133 ****
--- 11279,11285 ----
  #define WITH_DFS 1
  EOF
  
+     LIBS="$LIBS -ldcedfs"
      ;;
    *)
      echo "$ac_t""no" 1>&6
***************
*** 11139,11148 ****
  fi
  
  
  #################################################
  # check for Kerberos IV auth system
  echo $ac_n "checking whether to use Kerberos IV""... $ac_c" 1>&6
! echo "configure:11146: checking whether to use Kerberos IV" >&5
  # Check whether --with-krb4 or --without-krb4 was given.
  if test "${with_krb4+set}" = set; then
    withval="$with_krb4"
--- 11291,11327 ----
  fi
  
  
+ 
+ #################################################
+ # check for Cal Poly Pomona allow underscores in share names
+ echo $ac_n "checking whether to allow underscores in share names""... $ac_c" 1>&6
+ echo "configure:11299: checking whether to allow underscores in share names" >&5
+ # Check whether --with-calpoly-underscore or --without-calpoly-underscore was given.
+ if test "${with_calpoly_underscore+set}" = set; then
+   withval="$with_calpoly_underscore"
+    case "$withval" in
+   yes)
+     echo "$ac_t""yes" 1>&6
+     cat >> confdefs.h <<\EOF
+ #define WITH_CALPOLY_UNDERSCORE 1
+ EOF
+ 
+     ;;
+   *)
+     echo "$ac_t""no" 1>&6
+     ;;
+   esac 
+ else
+   echo "$ac_t""no" 1>&6
+ 
+ fi
+ 
+ 
+ 
  #################################################
  # check for Kerberos IV auth system
  echo $ac_n "checking whether to use Kerberos IV""... $ac_c" 1>&6
! echo "configure:11325: checking whether to use Kerberos IV" >&5
  # Check whether --with-krb4 or --without-krb4 was given.
  if test "${with_krb4+set}" = set; then
    withval="$with_krb4"
***************
*** 11152,11158 ****
  EOF
  
      echo $ac_n "checking for dn_expand in -lresolv""... $ac_c" 1>&6
! echo "configure:11156: checking for dn_expand in -lresolv" >&5
  ac_lib_var=`echo resolv'_'dn_expand | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 11331,11337 ----
  EOF
  
      echo $ac_n "checking for dn_expand in -lresolv""... $ac_c" 1>&6
! echo "configure:11335: checking for dn_expand in -lresolv" >&5
  ac_lib_var=`echo resolv'_'dn_expand | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 11160,11166 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lresolv  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 11164 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 11339,11345 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lresolv  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 11343 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 11171,11177 ****
  dn_expand()
  ; return 0; }
  EOF
! if { (eval echo configure:11175: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 11350,11356 ----
  dn_expand()
  ; return 0; }
  EOF
! if { (eval echo configure:11354: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 11210,11216 ****
  #################################################
  # check for Kerberos 5 auth system
  echo $ac_n "checking whether to use Kerberos 5""... $ac_c" 1>&6
! echo "configure:11214: checking whether to use Kerberos 5" >&5
  # Check whether --with-krb5 or --without-krb5 was given.
  if test "${with_krb5+set}" = set; then
    withval="$with_krb5"
--- 11389,11395 ----
  #################################################
  # check for Kerberos 5 auth system
  echo $ac_n "checking whether to use Kerberos 5""... $ac_c" 1>&6
! echo "configure:11393: checking whether to use Kerberos 5" >&5
  # Check whether --with-krb5 or --without-krb5 was given.
  if test "${with_krb5+set}" = set; then
    withval="$with_krb5"
***************
*** 11231,11237 ****
  #################################################
  # check for automount support
  echo $ac_n "checking whether to use AUTOMOUNT""... $ac_c" 1>&6
! echo "configure:11235: checking whether to use AUTOMOUNT" >&5
  # Check whether --with-automount or --without-automount was given.
  if test "${with_automount+set}" = set; then
    withval="$with_automount"
--- 11410,11416 ----
  #################################################
  # check for automount support
  echo $ac_n "checking whether to use AUTOMOUNT""... $ac_c" 1>&6
! echo "configure:11414: checking whether to use AUTOMOUNT" >&5
  # Check whether --with-automount or --without-automount was given.
  if test "${with_automount+set}" = set; then
    withval="$with_automount"
***************
*** 11256,11262 ****
  #################################################
  # check for smbmount support
  echo $ac_n "checking whether to use SMBMOUNT""... $ac_c" 1>&6
! echo "configure:11260: checking whether to use SMBMOUNT" >&5
  # Check whether --with-smbmount or --without-smbmount was given.
  if test "${with_smbmount+set}" = set; then
    withval="$with_smbmount"
--- 11435,11441 ----
  #################################################
  # check for smbmount support
  echo $ac_n "checking whether to use SMBMOUNT""... $ac_c" 1>&6
! echo "configure:11439: checking whether to use SMBMOUNT" >&5
  # Check whether --with-smbmount or --without-smbmount was given.
  if test "${with_smbmount+set}" = set; then
    withval="$with_smbmount"
***************
*** 11285,11291 ****
  #################################################
  # check for a PAM password database
  echo $ac_n "checking whether to use PAM password database""... $ac_c" 1>&6
! echo "configure:11289: checking whether to use PAM password database" >&5
  # Check whether --with-pam or --without-pam was given.
  if test "${with_pam+set}" = set; then
    withval="$with_pam"
--- 11464,11470 ----
  #################################################
  # check for a PAM password database
  echo $ac_n "checking whether to use PAM password database""... $ac_c" 1>&6
! echo "configure:11468: checking whether to use PAM password database" >&5
  # Check whether --with-pam or --without-pam was given.
  if test "${with_pam+set}" = set; then
    withval="$with_pam"
***************
*** 11354,11360 ****
  #################################################
  # check for a NISPLUS password database
  echo $ac_n "checking whether to use NISPLUS password database""... $ac_c" 1>&6
! echo "configure:11358: checking whether to use NISPLUS password database" >&5
  # Check whether --with-nisplus or --without-nisplus was given.
  if test "${with_nisplus+set}" = set; then
    withval="$with_nisplus"
--- 11533,11539 ----
  #################################################
  # check for a NISPLUS password database
  echo $ac_n "checking whether to use NISPLUS password database""... $ac_c" 1>&6
! echo "configure:11537: checking whether to use NISPLUS password database" >&5
  # Check whether --with-nisplus or --without-nisplus was given.
  if test "${with_nisplus+set}" = set; then
    withval="$with_nisplus"
***************
*** 11379,11385 ****
  #################################################
  # check for a NISPLUS_HOME support 
  echo $ac_n "checking whether to use NISPLUS_HOME""... $ac_c" 1>&6
! echo "configure:11383: checking whether to use NISPLUS_HOME" >&5
  # Check whether --with-nisplus-home or --without-nisplus-home was given.
  if test "${with_nisplus_home+set}" = set; then
    withval="$with_nisplus_home"
--- 11558,11564 ----
  #################################################
  # check for a NISPLUS_HOME support 
  echo $ac_n "checking whether to use NISPLUS_HOME""... $ac_c" 1>&6
! echo "configure:11562: checking whether to use NISPLUS_HOME" >&5
  # Check whether --with-nisplus-home or --without-nisplus-home was given.
  if test "${with_nisplus_home+set}" = set; then
    withval="$with_nisplus_home"
***************
*** 11404,11410 ****
  #################################################
  # check for the secure socket layer
  echo $ac_n "checking whether to use SSL""... $ac_c" 1>&6
! echo "configure:11408: checking whether to use SSL" >&5
  # Check whether --with-ssl or --without-ssl was given.
  if test "${with_ssl+set}" = set; then
    withval="$with_ssl"
--- 11583,11589 ----
  #################################################
  # check for the secure socket layer
  echo $ac_n "checking whether to use SSL""... $ac_c" 1>&6
! echo "configure:11587: checking whether to use SSL" >&5
  # Check whether --with-ssl or --without-ssl was given.
  if test "${with_ssl+set}" = set; then
    withval="$with_ssl"
***************
*** 11463,11469 ****
  #################################################
  # check for syslog logging
  echo $ac_n "checking whether to use syslog logging""... $ac_c" 1>&6
! echo "configure:11467: checking whether to use syslog logging" >&5
  # Check whether --with-syslog or --without-syslog was given.
  if test "${with_syslog+set}" = set; then
    withval="$with_syslog"
--- 11642,11648 ----
  #################################################
  # check for syslog logging
  echo $ac_n "checking whether to use syslog logging""... $ac_c" 1>&6
! echo "configure:11646: checking whether to use syslog logging" >&5
  # Check whether --with-syslog or --without-syslog was given.
  if test "${with_syslog+set}" = set; then
    withval="$with_syslog"
***************
*** 11488,11494 ****
  #################################################
  # check for a shared memory profiling support
  echo $ac_n "checking whether to use profiling""... $ac_c" 1>&6
! echo "configure:11492: checking whether to use profiling" >&5
  # Check whether --with-profile or --without-profile was given.
  if test "${with_profile+set}" = set; then
    withval="$with_profile"
--- 11667,11673 ----
  #################################################
  # check for a shared memory profiling support
  echo $ac_n "checking whether to use profiling""... $ac_c" 1>&6
! echo "configure:11671: checking whether to use profiling" >&5
  # Check whether --with-profile or --without-profile was given.
  if test "${with_profile+set}" = set; then
    withval="$with_profile"
***************
*** 11514,11520 ****
  #################################################
  # check for experimental netatalk resource fork support
  echo $ac_n "checking whether to support netatalk""... $ac_c" 1>&6
! echo "configure:11518: checking whether to support netatalk" >&5
  # Check whether --with-netatalk or --without-netatalk was given.
  if test "${with_netatalk+set}" = set; then
    withval="$with_netatalk"
--- 11693,11699 ----
  #################################################
  # check for experimental netatalk resource fork support
  echo $ac_n "checking whether to support netatalk""... $ac_c" 1>&6
! echo "configure:11697: checking whether to support netatalk" >&5
  # Check whether --with-netatalk or --without-netatalk was given.
  if test "${with_netatalk+set}" = set; then
    withval="$with_netatalk"
***************
*** 11541,11547 ****
  QUOTAOBJS=smbd/noquotas.o
  
  echo $ac_n "checking whether to support disk-quotas""... $ac_c" 1>&6
! echo "configure:11545: checking whether to support disk-quotas" >&5
  # Check whether --with-quotas or --without-quotas was given.
  if test "${with_quotas+set}" = set; then
    withval="$with_quotas"
--- 11720,11726 ----
  QUOTAOBJS=smbd/noquotas.o
  
  echo $ac_n "checking whether to support disk-quotas""... $ac_c" 1>&6
! echo "configure:11724: checking whether to support disk-quotas" >&5
  # Check whether --with-quotas or --without-quotas was given.
  if test "${with_quotas+set}" = set; then
    withval="$with_quotas"
***************
*** 11565,11571 ****
  # check for experimental utmp accounting
  
  echo $ac_n "checking whether to support utmp accounting""... $ac_c" 1>&6
! echo "configure:11569: checking whether to support utmp accounting" >&5
  # Check whether --with-utmp or --without-utmp was given.
  if test "${with_utmp+set}" = set; then
    withval="$with_utmp"
--- 11744,11750 ----
  # check for experimental utmp accounting
  
  echo $ac_n "checking whether to support utmp accounting""... $ac_c" 1>&6
! echo "configure:11748: checking whether to support utmp accounting" >&5
  # Check whether --with-utmp or --without-utmp was given.
  if test "${with_utmp+set}" = set; then
    withval="$with_utmp"
***************
*** 11591,11597 ****
  # check for MS Dfs support
  
  echo $ac_n "checking whether to support Microsoft Dfs""... $ac_c" 1>&6
! echo "configure:11595: checking whether to support Microsoft Dfs" >&5
  # Check whether --with-msdfs or --without-msdfs was given.
  if test "${with_msdfs+set}" = set; then
    withval="$with_msdfs"
--- 11770,11776 ----
  # check for MS Dfs support
  
  echo $ac_n "checking whether to support Microsoft Dfs""... $ac_c" 1>&6
! echo "configure:11774: checking whether to support Microsoft Dfs" >&5
  # Check whether --with-msdfs or --without-msdfs was given.
  if test "${with_msdfs+set}" = set; then
    withval="$with_msdfs"
***************
*** 11617,11623 ****
  # check for Samba VFS support
  
  echo $ac_n "checking whether to support the experimantal Samba vfs""... $ac_c" 1>&6
! echo "configure:11621: checking whether to support the experimantal Samba vfs" >&5
  # Check whether --with-vfs or --without-vfs was given.
  if test "${with_vfs+set}" = set; then
    withval="$with_vfs"
--- 11796,11802 ----
  # check for Samba VFS support
  
  echo $ac_n "checking whether to support the experimantal Samba vfs""... $ac_c" 1>&6
! echo "configure:11800: checking whether to support the experimantal Samba vfs" >&5
  # Check whether --with-vfs or --without-vfs was given.
  if test "${with_vfs+set}" = set; then
    withval="$with_vfs"
***************
*** 11642,11655 ****
  #################################################
  # these tests are taken from the GNU fileutils package
  echo "checking how to get filesystem space usage" 1>&6
! echo "configure:11646: checking how to get filesystem space usage" >&5
  space=no
  
  # Test for statvfs64.
  if test $space = no; then
    # SVR4
    echo $ac_n "checking statvfs64 function (SVR4)""... $ac_c" 1>&6
! echo "configure:11653: checking statvfs64 function (SVR4)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statvfs64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 11821,11834 ----
  #################################################
  # these tests are taken from the GNU fileutils package
  echo "checking how to get filesystem space usage" 1>&6
! echo "configure:11825: checking how to get filesystem space usage" >&5
  space=no
  
  # Test for statvfs64.
  if test $space = no; then
    # SVR4
    echo $ac_n "checking statvfs64 function (SVR4)""... $ac_c" 1>&6
! echo "configure:11832: checking statvfs64 function (SVR4)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statvfs64'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 11657,11663 ****
    fu_cv_sys_stat_statvfs64=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 11661 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
--- 11836,11842 ----
    fu_cv_sys_stat_statvfs64=cross
  else
    cat > conftest.$ac_ext <<EOF
! #line 11840 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_UNISTD_H)
***************
*** 11671,11677 ****
      exit (statvfs64 (".", &fsd));
    }
  EOF
! if { (eval echo configure:11675: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statvfs64=yes
  else
--- 11850,11856 ----
      exit (statvfs64 (".", &fsd));
    }
  EOF
! if { (eval echo configure:11854: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statvfs64=yes
  else
***************
*** 11704,11715 ****
  if test $space = no; then
    # SVR4
    echo $ac_n "checking statvfs function (SVR4)""... $ac_c" 1>&6
! echo "configure:11708: checking statvfs function (SVR4)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statvfs'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 11713 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statvfs.h>
--- 11883,11894 ----
  if test $space = no; then
    # SVR4
    echo $ac_n "checking statvfs function (SVR4)""... $ac_c" 1>&6
! echo "configure:11887: checking statvfs function (SVR4)" >&5
  if eval "test \"`echo '$''{'fu_cv_sys_stat_statvfs'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    cat > conftest.$ac_ext <<EOF
! #line 11892 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statvfs.h>
***************
*** 11717,11723 ****
  struct statvfs fsd; statvfs (0, &fsd);
  ; return 0; }
  EOF
! if { (eval echo configure:11721: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_stat_statvfs=yes
  else
--- 11896,11902 ----
  struct statvfs fsd; statvfs (0, &fsd);
  ; return 0; }
  EOF
! if { (eval echo configure:11900: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    fu_cv_sys_stat_statvfs=yes
  else
***************
*** 11742,11748 ****
  if test $space = no; then
    # DEC Alpha running OSF/1
    echo $ac_n "checking for 3-argument statfs function (DEC OSF/1)""... $ac_c" 1>&6
! echo "configure:11746: checking for 3-argument statfs function (DEC OSF/1)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs3_osf1'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 11921,11927 ----
  if test $space = no; then
    # DEC Alpha running OSF/1
    echo $ac_n "checking for 3-argument statfs function (DEC OSF/1)""... $ac_c" 1>&6
! echo "configure:11925: checking for 3-argument statfs function (DEC OSF/1)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs3_osf1'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 11750,11756 ****
    fu_cv_sys_stat_statfs3_osf1=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11754 "configure"
  #include "confdefs.h"
  
  #include <sys/param.h>
--- 11929,11935 ----
    fu_cv_sys_stat_statfs3_osf1=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11933 "configure"
  #include "confdefs.h"
  
  #include <sys/param.h>
***************
*** 11763,11769 ****
      exit (statfs (".", &fsd, sizeof (struct statfs)));
    }
  EOF
! if { (eval echo configure:11767: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs3_osf1=yes
  else
--- 11942,11948 ----
      exit (statfs (".", &fsd, sizeof (struct statfs)));
    }
  EOF
! if { (eval echo configure:11946: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs3_osf1=yes
  else
***************
*** 11790,11796 ****
  if test $space = no; then
  # AIX
    echo $ac_n "checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)""... $ac_c" 1>&6
! echo "configure:11794: checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_bsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 11969,11975 ----
  if test $space = no; then
  # AIX
    echo $ac_n "checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)""... $ac_c" 1>&6
! echo "configure:11973: checking for two-argument statfs with statfs.bsize member (AIX, 4.3BSD)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_bsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 11798,11804 ****
    fu_cv_sys_stat_statfs2_bsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11802 "configure"
  #include "confdefs.h"
  
  #ifdef HAVE_SYS_PARAM_H
--- 11977,11983 ----
    fu_cv_sys_stat_statfs2_bsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11981 "configure"
  #include "confdefs.h"
  
  #ifdef HAVE_SYS_PARAM_H
***************
*** 11817,11823 ****
    exit (statfs (".", &fsd));
    }
  EOF
! if { (eval echo configure:11821: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_bsize=yes
  else
--- 11996,12002 ----
    exit (statfs (".", &fsd));
    }
  EOF
! if { (eval echo configure:12000: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_bsize=yes
  else
***************
*** 11844,11850 ****
  if test $space = no; then
  # SVR3
    echo $ac_n "checking for four-argument statfs (AIX-3.2.5, SVR3)""... $ac_c" 1>&6
! echo "configure:11848: checking for four-argument statfs (AIX-3.2.5, SVR3)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs4'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 12023,12029 ----
  if test $space = no; then
  # SVR3
    echo $ac_n "checking for four-argument statfs (AIX-3.2.5, SVR3)""... $ac_c" 1>&6
! echo "configure:12027: checking for four-argument statfs (AIX-3.2.5, SVR3)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs4'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 11852,11858 ****
    fu_cv_sys_stat_statfs4=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11856 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statfs.h>
--- 12031,12037 ----
    fu_cv_sys_stat_statfs4=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 12035 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/statfs.h>
***************
*** 11862,11868 ****
    exit (statfs (".", &fsd, sizeof fsd, 0));
    }
  EOF
! if { (eval echo configure:11866: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs4=yes
  else
--- 12041,12047 ----
    exit (statfs (".", &fsd, sizeof fsd, 0));
    }
  EOF
! if { (eval echo configure:12045: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs4=yes
  else
***************
*** 11889,11895 ****
  if test $space = no; then
  # 4.4BSD and NetBSD
    echo $ac_n "checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)""... $ac_c" 1>&6
! echo "configure:11893: checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_fsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 12068,12074 ----
  if test $space = no; then
  # 4.4BSD and NetBSD
    echo $ac_n "checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)""... $ac_c" 1>&6
! echo "configure:12072: checking for two-argument statfs with statfs.fsize member (4.4BSD and NetBSD)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_statfs2_fsize'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 11897,11903 ****
    fu_cv_sys_stat_statfs2_fsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11901 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
--- 12076,12082 ----
    fu_cv_sys_stat_statfs2_fsize=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 12080 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
***************
*** 11913,11919 ****
    exit (statfs (".", &fsd));
    }
  EOF
! if { (eval echo configure:11917: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_fsize=yes
  else
--- 12092,12098 ----
    exit (statfs (".", &fsd));
    }
  EOF
! if { (eval echo configure:12096: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_statfs2_fsize=yes
  else
***************
*** 11940,11946 ****
  if test $space = no; then
    # Ultrix
    echo $ac_n "checking for two-argument statfs with struct fs_data (Ultrix)""... $ac_c" 1>&6
! echo "configure:11944: checking for two-argument statfs with struct fs_data (Ultrix)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_fs_data'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
--- 12119,12125 ----
  if test $space = no; then
    # Ultrix
    echo $ac_n "checking for two-argument statfs with struct fs_data (Ultrix)""... $ac_c" 1>&6
! echo "configure:12123: checking for two-argument statfs with struct fs_data (Ultrix)" >&5
    if eval "test \"`echo '$''{'fu_cv_sys_stat_fs_data'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
***************
*** 11948,11954 ****
    fu_cv_sys_stat_fs_data=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 11952 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
--- 12127,12133 ----
    fu_cv_sys_stat_fs_data=no
  else
    cat > conftest.$ac_ext <<EOF
! #line 12131 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #ifdef HAVE_SYS_PARAM_H
***************
*** 11968,11974 ****
    exit (statfs (".", &fsd) != 1);
    }
  EOF
! if { (eval echo configure:11972: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_fs_data=yes
  else
--- 12147,12153 ----
    exit (statfs (".", &fsd) != 1);
    }
  EOF
! if { (eval echo configure:12151: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    fu_cv_sys_stat_fs_data=yes
  else
***************
*** 12001,12009 ****
  # file support.
  #
  echo $ac_n "checking checking if large file support can be enabled""... $ac_c" 1>&6
! echo "configure:12005: checking checking if large file support can be enabled" >&5
  cat > conftest.$ac_ext <<EOF
! #line 12007 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_LONGLONG) && (defined(HAVE_OFF64_T) || (defined(SIZEOF_OFF_T) && (SIZEOF_OFF_T == 8)))
--- 12180,12188 ----
  # file support.
  #
  echo $ac_n "checking checking if large file support can be enabled""... $ac_c" 1>&6
! echo "configure:12184: checking checking if large file support can be enabled" >&5
  cat > conftest.$ac_ext <<EOF
! #line 12186 "configure"
  #include "confdefs.h"
  
  #if defined(HAVE_LONGLONG) && (defined(HAVE_OFF64_T) || (defined(SIZEOF_OFF_T) && (SIZEOF_OFF_T == 8)))
***************
*** 12016,12022 ****
  int i
  ; return 0; }
  EOF
! if { (eval echo configure:12020: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_EXPLICIT_LARGEFILE_SUPPORT=yes
  else
--- 12195,12201 ----
  int i
  ; return 0; }
  EOF
! if { (eval echo configure:12199: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_EXPLICIT_LARGEFILE_SUPPORT=yes
  else
***************
*** 12083,12089 ****
  # check for ACL support
  
  echo $ac_n "checking whether to support ACLs""... $ac_c" 1>&6
! echo "configure:12087: checking whether to support ACLs" >&5
  # Check whether --with-acl-support or --without-acl-support was given.
  if test "${with_acl_support+set}" = set; then
    withval="$with_acl_support"
--- 12262,12268 ----
  # check for ACL support
  
  echo $ac_n "checking whether to support ACLs""... $ac_c" 1>&6
! echo "configure:12266: checking whether to support ACLs" >&5
  # Check whether --with-acl-support or --without-acl-support was given.
  if test "${with_acl_support+set}" = set; then
    withval="$with_acl_support"
***************
*** 12121,12127 ****
  			;;
  		*)
  		    echo $ac_n "checking for acl_get_file in -lacl""... $ac_c" 1>&6
! echo "configure:12125: checking for acl_get_file in -lacl" >&5
  ac_lib_var=`echo acl'_'acl_get_file | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
--- 12300,12306 ----
  			;;
  		*)
  		    echo $ac_n "checking for acl_get_file in -lacl""... $ac_c" 1>&6
! echo "configure:12304: checking for acl_get_file in -lacl" >&5
  ac_lib_var=`echo acl'_'acl_get_file | sed 'y%./+-%__p_%'`
  if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
***************
*** 12129,12135 ****
    ac_save_LIBS="$LIBS"
  LIBS="-lacl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 12133 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
--- 12308,12314 ----
    ac_save_LIBS="$LIBS"
  LIBS="-lacl  $LIBS"
  cat > conftest.$ac_ext <<EOF
! #line 12312 "configure"
  #include "confdefs.h"
  /* Override any gcc2 internal prototype to avoid an error.  */
  /* We use char because int might match the return type of a gcc2
***************
*** 12140,12146 ****
  acl_get_file()
  ; return 0; }
  EOF
! if { (eval echo configure:12144: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
--- 12319,12325 ----
  acl_get_file()
  ; return 0; }
  EOF
! if { (eval echo configure:12323: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    eval "ac_cv_lib_$ac_lib_var=yes"
  else
***************
*** 12168,12180 ****
  fi
  
  			echo $ac_n "checking for ACL support""... $ac_c" 1>&6
! echo "configure:12172: checking for ACL support" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_POSIX_ACLS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  			cat > conftest.$ac_ext <<EOF
! #line 12178 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/acl.h>
--- 12347,12359 ----
  fi
  
  			echo $ac_n "checking for ACL support""... $ac_c" 1>&6
! echo "configure:12351: checking for ACL support" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_POSIX_ACLS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  			cat > conftest.$ac_ext <<EOF
! #line 12357 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/acl.h>
***************
*** 12182,12188 ****
   acl_t acl; int entry_id; acl_entry_t *entry_p; return acl_get_entry( acl, entry_id, entry_p);
  ; return 0; }
  EOF
! if { (eval echo configure:12186: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    samba_cv_HAVE_POSIX_ACLS=yes
  else
--- 12361,12367 ----
   acl_t acl; int entry_id; acl_entry_t *entry_p; return acl_get_entry( acl, entry_id, entry_p);
  ; return 0; }
  EOF
! if { (eval echo configure:12365: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    samba_cv_HAVE_POSIX_ACLS=yes
  else
***************
*** 12202,12214 ****
  EOF
  
  				echo $ac_n "checking for acl_get_perm_np""... $ac_c" 1>&6
! echo "configure:12206: checking for acl_get_perm_np" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_ACL_GET_PERM_NP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  				cat > conftest.$ac_ext <<EOF
! #line 12212 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/acl.h>
--- 12381,12393 ----
  EOF
  
  				echo $ac_n "checking for acl_get_perm_np""... $ac_c" 1>&6
! echo "configure:12385: checking for acl_get_perm_np" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_ACL_GET_PERM_NP'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  				cat > conftest.$ac_ext <<EOF
! #line 12391 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <sys/acl.h>
***************
*** 12216,12222 ****
   acl_permset_t permset_d; acl_perm_t perm; return acl_get_perm_np( permset_d, perm);
  ; return 0; }
  EOF
! if { (eval echo configure:12220: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    samba_cv_HAVE_ACL_GET_PERM_NP=yes
  else
--- 12395,12401 ----
   acl_permset_t permset_d; acl_perm_t perm; return acl_get_perm_np( permset_d, perm);
  ; return 0; }
  EOF
! if { (eval echo configure:12399: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
    rm -rf conftest*
    samba_cv_HAVE_ACL_GET_PERM_NP=yes
  else
***************
*** 12237,12249 ****
  				fi
  			fi
  			echo $ac_n "checking for XFS ACL support""... $ac_c" 1>&6
! echo "configure:12241: checking for XFS ACL support" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_XFS_ACLS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  			cat > conftest.$ac_ext <<EOF
! #line 12247 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <acl/acl.h>
--- 12416,12428 ----
  				fi
  			fi
  			echo $ac_n "checking for XFS ACL support""... $ac_c" 1>&6
! echo "configure:12420: checking for XFS ACL support" >&5
  if eval "test \"`echo '$''{'samba_cv_HAVE_XFS_ACLS'+set}'`\" = set"; then
    echo $ac_n "(cached) $ac_c" 1>&6
  else
    
  			cat > conftest.$ac_ext <<EOF
! #line 12426 "configure"
  #include "confdefs.h"
  #include <sys/types.h>
  #include <acl/acl.h>
***************
*** 12251,12257 ****
   char test_str[13] = SGI_ACL_FILE; 
  ; return 0; }
  EOF
! if { (eval echo configure:12255: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_XFS_ACLS=yes
  else
--- 12430,12436 ----
   char test_str[13] = SGI_ACL_FILE; 
  ; return 0; }
  EOF
! if { (eval echo configure:12434: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
    rm -rf conftest*
    samba_cv_HAVE_XFS_ACLS=yes
  else
***************
*** 12305,12315 ****
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 12309 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/summary.c"
  EOF
! if { (eval echo configure:12313: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    echo "configure OK";
  else
--- 12484,12494 ----
    :
  else
    cat > conftest.$ac_ext <<EOF
! #line 12488 "configure"
  #include "confdefs.h"
  #include "${srcdir-.}/tests/summary.c"
  EOF
! if { (eval echo configure:12492: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
  then
    echo "configure OK";
  else
diff -d -r -c samba-2.2.0a/source/configure.in samba-2.2.0a-dce-2.5/source/configure.in
*** samba-2.2.0a/source/configure.in	Mon Apr 16 22:44:30 2001
--- samba-2.2.0a-dce-2.5/source/configure.in	Mon Jul  2 17:44:07 2001
***************
*** 1517,1531 ****
  
  
  #################################################
! # check for the DFS auth system
! AC_MSG_CHECKING(whether to use DFS auth)
  AC_ARG_WITH(dfs,
! [  --with-dfs     Include DFS support
!   --without-dfs  Don't include DFS support (default)],
  [ case "$withval" in
    yes)
      AC_MSG_RESULT(yes)
      AC_DEFINE(WITH_DFS)
      ;;
    *)
      AC_MSG_RESULT(no)
--- 1517,1630 ----
  
  
  #################################################
! # check for DCE plaintext authentication support
! AC_MSG_CHECKING(whether to use DCE plaintext authentication)
! AC_ARG_WITH(dce,
! [  --with-dce     Include DCE plaintext authentication support
!   --without-dce  Don't include DCE plaintext authentication support (default)],
! [ case "$withval" in
!   yes)
!     AC_MSG_RESULT(yes)
!     AC_DEFINE(WITH_DCE)
!     LIBS="$LIBS -ldce -lpthread"
!     CFLAGS="$CFLAGS -D_REENTRANT"
!     ;;
!   *)
!     AC_MSG_RESULT(no)
!     ;;
!   esac ],
!   AC_MSG_RESULT(no)
! )
! 
! 
! #################################################
! # check for DCE encrypted authentication support
! AC_MSG_CHECKING(whether to use DCE encrypted authentication)
! AC_ARG_WITH(dce-encrypted,
! [  --with-dce-encrypted     Include DCE encrypted authentication support
!   --without-dce-encrypted  Don't include DCE encrypted authentication support (default)],
! [ case "$withval" in
!   yes)
!     AC_MSG_RESULT(yes)
!     AC_DEFINE(WITH_DCE_ENCRYPTED)
!     LIBS="$LIBS -lsec_auth"
!     ;;
!   *)
!     AC_MSG_RESULT(no)
!     ;;
!   esac ],
!   AC_MSG_RESULT(no)
! )
! 
! 
! #################################################
! # check for DCE context refresh support
! AC_MSG_CHECKING(whether to use DCE context refresh)
! AC_ARG_WITH(dce-refresh,
! [  --with-dce-refresh     Include DCE context refresh support
!   --without-dce-refresh  Don't include DCE context refresh support (default)],
! [ case "$withval" in
!   yes)
!     AC_MSG_RESULT(yes)
!     AC_DEFINE(WITH_DCE_REFRESH)
!     ;;
!   *)
!     AC_MSG_RESULT(no)
!     ;;
!   esac ],
!   AC_MSG_RESULT(no)
! )
! 
! 
! #################################################
! # check for DCE Windows terminal server (multiuser) support
! AC_MSG_CHECKING(whether to use DCE Windows terminal server)
! AC_ARG_WITH(dce-wts,
! [  --with-dce-wts  Include DCE Windows terminal server support
!   --without-dce-wts Don't include DCE Windows terminal server support (default)],
! [ case "$withval" in
!   yes)
!     AC_MSG_RESULT(yes)
!     AC_DEFINE(WITH_DCE_WTS)
!     ;;
!   *)
!     AC_MSG_RESULT(no)
!     ;;
!   esac ],
!   AC_MSG_RESULT(no)
! )
! 
! 
! #################################################
! # check for DCE IBM kludge support
! AC_MSG_CHECKING(whether to work around broken IBM DCE security API)
! AC_ARG_WITH(dce-ibm-kludge,
! [  --with-dce-ibm-kludge  Work around broken IBM DCE security API
!   --without-dce-ibm-kludge Don't work around broken IBM DCE security API (default)],
! [ case "$withval" in
!   yes)
!     AC_MSG_RESULT(yes)
!     AC_DEFINE(WITH_DCE_IBM_KLUDGE)
!     ;;
!   *)
!     AC_MSG_RESULT(no)
!     ;;
!   esac ],
!   AC_MSG_RESULT(no)
! )
! 
! 
! #################################################
! # check for DFS support
! AC_MSG_CHECKING(whether to use DFS)
  AC_ARG_WITH(dfs,
! [  --with-dfs  Include DFS support
!   --without-dfs Don't include DFS support (default)],
  [ case "$withval" in
    yes)
      AC_MSG_RESULT(yes)
      AC_DEFINE(WITH_DFS)
+     LIBS="$LIBS -ldcedfs"
      ;;
    *)
      AC_MSG_RESULT(no)
***************
*** 1533,1538 ****
--- 1632,1657 ----
    esac ],
    AC_MSG_RESULT(no)
  )
+ 
+ 
+ #################################################
+ # check for Cal Poly Pomona allow underscores in share names
+ AC_MSG_CHECKING(whether to allow underscores in share names)
+ AC_ARG_WITH(calpoly-underscore,
+ [  --with-calpoly-underscore  Allow underscores in share names
+   --without-calpoly-underscore Don't allow underscores in share names (default)],
+ [ case "$withval" in
+   yes)
+     AC_MSG_RESULT(yes)
+     AC_DEFINE(WITH_CALPOLY_UNDERSCORE)
+     ;;
+   *)
+     AC_MSG_RESULT(no)
+     ;;
+   esac ],
+   AC_MSG_RESULT(no)
+ )
+ 
  
  #################################################
  # check for Kerberos IV auth system
diff -d -r -c samba-2.2.0a/source/include/config.h.in samba-2.2.0a-dce-2.5/source/include/config.h.in
*** samba-2.2.0a/source/include/config.h.in	Mon Apr 16 22:44:30 2001
--- samba-2.2.0a-dce-2.5/source/include/config.h.in	Mon Jul  2 15:37:45 2001
***************
*** 81,87 ****
--- 81,93 ----
  #undef HAVE_SHORT_INO_T
  #undef WITH_SMBWRAPPER
  #undef WITH_AFS
+ #undef WITH_DCE
+ #undef WITH_DCE_ENCRYPTED
+ #undef WITH_DCE_REFRESH
+ #undef WITH_DCE_WTS
+ #undef WITH_DCE_IBM_KLUDGE
  #undef WITH_DFS
+ #undef WITH_CALPOLY_UNDERSCORE
  #undef SUNOS5
  #undef SUNOS4
  #undef LINUX
diff -d -r -c samba-2.2.0a/source/include/proto.h samba-2.2.0a-dce-2.5/source/include/proto.h
*** samba-2.2.0a/source/include/proto.h	Sat Jun 23 12:28:36 2001
--- samba-2.2.0a-dce-2.5/source/include/proto.h	Mon Jul  2 17:51:26 2001
***************
*** 1859,1864 ****
--- 1859,1868 ----
  
  struct passdb_ops *ldap_initialize_password_db(void);
  
+ /*The following definitions come from  passdb/dce_pass.c  */
+ 
+ struct passdb_ops *dce_initialize_password_db(void);
+ 
  /*The following definitions come from  passdb/nispass.c  */
  
  struct passdb_ops *nisplus_initialize_password_db(void);
***************
*** 4095,4101 ****
--- 4099,4111 ----
  NT_USER_TOKEN *dup_nt_token(NT_USER_TOKEN *ptoken);
  BOOL initialise_groups(char *user, uid_t uid, gid_t gid);
  BOOL push_sec_ctx(void);
+ 
+ #ifdef WITH_DCE_WTS
+ void set_sec_ctx(uid_t uid, gid_t gid, unsigned long pag, int ngroups, gid_t *groups, NT_USER_TOKEN *token);
+ #else
  void set_sec_ctx(uid_t uid, gid_t gid, int ngroups, gid_t *groups, NT_USER_TOKEN *token);
+ #endif
+ 
  void set_root_sec_ctx(void);
  BOOL pop_sec_ctx(void);
  void init_sec_ctx(void);
diff -d -r -c samba-2.2.0a/source/include/smb.h samba-2.2.0a-dce-2.5/source/include/smb.h
*** samba-2.2.0a/source/include/smb.h	Sat Jun 23 12:28:36 2001
--- samba-2.2.0a-dce-2.5/source/include/smb.h	Mon Jul  2 14:38:15 2001
***************
*** 615,620 ****
--- 615,623 ----
  	uint16 vuid;
  	uid_t uid;
  	gid_t gid;
+ #ifdef WITH_DCE_WTS
+         unsigned long dce_pag;
+ #endif
  	int ngroups;
  	gid_t *groups;
  	NT_USER_TOKEN *nt_user_token;
***************
*** 1313,1323 ****
  int fdprintf();
  #endif
  
- #ifdef WITH_DFS
- void dfs_unlogin(void);
- extern int dcelogin_atmost_once;
- #endif
- 
  #ifdef NOSTRDUP
  char *strdup(char *s);
  #endif
--- 1316,1321 ----
***************
*** 1684,1695 ****
--- 1682,1715 ----
  #include "rpc_secdes.h"
  #include "nt_printing.h"
  
+ #ifdef WITH_DCE
+ #include <dce/sec_login.h>
+ 
+ typedef struct dce_user_struct
+ {
+         sec_login_handle_t login_context;
+ #ifdef WITH_DCE_REFRESH
+         sec_passwd_des_key_t refresh_deskey;
+         sec_passwd_str_t refresh_plaintext;
+         sec_passwd_type_t passwd_type;
+         pthread_t refresh_thread;
+ #endif
+ #ifdef WITH_DCE_WTS
+         unsigned long pag;
+ #endif
+ } dce_user_struct;
+ #endif
+ 
  typedef struct user_struct
  {
  	struct user_struct *next, *prev;
  	uint16 vuid; /* Tag for this entry. */
  	uid_t uid; /* uid of a validated user */
  	gid_t gid; /* gid of a validated user */
+ 
+ #ifdef WITH_DCE
+         dce_user_struct *dce_user;
+ #endif
  
  	userdom_struct user;
  	BOOL guest;
diff -d -r -c samba-2.2.0a/source/passdb/dce_pass.c samba-2.2.0a-dce-2.5/source/passdb/dce_pass.c
*** samba-2.2.0a/source/passdb/dce_pass.c	Tue Jul  3 15:11:18 2001
--- samba-2.2.0a-dce-2.5/source/passdb/dce_pass.c	Mon Jul  2 11:05:46 2001
***************
*** 0 ****
--- 1,138 ----
+ #include "includes.h"
+ 
+ #ifdef WITH_DCE_ENCRYPTED
+ 
+ extern int DEBUGLEVEL;
+ 
+ /***************************************************************
+  Start to enumerate the smbpasswd list. Returns a void pointer
+  to ensure no modification outside this module.
+ ****************************************************************/
+ 
+ static void *startdcesmbpwent(BOOL update)
+ {
+   return NULL;
+ }
+ 
+ /***************************************************************
+  End enumeration of the smbpasswd list.
+ ****************************************************************/
+ 
+ static void enddcesmbpwent(void *vp)
+ {
+ }
+ 
+ /*************************************************************************
+  Routine to return the next entry in the smbpasswd list.
+  *************************************************************************/
+ static struct smb_passwd *getdcesmbpwent(void *vp)
+ {
+   return NULL;
+ }
+ 
+ /*************************************************************************
+  Return the current position in the smbpasswd list as an SMB_BIG_UINT.
+  This must be treated as an opaque token.
+ *************************************************************************/
+ 
+ static SMB_BIG_UINT getdcesmbpwpos(void *vp)
+ {
+   return 0;
+ }
+ 
+ /*************************************************************************
+  Set the current position in the smbpasswd list from an SMB_BIG_UINT.
+  This must be treated as an opaque token.
+ *************************************************************************/
+ 
+ static BOOL setdcesmbpwpos(void *vp, SMB_BIG_UINT tok)
+ {
+   return 0;
+ }
+ 
+ 
+ struct smb_passwd *getdcesmbpwuid(uid_t smb_userid)
+ {
+   static struct smb_passwd pwd;
+   struct passwd *unix_pwd;
+   static pstring  user_name;
+   static unsigned char smbpwd[16] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
+   static unsigned char smbntpwd[16] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
+ 
+   if (!(unix_pwd = getpwuid(smb_userid))) {
+     DEBUG(0, ("getdcesmbpwuid getpwuid failed for %d", smb_userid));
+     return NULL;
+   }
+   
+   strncpy(user_name, unix_pwd->pw_name, 1024);
+   pwd.smb_name = user_name;
+   pwd.smb_userid = smb_userid;
+   pwd.smb_passwd = smbpwd;
+   pwd.smb_nt_passwd = smbntpwd;
+   pwd.acct_ctrl = ACB_NORMAL;  
+ 
+   return &pwd;
+ }
+ 
+ 
+ struct smb_passwd *getdcesmbpwrid(uint32 user_rid)
+ {
+   return getdcesmbpwuid(pdb_user_rid_to_uid(user_rid));
+ }
+ 
+ 
+ struct smb_passwd *getdcesmbpwnam(char *name)
+ {
+   static struct smb_passwd pwd;
+   struct passwd *unix_pwd;
+   static pstring  user_name;
+   static unsigned char smbpwd[16] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
+   static unsigned char smbntpwd[16] = {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1};
+ 
+   if (!(unix_pwd = getpwnam(name))) {
+     DEBUG(0, ("getdcesmbpwnam getpwnam failed for %s", name));
+     return NULL;
+   }
+   
+   strncpy(user_name, name, 1024);
+   pwd.smb_name = user_name;
+   pwd.smb_userid = unix_pwd->pw_uid;
+   pwd.smb_passwd = smbpwd;
+   pwd.smb_nt_passwd = smbntpwd;
+   pwd.acct_ctrl = ACB_NORMAL;  
+ 
+   return &pwd;
+ }
+ 
+ 
+ static struct passdb_ops dce_ops = {
+   startdcesmbpwent,
+   enddcesmbpwent,
+   getdcesmbpwpos,
+   setdcesmbpwpos,
+   getdcesmbpwnam,
+   getdcesmbpwuid,
+   getdcesmbpwrid,
+   getdcesmbpwent,
+   NULL,
+   NULL,
+   NULL,
+   NULL,
+   NULL,
+   NULL, 
+   NULL,
+   NULL,
+   NULL,
+   NULL,
+   NULL
+ };
+ 
+ struct passdb_ops *dce_initialize_password_db(void)
+ {    
+   return &dce_ops;
+ }
+ 
+ #else
+  /* Do *NOT* make this function static. It breaks the compile on gcc. JRA */
+  void smbpass_dummy_function(void) { } /* stop some compilers complaining */
+ #endif /* USE_SMBPASS_DB */
diff -d -r -c samba-2.2.0a/source/passdb/pass_check.c samba-2.2.0a-dce-2.5/source/passdb/pass_check.c
*** samba-2.2.0a/source/passdb/pass_check.c	Tue Apr 10 12:43:12 2001
--- samba-2.2.0a-dce-2.5/source/passdb/pass_check.c	Mon Jul  2 11:20:41 2001
***************
*** 63,375 ****
  }
  #endif
  
- 
- #ifdef WITH_DFS
- 
- #include <dce/dce_error.h>
- #include <dce/sec_login.h>
- 
- /*****************************************************************
-  This new version of the DFS_AUTH code was donated by Karsten Muuss
-  <muuss@or.uni-bonn.de>. It fixes the following problems with the
-  old code :
- 
-   - Server credentials may expire
-   - Client credential cache files have wrong owner
-   - purge_context() function is called with invalid argument
- 
-  This new code was modified to ensure that on exit the uid/gid is
-  still root, and the original directory is restored. JRA.
- ******************************************************************/
- 
- sec_login_handle_t my_dce_sec_context;
- int dcelogin_atmost_once = 0;
- 
- /*******************************************************************
- check on a DCE/DFS authentication
- ********************************************************************/
- static BOOL dfs_auth(char *user, char *password)
- {
- 	error_status_t err;
- 	int err2;
- 	int prterr;
- 	signed32 expire_time, current_time;
- 	boolean32 password_reset;
- 	struct passwd *pw;
- 	sec_passwd_rec_t passwd_rec;
- 	sec_login_auth_src_t auth_src = sec_login_auth_src_network;
- 	unsigned char dce_errstr[dce_c_error_string_len];
- 	gid_t egid;
- 
- 	if (dcelogin_atmost_once)
- 		return (False);
- 
- #ifdef HAVE_CRYPT
- 	/*
- 	 * We only go for a DCE login context if the given password
- 	 * matches that stored in the local password file.. 
- 	 * Assumes local passwd file is kept in sync w/ DCE RGY!
- 	 */
- 
- 	if (strcmp((char *)crypt(password, this_salt), this_crypted))
- 	{
- 		return (False);
- 	}
- #endif
- 
- 	sec_login_get_current_context(&my_dce_sec_context, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
- 
- 		return (False);
- 	}
- 
- 	sec_login_certify_identity(my_dce_sec_context, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get current context. %s\n", dce_errstr));
- 
- 		return (False);
- 	}
- 
- 	sec_login_get_expiration(my_dce_sec_context, &expire_time, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
- 
- 		return (False);
- 	}
- 
- 	time(&current_time);
- 
- 	if (expire_time < (current_time + 60))
- 	{
- 		struct passwd *pw;
- 		sec_passwd_rec_t *key;
- 
- 		sec_login_get_pwent(my_dce_sec_context,
- 				    (sec_login_passwd_t *) & pw, &err);
- 		if (err != error_status_ok)
- 		{
- 			dce_error_inq_text(err, dce_errstr, &err2);
- 			DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
- 
- 			return (False);
- 		}
- 
- 		sec_login_refresh_identity(my_dce_sec_context, &err);
- 		if (err != error_status_ok)
- 		{
- 			dce_error_inq_text(err, dce_errstr, &err2);
- 			DEBUG(0, ("DCE can't refresh identity. %s\n",
- 				  dce_errstr));
- 
- 			return (False);
- 		}
- 
- 		sec_key_mgmt_get_key(rpc_c_authn_dce_secret, NULL,
- 				     (unsigned char *)pw->pw_name,
- 				     sec_c_key_version_none,
- 				     (void **)&key, &err);
- 		if (err != error_status_ok)
- 		{
- 			dce_error_inq_text(err, dce_errstr, &err2);
- 			DEBUG(0, ("DCE can't get key for %s. %s\n",
- 				  pw->pw_name, dce_errstr));
- 
- 			return (False);
- 		}
- 
- 		sec_login_valid_and_cert_ident(my_dce_sec_context, key,
- 					       &password_reset, &auth_src,
- 					       &err);
- 		if (err != error_status_ok)
- 		{
- 			dce_error_inq_text(err, dce_errstr, &err2);
- 			DEBUG(0,
- 			      ("DCE can't validate and certify identity for %s. %s\n",
- 			       pw->pw_name, dce_errstr));
- 		}
- 
- 		sec_key_mgmt_free_key(key, &err);
- 		if (err != error_status_ok)
- 		{
- 			dce_error_inq_text(err, dce_errstr, &err2);
- 			DEBUG(0, ("DCE can't free key.\n", dce_errstr));
- 		}
- 	}
- 
- 	if (sec_login_setup_identity((unsigned char *)user,
- 				     sec_login_no_flags,
- 				     &my_dce_sec_context, &err) == 0)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
- 			  user, dce_errstr));
- 		return (False);
- 	}
- 
- 	sec_login_get_pwent(my_dce_sec_context,
- 			    (sec_login_passwd_t *) & pw, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
- 
- 		return (False);
- 	}
- 
- 	sec_login_purge_context(&my_dce_sec_context, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't purge context. %s\n", dce_errstr));
- 
- 		return (False);
- 	}
- 
- 	/*
- 	 * NB. I'd like to change these to call something like become_user()
- 	 * instead but currently we don't have a connection
- 	 * context to become the correct user. This is already
- 	 * fairly platform specific code however, so I think
- 	 * this should be ok. I have added code to go
- 	 * back to being root on error though. JRA.
- 	 */
- 
- 	egid = getegid();
- 
- 	set_effective_gid(pw->pw_gid);
- 	set_effective_uid(pw->pw_uid);
- 
- 	if (sec_login_setup_identity((unsigned char *)user,
- 				     sec_login_no_flags,
- 				     &my_dce_sec_context, &err) == 0)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE Setup Identity for %s failed: %s\n",
- 			  user, dce_errstr));
- 		goto err;
- 	}
- 
- 	sec_login_get_pwent(my_dce_sec_context,
- 			    (sec_login_passwd_t *) & pw, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
- 		goto err;
- 	}
- 
- 	passwd_rec.version_number = sec_passwd_c_version_none;
- 	passwd_rec.pepper = NULL;
- 	passwd_rec.key.key_type = sec_passwd_plain;
- 	passwd_rec.key.tagged_union.plain = (idl_char *) password;
- 
- 	sec_login_validate_identity(my_dce_sec_context,
- 				    &passwd_rec, &password_reset,
- 				    &auth_src, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0,
- 		      ("DCE Identity Validation failed for principal %s: %s\n",
- 		       user, dce_errstr));
- 		goto err;
- 	}
- 
- 	sec_login_certify_identity(my_dce_sec_context, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE certify identity failed: %s\n", dce_errstr));
- 		goto err;
- 	}
- 
- 	if (auth_src != sec_login_auth_src_network)
- 	{
- 		DEBUG(0, ("DCE context has no network credentials.\n"));
- 	}
- 
- 	sec_login_set_context(my_dce_sec_context, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0,
- 		      ("DCE login failed for principal %s, cant set context: %s\n",
- 		       user, dce_errstr));
- 
- 		sec_login_purge_context(&my_dce_sec_context, &err);
- 		goto err;
- 	}
- 
- 	sec_login_get_pwent(my_dce_sec_context,
- 			    (sec_login_passwd_t *) & pw, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get pwent. %s\n", dce_errstr));
- 		goto err;
- 	}
- 
- 	DEBUG(0, ("DCE login succeeded for principal %s on pid %d\n",
- 		  user, sys_getpid()));
- 
- 	DEBUG(3, ("DCE principal: %s\n"
- 		  "          uid: %d\n"
- 		  "          gid: %d\n",
- 		  pw->pw_name, pw->pw_uid, pw->pw_gid));
- 	DEBUG(3, ("         info: %s\n"
- 		  "          dir: %s\n"
- 		  "        shell: %s\n",
- 		  pw->pw_gecos, pw->pw_dir, pw->pw_shell));
- 
- 	sec_login_get_expiration(my_dce_sec_context, &expire_time, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0, ("DCE can't get expiration. %s\n", dce_errstr));
- 		goto err;
- 	}
- 
- 	set_effective_uid(0);
- 	set_effective_gid(0);
- 
- 	DEBUG(0,
- 	      ("DCE context expires: %s", asctime(localtime(&expire_time))));
- 
- 	dcelogin_atmost_once = 1;
- 	return (True);
- 
-       err:
- 
- 	/* Go back to root, JRA. */
- 	set_effective_uid(0);
- 	set_effective_gid(egid);
- 	return (False);
- }
- 
- void dfs_unlogin(void)
- {
- 	error_status_t err;
- 	int err2;
- 	unsigned char dce_errstr[dce_c_error_string_len];
- 
- 	sec_login_purge_context(&my_dce_sec_context, &err);
- 	if (err != error_status_ok)
- 	{
- 		dce_error_inq_text(err, dce_errstr, &err2);
- 		DEBUG(0,
- 		      ("DCE purge login context failed for server instance %d: %s\n",
- 		       sys_getpid(), dce_errstr));
- 	}
- }
- #endif
- 
  #ifdef KRB5_AUTH
  
  #include <krb5.h>
--- 63,68 ----
***************
*** 607,616 ****
  		return (True);
  #endif /* WITH_AFS */
  
! #ifdef WITH_DFS
! 	if (dfs_auth(this_user, password))
  		return (True);
! #endif /* WITH_DFS */
  
  #ifdef KRB5_AUTH
  	if (krb5_auth(this_user, password))
--- 300,309 ----
  		return (True);
  #endif /* WITH_AFS */
  
! #ifdef WITH_DCE
! 	if (dce_auth(this_user, password))
  		return (True);
! #endif /* WITH_DCE */
  
  #ifdef KRB5_AUTH
  	if (krb5_auth(this_user, password))
diff -d -r -c samba-2.2.0a/source/passdb/passdb.c samba-2.2.0a-dce-2.5/source/passdb/passdb.c
*** samba-2.2.0a/source/passdb/passdb.c	Mon Mar 26 10:18:18 2001
--- samba-2.2.0a-dce-2.5/source/passdb/passdb.c	Mon Jul  2 11:20:40 2001
***************
*** 73,78 ****
--- 73,80 ----
  
  #ifdef WITH_NISPLUS
    pdb_ops =  nisplus_initialize_password_db();
+ #elif defined(WITH_DCE_ENCRYPTED)
+   pdb_ops = dce_initialize_password_db();
  #elif defined(WITH_LDAP)
    pdb_ops = ldap_initialize_password_db();
  #elif defined(WITH_TDBPWD)
diff -d -r -c samba-2.2.0a/source/smbd/dcedfs.c samba-2.2.0a-dce-2.5/source/smbd/dcedfs.c
*** samba-2.2.0a/source/smbd/dcedfs.c	Tue Jul  3 15:10:52 2001
--- samba-2.2.0a-dce-2.5/source/smbd/dcedfs.c	Fri Jul  6 12:02:21 2001
***************
*** 0 ****
--- 1,875 ----
+ #include "includes.h"
+ 
+ extern int DEBUGLEVEL;
+ 
+ #ifdef WITH_DCE
+ 
+ #include <dce/sec_login.h>
+ #include <dce/dce_error.h>
+ #include <dce/pthread.h>
+ 
+ #define DCE_CREDS_DIR "/opt/dcelocal/var/security/creds"
+ #define DCE_CREDS_DIR_LEN 32
+ 
+ dce_user_struct *dce_user = NULL;
+ 
+ #ifdef WITH_DCE_WTS
+ char dce_krb5ccname[] = "KRB5CCNAME=FILE:" DCE_CREDS_DIR "/dcecred_XXXXXXXX";
+ char *dce_krb5ccname_pag = dce_krb5ccname + 16 + DCE_CREDS_DIR_LEN + 9;
+ #else
+ static int dce_mutex = 0;
+ #endif
+ 
+ #ifdef WITH_DCE_REFRESH
+ 
+ static pthread_addr_t refresh_context(void *arg)
+ {
+   signed32 expiration_time;
+   time_t now;
+   struct timespec sleep_interval;
+   error_status_t dce_st;
+   dce_error_string_t dce_error;
+   int dce_error_st;
+   sec_login_auth_src_t auth_src;
+   unsigned32 kvno_worked;
+   boolean32 reset_passwd;
+   sec_passwd_str_t tmp_pw;
+   sec_passwd_rec_t passwd_rec;
+   dce_user_struct *dce_user = (dce_user_struct *)arg;
+ 
+   while (1)
+     {
+       now = time(NULL);
+ 
+       sec_login_get_expiration(dce_user->login_context, &expiration_time, &dce_st);
+       if (dce_st && (dce_st != sec_login_s_not_certified))
+         {
+           dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+           DEBUG(0, ("refresh_context: sec_login_get_expiration failed - %s (%d)\n", dce_error, dce_st));
+           expiration_time = now + 20 * 60;
+         }
+ 
+       sleep_interval.tv_sec = expiration_time - now - 10 * 60;
+       sleep_interval.tv_nsec = 0;
+       
+       pthread_delay_np(&sleep_interval);
+         
+       sec_login_refresh_identity(dce_user->login_context, &dce_st);
+       if (dce_st)
+         {
+           dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+           DEBUG(0, ("refresh_context: sec_login_refresh_identity failed - %s (%d)\n", dce_error, dce_st));
+         }
+       
+       if (dce_user->passwd_type == sec_passwd_plain)
+ 	{
+ 	  passwd_rec.key.key_type = sec_passwd_plain;
+ 	  strncpy( (char *)tmp_pw, dce_user->refresh_plaintext, sec_passwd_str_max_len);
+ 	  tmp_pw[sec_passwd_str_max_len] = '\0';
+ 	  passwd_rec.key.tagged_union.plain = &(tmp_pw[0]);
+ 	}
+       else
+ 	{
+ 	  passwd_rec.key.key_type = sec_passwd_des;
+ 	  memcpy(passwd_rec.key.tagged_union.des_key, dce_user->refresh_deskey, sec_passwd_c_des_key_size);
+ 	}
+ 
+       sec_login_validate_identity(dce_user->login_context, &passwd_rec, &reset_passwd, &auth_src, &dce_st);
+       if (dce_st)
+         {
+           dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+           DEBUG(0, ("refresh_context: sec_login_validate_identity failed - %s (%d)\n", dce_error, dce_st));
+         }
+     }              
+ }
+ #endif
+ 
+ #ifdef WITH_DCE_WTS
+ void dce_init()
+ {
+   putenv(dce_krb5ccname);
+   *dce_krb5ccname = 'X';
+ }
+ #endif
+   
+ int dce_auth(char *username, char *password)
+ {
+   error_status_t dce_st;
+   dce_error_string_t dce_error;
+   int dce_error_st;
+   sec_login_auth_src_t auth_src;
+   sec_passwd_rec_t pw_entry;
+   boolean32 reset_passwd;
+   sec_passwd_str_t tmp_pw;
+   sec_login_handle_t login_context;
+ 
+ #ifndef WITH_DCE_WTS
+   if (dce_mutex)
+     {
+       DEBUG(0, ("dce_auth: smbd process already has DCE credentials, failing authentication for %s\n", username));
+       return 0;
+     }
+ #endif
+ 
+   if (!sec_login_setup_identity(username, sec_login_no_flags, &login_context, &dce_st))
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_auth: unable to setup identity for %s - %s\n", username, dce_error));
+       return 0;
+     }
+ 
+   pw_entry.version_number = sec_passwd_c_version_none;
+   pw_entry.pepper = NULL;
+   pw_entry.key.key_type = sec_passwd_plain;
+   strncpy( (char *)tmp_pw, password, sec_passwd_str_max_len);
+   tmp_pw[sec_passwd_str_max_len] = '\0';
+   pw_entry.key.tagged_union.plain = &(tmp_pw[0]);
+ 
+   if (!sec_login_valid_and_cert_ident(login_context, &pw_entry, &reset_passwd, &auth_src, &dce_st))
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_auth: unable to validate identity for %s - %s\n", username, dce_error));
+       return 0;
+     }
+ 
+   if (auth_src != sec_login_auth_src_network)
+     {
+       DEBUG(0, ("dce_auth: no network credentials for %s\n", username));
+       sec_login_purge_context(login_context, &dce_st);
+       return 0;
+     }
+ 
+   sec_login_set_context(login_context, &dce_st);
+ 
+   if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_auth: unable to set context for %s - %s\n", username, dce_error));
+       sec_login_purge_context(login_context, &dce_st);
+       return 0;
+     }
+ 
+ #ifdef WITH_DCE_IBM_KLUDGE
+   {
+     char path[MAXPATHLEN];
+     struct passwd *pwd;
+     char *krb5ccname;
+     char *pag_str;
+     unsigned long pag;
+     
+     sec_login_get_pwent(login_context, (sec_login_passwd_t *)&pwd, &dce_st);
+     
+ #undef snprintf
+ 
+     if (krb5ccname = getenv("KRB5CCNAME"))
+       if (pag_str = strrchr(krb5ccname, '_'))
+       {
+ 	pag = strtol(pag_str+1, NULL, 16);
+ 
+ 	snprintf(path, MAXPATHLEN, "%s/dcecred_%08x", DCE_CREDS_DIR, pag);
+ 	path[MAXPATHLEN-1] = '\0';
+ 	chown(path, pwd->pw_uid, pwd->pw_gid);
+ 	
+ 	snprintf(path, MAXPATHLEN, "%s/dcecred_%08x.data", DCE_CREDS_DIR, pag);
+ 	path[MAXPATHLEN-1] = '\0';
+ 	chown(path, pwd->pw_uid, pwd->pw_gid);
+ 	
+ 	snprintf(path, MAXPATHLEN, "%s/dcecred_%08x.data.db", DCE_CREDS_DIR, pag);
+ 	path[MAXPATHLEN-1] = '\0';
+ 	chown(path, pwd->pw_uid, pwd->pw_gid);
+ 	
+ 	snprintf(path, MAXPATHLEN, "%s/dcecred_%08x.nc", DCE_CREDS_DIR, pag);
+ 	path[MAXPATHLEN-1] = '\0';
+ 	chown(path, pwd->pw_uid, pwd->pw_gid);
+       }
+   }
+ #endif
+ 
+   if (!(dce_user = (dce_user_struct *)malloc(sizeof(dce_user_struct))))
+   {
+       DEBUG(0, ("dce_auth: failed to allocate memory for dce_user_struct"));
+       sec_login_purge_context(&login_context, &dce_st);
+       return 0;
+   }
+ 
+ #ifdef WITH_DCE_WTS
+   dce_user->pag = sec_login_inq_pag(login_context, &dce_st);
+   if (dce_st || ! dce_user->pag)
+   {
+     dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+     DEBUG(0, ("dce_auth: unable to acquire pag for %s - %s\n", username, dce_error));
+     free(dce_user);
+     sec_login_purge_context(&login_context, &dce_st);
+     return 0;
+   }
+   
+   sec_login_release_context(&login_context, &dce_st);
+   if (dce_st)
+   {
+     dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+     DEBUG(0, ("dce_auth: sec_login_release_context failed for %s - %s\n", username, dce_error));
+     free(dce_user);
+     sec_login_purge_context(&login_context, &dce_st);
+     return 0;
+   }
+ 
+   {
+     char import_buf[5 + strlen(DCE_CREDS_DIR) + 17 + 1];
+ 
+ #undef sprintf
+ 
+     sprintf(import_buf, "FILE:%s/dcecred_%08x", DCE_CREDS_DIR, dce_user->pag);
+ 
+     sec_login_import_context(sizeof(import_buf), import_buf, &login_context, &dce_st);
+     if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_auth: sec_login_import_context failed for %s - %s\n", username, dce_error));
+       free(dce_user);
+       sec_login_purge_context(&login_context, &dce_st);
+       return 0;
+     }
+ 
+   }
+ #else
+   dce_mutex = 1;
+ #endif
+     
+   dce_user->login_context = login_context;
+ 
+ #ifdef WITH_DCE_REFRESH
+   dce_user->passwd_type = sec_passwd_plain;
+   strncpy( (char *)(dce_user->refresh_plaintext), password, sec_passwd_str_max_len);
+   dce_user->refresh_plaintext[sec_passwd_str_max_len] = '\0';
+ 
+   if (pthread_create(&dce_user->refresh_thread, pthread_attr_default, refresh_context, (void *)dce_user))
+     DEBUG(0, ("dce_auth: pthread_create failed\n"));
+ #endif
+ 
+   return 1;
+ }
+ 
+ void dce_logout(dce_user_struct *dce_user)
+ {
+   error_status_t dce_st;
+ 
+ #ifdef WITH_DCE_REFRESH
+   pthread_cancel(dce_user->refresh_thread);
+ #endif
+ 
+   sec_login_purge_context(&dce_user->login_context, &dce_st);
+   free(dce_user);
+ 
+ #ifndef WITH_DCE_WTS
+   dce_mutex = 0;
+ #endif
+ }
+ 
+ #ifdef WITH_DCE_ENCRYPTED
+ 
+ #include <dce/acct.h>
+ #include <sec_auth.h>
+ 
+ BOOL dce_update_encrypted_pw(char *username, char *password)
+ {
+   sec_rgy_login_name_t login_name;
+   sec_passwd_version_t new_version;
+   sec_passwd_rec_t key;
+   error_status_t dce_st;
+   sec_passwd_str_t pw;
+   sec_rgy_handle_t rgy_handle;
+   dce_error_string_t dce_error;
+   int dce_error_st;
+ 
+   strncpy(login_name.pname, username, sec_rgy_name_max_len);
+   strncpy(login_name.gname, "", sec_rgy_name_max_len);
+   strncpy(login_name.oname, "", sec_rgy_name_max_len);
+   
+   key.version_number = sec_passwd_c_version_none;
+   key.pepper = NULL;
+   key.key.key_type = sec_passwd_plain;
+   strncpy( (char *)pw, password, sec_passwd_str_max_len);
+   pw[sec_passwd_str_max_len] = '\0';
+   key.key.tagged_union.plain = &(pw[0]);
+ 
+   sec_rgy_site_open_update(NULL, &rgy_handle, &dce_st);
+   
+   sec_rgy_acct_passwd(rgy_handle, &login_name, &key, &key, sec_passwd_des, &new_version, &dce_st);
+ 
+   if (dce_st != error_status_ok)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_update_encrypted_pw: sec_rgy_account_password failed for %s - %s\n", username, dce_error));
+       return 0;
+     }
+ 
+   return 1;
+ }
+ 
+ BOOL dce_smb_password_check(char *username, unsigned char *challenge, unsigned char *response, int hash_type)
+ {
+   error_status_t dce_st;
+   dce_error_string_t dce_error;
+   int dce_error_st;
+   sec_login_auth_src_t auth_src;
+   sec_passwd_rec_t pw_entry;
+   boolean32 reset_passwd;
+   sec_passwd_str_t tmp_pw;
+   rpc_ns_handle_t lookup_context;
+   rpc_binding_vector_t *binding_vec;
+   rpc_binding_handle_t handle;
+   unsigned_char_t *server_princ_name;
+   sec_rgy_name_t princ_name;
+ 
+ #ifndef WITH_DCE_WTS
+   if (dce_mutex)
+     {
+       DEBUG(0, ("dce_auth: smbd process already has DCE credentials, failing authentication for %s\n", username));
+       return 0;
+     }
+ #endif
+ 
+   rpc_ns_binding_lookup_begin(rpc_c_ns_syntax_default, SEC_AUTH_RPC_GROUP_NAME,
+                             SEC_AUTH_C_IFSPEC, NULL, 5, &lookup_context,
+                             &dce_st);
+ 
+   if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("rpc_ns_binding_lookup_begin failed - %s\n", dce_error));
+       return 0;
+     }
+ 
+   rpc_ns_binding_lookup_next(lookup_context, &binding_vec, &dce_st);
+ 
+   if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("rpc_ns_binding_lookup_next failed - %s\n", dce_error));
+       return 0;
+     }
+  
+   rpc_ns_binding_lookup_done(&lookup_context, &dce_st);
+ 
+   if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("rpc_ns_binding_lookup_done failed - %s\n", dce_error));
+       return 0;
+     }
+ 
+   while (1)
+     {
+       rpc_ns_binding_select(binding_vec, &handle, &dce_st);
+ 
+       if (dce_st)
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("rpc_ns_binding_select failed - %s\n", dce_error));
+         rpc_binding_vector_free(&binding_vec, &dce_st);
+         return 0;
+       }
+ 
+       rpc_ep_resolve_binding(handle, SEC_AUTH_C_IFSPEC, &dce_st);
+ 
+       if (dce_st)
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("rpc_ep_resolve_binding failed - %s\n", dce_error));
+         rpc_binding_free(&handle, &dce_st);
+         continue;
+       }
+   
+       rpc_mgmt_inq_server_princ_name(handle, rpc_c_authn_dce_secret,
+                                    &server_princ_name, &dce_st);
+       
+       if (dce_st)
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("rpc_mgmt_inq_server_princ_name failed - %s\n", dce_error));
+         rpc_binding_free(&handle, &dce_st);
+         continue;
+       }
+ 
+       sec_id_parse_name(sec_rgy_default_handle, server_princ_name, NULL, NULL,
+                       princ_name, NULL, &dce_st);
+       
+       if (dce_st)
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("sec_id_parse_name failed - %s\n", dce_error));
+         rpc_binding_free(&handle, &dce_st);
+         continue;
+       }
+ 
+       {
+       int is_member = sec_rgy_pgo_is_member(sec_rgy_default_handle, sec_rgy_domain_group,
+                                             "sec_auth", princ_name, &dce_st);
+       
+       if (dce_st)
+         {
+           dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+           DEBUG(0, ("sec_rgy_pgo_is_member failed - %s\n", dce_error));
+           rpc_binding_free(&handle, &dce_st);
+           continue;
+         }
+ 
+       if (!is_member)
+         {
+           DEBUG(0, ("%s not valid sec_auth server\n", princ_name));
+           rpc_binding_free(&handle, &dce_st);
+           continue;
+         }
+       }
+   
+       rpc_binding_set_auth_info(handle, server_princ_name,
+                               rpc_c_protect_level_pkt_privacy, rpc_c_authn_dce_secret,
+                               NULL, rpc_c_authz_name, &dce_st);
+       
+       if (dce_st)
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("rpc_binding_set_auth_info failed - %s\n", dce_error));
+         rpc_binding_free(&handle, &dce_st);
+         continue;
+       }
+   
+       if (hash_type == 1)
+       {
+         sec_auth_ms_nthash(handle, username, challenge, response, (idl_byte *)&pw_entry.key.tagged_union.des_key, &dce_st);
+       }
+       else
+       {
+         sec_auth_ms_lmhash(handle, username, challenge, response, (idl_byte *)&pw_entry.key.tagged_union.des_key, &dce_st);
+       }
+ 
+       if (dce_st == error_status_ok)
+       {
+         rpc_binding_free(&handle, &dce_st);
+         rpc_binding_vector_free(&binding_vec, &dce_st);
+         break;
+       }
+       else if (dce_st == sec_rgy_passwd_invalid || dce_st == sec_rgy_not_authorized || dce_st == sec_rgy_not_implemented)
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("dce_smb_password_check: sec_auth failed for %s - %s\n", username, dce_error));
+         rpc_binding_free(&handle, &dce_st);
+         rpc_binding_vector_free(&binding_vec, &dce_st);
+         return 0;
+       }
+       else
+       {
+         dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+         DEBUG(0, ("dce_smb_password_check: sec_auth failed for %s - %s\n", username, dce_error));
+         rpc_binding_free(&handle, &dce_st);
+       }
+     }
+ 
+   if (!(dce_user = (dce_user_struct *)malloc(sizeof(dce_user_struct))))
+     {
+       DEBUG(0, ("dce_smb_password_check: unable to allocate memory for dce_user_struct"));
+       return 0;
+     }
+   
+   if (!sec_login_setup_identity(username, sec_login_no_flags, &dce_user->login_context, &dce_st))
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_smb_password_check: unable to setup identity for %s - %s\n", username, dce_error));
+       free(dce_user);
+       return 0;
+     }
+ 
+   pw_entry.pepper = NULL;
+   pw_entry.key.key_type = sec_passwd_des;
+   pw_entry.version_number = sec_passwd_c_version_none;
+   
+ #ifdef WITH_DCE_REFRESH
+   dce_user->passwd_type = sec_passwd_des;
+   memcpy(dce_user->refresh_deskey, pw_entry.key.tagged_union.des_key, sec_passwd_c_des_key_size);
+ #endif
+ 
+   if (!sec_login_valid_and_cert_ident(dce_user->login_context, &pw_entry, &reset_passwd, &auth_src, &dce_st))
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_smb_password_check: unable to validate identity for %s - %s\n", username, dce_error));
+       sec_login_purge_context(&dce_user->login_context, &dce_st);
+       free(dce_user);
+       return 0;
+     }
+ 
+   if (auth_src != sec_login_auth_src_network)
+     {
+       DEBUG(0, ("dce_smb_password_check: no network credentials for %s\n", username));
+       sec_login_purge_context(&dce_user->login_context, &dce_st);
+       free(dce_user);
+       return 0;
+     }
+ 
+   sec_login_set_context(dce_user->login_context, &dce_st);
+ 
+   if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_smb_password_check: unable to set context for %s - %s\n", username, dce_error));
+       sec_login_purge_context(&dce_user->login_context, &dce_st);
+       free(dce_user);
+       return 0;
+     }
+ 
+ #ifdef WITH_DCE_IBM_KLUDGE
+   {
+     char path[MAXPATHLEN];
+     struct passwd *pwd;
+     char *krb5ccname;
+     char *pag_str;
+     unsigned long pag;
+    
+     sec_login_get_pwent(dce_user->login_context, (sec_login_passwd_t *)&pwd, &dce_st);
+    
+ #undef snprintf
+ 
+     if (krb5ccname = getenv("KRB5CCNAME"))
+       if (pag_str = strrchr(krb5ccname, '_'))
+       {
+         pag = strtol(pag_str+1, NULL, 16);
+ 
+         snprintf(path, MAXPATHLEN, "%s/dcecred_%08x", DCE_CREDS_DIR, pag);
+         path[MAXPATHLEN-1] = '\0';
+         chown(path, pwd->pw_uid, pwd->pw_gid);
+ 
+         snprintf(path, MAXPATHLEN, "%s/dcecred_%08x.data", DCE_CREDS_DIR, pag);
+         path[MAXPATHLEN-1] = '\0';
+         chown(path, pwd->pw_uid, pwd->pw_gid);
+ 
+         snprintf(path, MAXPATHLEN, "%s/dcecred_%08x.data.db", DCE_CREDS_DIR, pag);
+         path[MAXPATHLEN-1] = '\0';
+         chown(path, pwd->pw_uid, pwd->pw_gid);
+ 
+         snprintf(path, MAXPATHLEN, "%s/dcecred_%08x.nc", DCE_CREDS_DIR, pag);
+         path[MAXPATHLEN-1] = '\0';
+         chown(path, pwd->pw_uid, pwd->pw_gid);
+       } 
+   }
+ #endif
+   
+ #ifdef WITH_DCE_WTS
+   dce_user->pag = sec_login_inq_pag(dce_user->login_context, &dce_st);
+   if (dce_st || !dce_user->pag)
+   {
+     dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+     DEBUG(0, ("dce_auth: unable to acquire pag for %s - %s\n", username, dce_error));
+     sec_login_purge_context(&dce_user->login_context, &dce_st);
+     free(dce_user);
+     return 0;
+   }
+  
+   sec_login_release_context(&dce_user->login_context, &dce_st);
+   if (dce_st)
+   {
+     dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+     DEBUG(0, ("dce_auth: sec_login_release_context failed for %s - %s\n", username, dce_error));
+     sec_login_purge_context(&dce_user->login_context, &dce_st);
+     free(dce_user);
+     return 0;
+   }
+ 
+   {
+     char import_buf[5 + strlen(DCE_CREDS_DIR) + 17 + 1];
+ 
+     sprintf(import_buf, "FILE:%s/dcecred_%08x", DCE_CREDS_DIR, dce_user->pag);
+ 
+     sec_login_import_context(sizeof(import_buf), import_buf, &dce_user->login_context, &dce_st);
+     if (dce_st)
+     {
+       dce_error_inq_text(dce_st, dce_error, &dce_error_st);
+       DEBUG(0, ("dce_auth: sec_login_import_context failed for %s - %s\n", username, dce_error));
+       sec_login_purge_context(&dce_user->login_context, &dce_st);
+       free(dce_user);
+       return 0;
+     }
+   }
+ #else
+   dce_mutex = 1;
+ #endif
+ 
+ #ifdef WITH_DCE_REFRESH
+   if (pthread_create(&dce_user->refresh_thread, pthread_attr_default, refresh_context, (void *)dce_user))
+     DEBUG(0, ("auth_dce.initialize: pthread_create failed"));
+ #endif
+ 
+   return 1;
+ }
+ 
+ #endif
+ 
+ #ifdef WITH_DFS
+ 
+ #include <netinet/in.h>
+ #include <arpa/inet.h>
+ #include <dce/dce_error.h>
+ #include <dce/rpc.h>
+ #include <dce/secsts.h>
+ #include <dce/sec_login.h>
+ #include <dce/pthread.h>
+ #include <dcedfs/param.h>
+ #include <dcedfs/afsvl_proc.h>
+ #include <dcedfs/aggr.h>
+ #include <dcedfs/cm.h>
+ #include <dcedfs/fldb_proc.h>
+ #include <dcedfs/flserver.h>
+ #include <dcedfs/ftserver.h>
+ #include <dcedfs/ftserver_proc.h>
+ #include <dcedfs/ioctl.h>
+ #include <dcedfs/vol_init.h>
+ #include <dcedfs/rep_errs.h>
+ #include <dcedfs/vol_errs.h>
+ 
+ #define FLSERVER_H_SIZE 5
+ static rpc_binding_handle_t flserver_h[FLSERVER_H_SIZE];
+ static int flserver_h_count = 0;
+ static int flserver_h_index = 0;
+ 
+ static int path_to_fid(char *path, struct afsFid *fidp)
+ {
+   struct afs_ioctl ioctl_data;
+ 
+   ioctl_data.in_size = 0;
+   ioctl_data.out_size = sizeof(afsFid);
+   ioctl_data.out = (caddr_t) fidp;
+ 
+   return (!pioctl(path, VIOCGETFID, &ioctl_data, 1));
+ }  
+ 
+ static int bind_flservers()
+ {
+   unsigned32 import_status, group_status, rpc_status;
+   rpc_ns_handle_t import_context;
+   rpc_ns_handle_t group_context;
+   unsigned_char_t *name, *string_binding, *protseq, *network_addr;
+   uuid_t obj_uuid;
+   unsigned_char_t *string_uuid;
+   rpc_binding_handle_t temp_h;
+   dce_error_string_t dce_error;
+   int dce_error_st;
+   
+ 
+   rpc_ns_entry_object_inq_begin(rpc_c_ns_syntax_default, "/.:/fs",
+                               &import_context, &import_status);
+ 
+   if (import_status)
+     {
+       dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+       DEBUG(0, ("dfsquota: bind_flservers.entry_object_inq_begin failed - %s\n", dce_error));
+       return 0;
+     }
+ 
+   rpc_ns_entry_object_inq_next(import_context, &obj_uuid, &import_status);
+ 
+   if (import_status)
+     {
+       dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+       DEBUG(0, ("dfsquota: bind_flservers.entry_object_inq_next failed - %s\n", dce_error));
+       return 0;
+     }
+ 
+   rpc_ns_entry_object_inq_done(&import_context, &import_status);
+ 
+   uuid_to_string(&obj_uuid, &string_uuid, &import_status);
+ 
+   if (import_status)
+     {
+       dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+       DEBUG(0, ("dfsquota: bind_flservers.uuid_to_string failed - %s\n", dce_error));
+       return 0;
+     }
+ 
+   rpc_ns_group_mbr_inq_begin(rpc_c_ns_syntax_default, "/.:/fs", rpc_c_ns_syntax_default,
+                              &group_context, &group_status);
+ 
+   if (group_status)
+     {
+       dce_error_inq_text(group_status, dce_error, &dce_error_st);      
+       DEBUG(0, ("dfsquota: bind_flservers.group_mbr_inq_begin failed - %s\n", dce_error));
+       return 0;
+     }
+   
+   while ((!group_status) &&  (flserver_h_count < FLSERVER_H_SIZE))
+     {
+       rpc_ns_group_mbr_inq_next(group_context, &name, &group_status);
+ 
+       if (group_status)
+         {
+           if (group_status != rpc_s_no_more_members)
+             {
+               dce_error_inq_text(group_status, dce_error, &dce_error_st);      
+             DEBUG(0, ("dfsquota: bind_flservers.group_mbr_inq_next failed - %s\n", dce_error));
+             }
+           continue;
+         }
+       
+       rpc_ns_binding_import_begin(rpc_c_ns_syntax_default, name, NULL,
+                                   NULL, &import_context, &import_status);
+       
+       if (import_status)
+         {
+           dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+         DEBUG(0, ("dfsquota: bind_flservers.binding_import_begin failed - %s\n", dce_error));
+           rpc_ns_binding_import_done(&import_context, &import_status);
+           continue;
+         }
+       
+       rpc_ns_binding_import_next(import_context, &temp_h, &import_status);
+       
+       if (import_status)
+         {
+           dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+         DEBUG(0, ("dfsquota: bind_flservers.binding_import_next failed - %s\n", dce_error));
+           rpc_ns_binding_import_done(&import_context, &import_status);
+           continue;
+         }
+       
+       rpc_binding_to_string_binding(temp_h, &string_binding, &import_status);
+       rpc_binding_free(&temp_h, &rpc_status);
+       
+       if (import_status)
+         {
+           dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+         DEBUG(0, ("dfsquota: bind_flservers.to_string_binding failed - %s\n", dce_error));
+           rpc_ns_binding_import_done(&import_context, &import_status);
+           continue;
+         }
+       
+       rpc_string_binding_parse(string_binding, NULL, &protseq, &network_addr,
+                                NULL, NULL, &import_status);
+       rpc_string_free(&string_binding, &rpc_status);
+       
+       if (import_status)
+         {
+           dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+         DEBUG(0, ("dfsquota: bind_flservers.binding_parse failed - %s\n", dce_error));
+           rpc_ns_binding_import_done(&import_context, &import_status);
+           continue;
+         }
+       
+       rpc_string_binding_compose(string_uuid,
+                                  protseq, network_addr, NULL, NULL,
+                                  &string_binding, &import_status);
+       rpc_string_free(&protseq, &rpc_status);
+       rpc_string_free(&network_addr, &rpc_status);
+       
+       if (import_status)
+         {
+           dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+         DEBUG(0, ("dfsquota: bind_flservers.binding_compose failed - %s\n", dce_error));
+           rpc_ns_binding_import_done(&import_context, &import_status);
+           continue;
+         }
+       
+       rpc_binding_from_string_binding(string_binding,
+                                       &flserver_h[flserver_h_count],
+                                       &import_status);
+       rpc_string_free(&string_binding, &rpc_status);
+       
+       if (import_status)
+         {
+           dce_error_inq_text(import_status, dce_error, &dce_error_st);      
+         DEBUG(0, ("dfsquota: bind_flservers.from_string_binding failed - %s\n", dce_error));
+         }
+       else
+         flserver_h_count++;
+       
+       rpc_ns_binding_import_done(&import_context, &import_status);
+     }
+   rpc_ns_group_mbr_inq_done(&group_context, &group_status);
+   rpc_string_free(&string_uuid, &import_status);
+ 
+   return flserver_h_count;
+ }
+ 
+ 
+ BOOL disk_quotas(char *path, SMB_BIG_UINT *bsize, SMB_BIG_UINT *dfree, SMB_BIG_UINT *dsize)
+ {
+   struct afsFid fidp;
+   struct vldbentry fl_entry;
+   unsigned32 status, status2;
+   unsigned_char_t *string_binding;
+   rpc_binding_handle_t ftserver_h;
+   struct ftserver_status ft_status;
+   struct afsHyper hyper;
+   unsigned32 ft_quota, ft_used;
+   int index;
+   
+   if (flserver_h_count == 0)
+     if (!bind_flservers())
+       {
+       DEBUG(0, ("dfsquota: retrying flserver bind\n"));
+       if (!bind_flservers())
+         {
+           DEBUG(0, ("dfsquota: unable to bind to any flservers\n"));
+           return 0;
+         }
+       }
+   
+   if (!path_to_fid(path, &fidp))
+     {
+       DEBUG(0, ("dfsquota: path_to_fid failed for %s\n", path));
+       return 0;
+     }
+   
+   for(index = 0; index < flserver_h_count; index++)
+     {
+       error_status_t reset_status;
+       
+       status = VL_GetEntryByID(flserver_h[flserver_h_index], &fidp.Volume, -1, &fl_entry);
+       
+       if (!(status >= rpc_s_mod && status <= rpc_s_mod+4096))
+         break;
+ 
+       rpc_binding_reset(flserver_h[flserver_h_index], &reset_status);
+       flserver_h_index = ((flserver_h_index + 1) % flserver_h_count);
+     }
+   
+   if (status)
+     {
+       DEBUG(0, ("dfsquota - VL_GetEntryByID failed - %d\n", status));
+       return 0;
+     }
+   
+   flserver_h_index = ((flserver_h_index + 1) % flserver_h_count);
+   
+   rpc_string_binding_compose(NULL, "ncadg_ip_udp",
+                              inet_ntoa(((struct sockaddr_in *)(&fl_entry.siteAddr[0]))->sin_addr),
+                              NULL, NULL, &string_binding, &status);
+   
+   if (status)
+     return 0;
+   
+   rpc_binding_from_string_binding(string_binding, &ftserver_h, &status);
+   rpc_string_free(&string_binding, &status2);
+   
+   if (status)
+     return 0;
+ 
+   status = FTSERVER_GetOneVolStatus(ftserver_h, &fidp.Volume,
+                                   fl_entry.sitePartition[0], 0, &ft_status);
+ 
+   rpc_binding_free(&ftserver_h, &status2);
+ 
+   if (status)
+     {
+       DEBUG(0, ("dfsquota: ftserver call failed - %d\n", status));
+       return 0;
+     }
+   
+   ft_quota = ((0xffc00000 & (AFS_hgethi(ft_status.vsd.visQuotaLimit) << 22)) | (0x003fffff & (AFS_hgetlo(ft_status.vsd.visQuotaLimit) >> 10)));
+ 
+   ft_used = ((0xffc00000 & (AFS_hgethi(ft_status.vsd.visQuotaUsage) << 22)) | (0x003fffff & (AFS_hgetlo(ft_status.vsd.visQuotaUsage) >> 10)));
+ 
+   *bsize = 1024;
+   *dfree = (ft_quota - ft_used) <= 0 ? 0 : (ft_quota - ft_used);
+   *dsize = ft_quota;
+   return 1;
+ }
+ 
+ #endif
+ #endif
diff -d -r -c samba-2.2.0a/source/smbd/dosmode.c samba-2.2.0a-dce-2.5/source/smbd/dosmode.c
*** samba-2.2.0a/source/smbd/dosmode.c	Fri Apr 13 16:24:46 2001
--- samba-2.2.0a-dce-2.5/source/smbd/dosmode.c	Tue Jul  3 12:59:14 2001
***************
*** 124,130 ****
--- 124,134 ----
  
    DEBUG(8,("dos_mode: %s\n", path));
  
+ #ifdef WITH_DFS
+   if (access(path, W_OK))
+ #else
    if ((sbuf->st_mode & S_IWUSR) == 0)
+ #endif
        result |= aRONLY;
  
    if (MAP_ARCHIVE(conn) && ((sbuf->st_mode & S_IXUSR) != 0))
diff -d -r -c samba-2.2.0a/source/smbd/password.c samba-2.2.0a-dce-2.5/source/smbd/password.c
*** samba-2.2.0a/source/smbd/password.c	Thu Apr 12 18:52:29 2001
--- samba-2.2.0a-dce-2.5/source/smbd/password.c	Tue Jul  3 15:18:13 2001
***************
*** 119,124 ****
--- 119,138 ----
  	return NULL;
  }
  
+ #ifdef WITH_DCE
+ void invalidate_all_vuids()
+ {
+ 	user_struct *usp;
+ 
+ 	for (usp=validated_users;usp;usp=usp->next) {
+ 		if (usp->dce_user)
+ 		{
+ 			dce_logout(usp->dce_user);
+ 		}
+ 	}
+ }
+ #endif
+ 
  /****************************************************************************
  invalidate a uid
  ****************************************************************************/
***************
*** 131,136 ****
--- 145,155 ----
  
  	DLIST_REMOVE(validated_users, vuser);
  
+ #ifdef WITH_DCE
+ 	if (vuser->dce_user)
+ 		dce_logout(vuser->dce_user);
+ #endif
+ 	
  	safe_free(vuser->groups);
  	delete_nt_token(&vuser->nt_user_token);
  	safe_free(vuser);
***************
*** 238,243 ****
--- 257,266 ----
  	return token;
  }
  
+ #ifdef WITH_DCE
+ extern dce_user_struct *dce_user;
+ #endif
+ 
  /****************************************************************************
  register a uid/name pair as being valid and that a valid password
  has been given. vuid is biased by an offset. This allows us to
***************
*** 281,286 ****
--- 304,313 ----
  	vuser->vuid = next_vuid;
  	vuser->uid = uid;
  	vuser->gid = gid;
+ #ifdef WITH_DCE
+ 	vuser->dce_user = dce_user;
+ 	dce_user = NULL;
+ #endif
  	vuser->guest = guest;
  	fstrcpy(vuser->user.unix_name,unix_name);
  	fstrcpy(vuser->user.smb_name,requested_name);
***************
*** 459,467 ****
  		   use it (ie. does it exist in the smbpasswd file).
  		*/
  		DEBUG(4,("smb_password_ok: Checking NT MD4 password\n"));
! 		if (smb_password_check((char *)nt_pass, 
! 				       (uchar *)smb_pass->smb_nt_passwd, 
! 				       challenge)) {
  			DEBUG(4,("NT MD4 password check succeeded\n"));
  			return(True);
  		}
--- 486,498 ----
  		   use it (ie. does it exist in the smbpasswd file).
  		*/
  		DEBUG(4,("smb_password_ok: Checking NT MD4 password\n"));
! 
! #ifdef WITH_DCE_ENCRYPTED
! 		if (dce_smb_password_check(smb_pass->smb_name, challenge, nt_pass, 1))
! #else
! 		if (smb_password_check((char *)nt_pass, (uchar *)smb_pass->smb_nt_passwd, challenge))
! #endif
! 		{
  			DEBUG(4,("NT MD4 password check succeeded\n"));
  			return(True);
  		}
***************
*** 480,488 ****
  		return True;
  	}
  
! 	if((smb_pass->smb_passwd != NULL) && 
! 	   smb_password_check((char *)lm_pass, 
! 			      (uchar *)smb_pass->smb_passwd, challenge)) {
  		DEBUG(4,("LM MD4 password check succeeded\n"));
  		return(True);
  	}
--- 511,524 ----
  		return True;
  	}
  
! #ifdef WITH_DCE_ENCRYPTED
! 	if((smb_pass->smb_passwd != NULL) &&
! 	   dce_smb_password_check(smb_pass->smb_name, challenge, lm_pass, 0))
! #else
! 	if((smb_pass->smb_passwd != NULL) &&
! 	   smb_password_check((char *)lm_pass, (uchar *)smb_pass->smb_passwd, challenge))
! #endif WITH_DCE_ENCRYPTED
! 	{
  		DEBUG(4,("LM MD4 password check succeeded\n"));
  		return(True);
  	}
***************
*** 567,572 ****
--- 603,612 ----
  	return False;
  }
  
+ #ifdef WITH_DCE_ENCRYPTED
+ BOOL dce_update_encrypted_pw(char *user, char *password);
+ #endif
+ 
  /****************************************************************************
  check if a username/password pair is OK either via the system password
  database or the encrypted SMB password database
***************
*** 605,611 ****
  
  	return pass_check(user, password, pwlen, pwd, 
  			  lp_update_encrypted() ? 
! 			  update_smbpassword_file : NULL);
  }
  
  /****************************************************************************
--- 645,658 ----
  
  	return pass_check(user, password, pwlen, pwd, 
  			  lp_update_encrypted() ? 
! #ifdef WITH_DCE_ENCRYPTED
! 			  dce_update_encrypted_pw
! #else
! 			  update_smbpassword_file
! #endif /* WITH_DCE_ENCRYPTED */
! 			  : NULL
! 			  );
! 	
  }
  
  /****************************************************************************
diff -d -r -c samba-2.2.0a/source/smbd/quotas.c samba-2.2.0a-dce-2.5/source/smbd/quotas.c
*** samba-2.2.0a/source/smbd/quotas.c	Thu Apr  5 13:46:17 2001
--- samba-2.2.0a-dce-2.5/source/smbd/quotas.c	Mon Jul  2 11:20:40 2001
***************
*** 41,47 ****
  
  #endif /* VXFS_QUOTA */
  
! #ifdef LINUX
  
  #include <sys/types.h>
  #include <asm/types.h>
--- 41,51 ----
  
  #endif /* VXFS_QUOTA */
  
! #ifdef WITH_DFS
! 
! BOOL disk_quotas(char *path, SMB_BIG_UINT *bsize, SMB_BIG_UINT *dfree, SMB_BIG_UINT *dsize);
! 
! #elif LINUX
  
  #include <sys/types.h>
  #include <asm/types.h>
diff -d -r -c samba-2.2.0a/source/smbd/sec_ctx.c samba-2.2.0a-dce-2.5/source/smbd/sec_ctx.c
*** samba-2.2.0a/source/smbd/sec_ctx.c	Tue Feb 20 16:11:58 2001
--- samba-2.2.0a-dce-2.5/source/smbd/sec_ctx.c	Tue Jul  3 12:44:13 2001
***************
*** 23,32 ****
--- 23,39 ----
  
  extern int DEBUGLEVEL;
  extern struct current_user current_user;
+ #ifdef WITH_DCE_WTS
+ extern char dce_krb5ccname[];
+ extern char *dce_krb5ccname_pag;
+ #endif
  
  struct sec_ctx {
  	uid_t uid;
  	uid_t gid;
+ #ifdef WITH_DCE_WTS
+         unsigned long dce_pag;
+ #endif
  	int ngroups;
  	gid_t *groups;
  	NT_USER_TOKEN *token;
***************
*** 274,279 ****
--- 281,289 ----
  
  	ctx_p->uid = geteuid();
  	ctx_p->gid = getegid();
+ #ifdef WITH_DCE_WTS
+ 	ctx_p->dce_pag = getpag();
+ #endif
  
   	DEBUG(3, ("push_sec_ctx(%d, %d) : sec_ctx_stack_ndx = %d\n", 
   		  ctx_p->uid, ctx_p->gid, sec_ctx_stack_ndx ));
***************
*** 301,307 ****
--- 311,321 ----
   Set the current security context to a given user.
  ****************************************************************************/
  
+ #ifdef WITH_DCE_WTS
+ void set_sec_ctx(uid_t uid, gid_t gid, unsigned long dce_pag, int ngroups, gid_t *groups, NT_USER_TOKEN *token)
+ #else
  void set_sec_ctx(uid_t uid, gid_t gid, int ngroups, gid_t *groups, NT_USER_TOKEN *token)
+ #endif
  {
  	struct sec_ctx *ctx_p = &sec_ctx_stack[sec_ctx_stack_ndx];
  	
***************
*** 342,348 ****
--- 356,378 ----
  
  	ctx_p->uid = uid;
  	ctx_p->gid = gid;
+ #ifdef WITH_DCE_WTS
+ 	ctx_p->dce_pag = dce_pag;
+ 	if (uid == 0) {
+ 	  resetpag();
+ 	  *dce_krb5ccname = 'X';
+ 	}
+ 	else {
+ 	  installpag(dce_pag);
+ 	  *dce_krb5ccname = 'K';
+ 
+ #undef sprintf
+ 
+ 	  sprintf(dce_krb5ccname_pag, "%08x", dce_pag);
+ 	}
  
+ 	current_user.dce_pag = dce_pag;
+ #endif
  	/* Update current_user stuff */
  
  	current_user.uid = uid;
***************
*** 360,366 ****
--- 390,400 ----
  {
  	/* May need to worry about supplementary groups at some stage */
  
+ #ifdef WITH_DCE_WTS
+ 	set_sec_ctx(0, 0, 0, 0, NULL, NULL);
+ #else
  	set_sec_ctx(0, 0, 0, NULL, NULL);
+ #endif
  }
  
  /****************************************************************************
***************
*** 405,410 ****
--- 439,458 ----
  
  	become_id(prev_ctx_p->uid, prev_ctx_p->gid);
  
+ #ifdef WITH_DCE_WTS
+ 	if (prev_ctx_p->uid == 0) {
+ 	  resetpag();
+ 	  *dce_krb5ccname = 'X';
+ 	}
+ 	else {
+ 	  installpag(prev_ctx_p->dce_pag);
+ 	  *dce_krb5ccname = 'K';
+ 	  sprintf(dce_krb5ccname_pag, "%08x", prev_ctx_p->dce_pag);
+ 	}
+ 
+ 	current_user.dce_pag = prev_ctx_p->dce_pag;
+ #endif
+ 
  	/* Update current_user stuff */
  
  	current_user.uid = prev_ctx_p->uid;
***************
*** 439,444 ****
--- 487,500 ----
  
  	ctx_p->uid = geteuid();
  	ctx_p->gid = getegid();
+ #ifdef WITH_DCE_WTS
+         if (ctx_p->uid == 0)
+ 	  ctx_p->dce_pag = 0;
+ 	else
+ 	  ctx_p->dce_pag = getpag();
+ 
+ 	current_user.dce_pag = ctx_p->dce_pag;
+ #endif
  
  	get_current_groups(&ctx_p->ngroups, &ctx_p->groups);
  
diff -d -r -c samba-2.2.0a/source/smbd/server.c samba-2.2.0a-dce-2.5/source/smbd/server.c
*** samba-2.2.0a/source/smbd/server.c	Sun Apr  8 23:36:14 2001
--- samba-2.2.0a-dce-2.5/source/smbd/server.c	Tue Jul  3 12:56:45 2001
***************
*** 38,47 ****
  
  extern pstring user_socket_options;
  
- #ifdef WITH_DFS
- extern int dcelogin_atmost_once;
- #endif /* WITH_DFS */
- 
  extern fstring remote_machine;
  
  /* really we should have a top level context structure that has the
--- 38,43 ----
***************
*** 449,458 ****
      respond_to_all_remaining_local_messages();
  	decrement_smbd_process_count();
  
! #ifdef WITH_DFS
! 	if (dcelogin_atmost_once) {
! 		dfs_unlogin();
! 	}
  #endif
  
  	if (!reason) {   
--- 445,452 ----
      respond_to_all_remaining_local_messages();
  	decrement_smbd_process_count();
  
! #ifdef WITH_DCE
! 	invalidate_all_vuids();
  #endif
  
  	if (!reason) {   
***************
*** 796,801 ****
--- 790,799 ----
  		exit(1);
  	}
  
+ #ifdef WITH_DCE_WTS
+ 	dce_init();
+ #endif
+ 	
  	smbd_process();
  	
  	exit_server("normal exit");
diff -d -r -c samba-2.2.0a/source/smbd/service.c samba-2.2.0a-dce-2.5/source/smbd/service.c
*** samba-2.2.0a/source/smbd/service.c	Thu Apr 12 21:09:39 2001
--- samba-2.2.0a-dce-2.5/source/smbd/service.c	Fri Jun 29 16:15:40 2001
***************
*** 198,204 ****
--- 198,206 ----
         iService = find_service(defservice);
         if (iService >= 0)
         {
+ #ifndef WITH_CALPOLY_UNDERSCORE
           all_string_sub(service,"_","/",0);
+ #endif
           iService = lp_add_service(service,iService);
         }
       }
diff -d -r -c samba-2.2.0a/source/smbd/uid.c samba-2.2.0a-dce-2.5/source/smbd/uid.c
*** samba-2.2.0a/source/smbd/uid.c	Sun Apr 15 16:31:29 2001
--- samba-2.2.0a-dce-2.5/source/smbd/uid.c	Tue Jul  3 12:17:45 2001
***************
*** 52,58 ****
--- 52,63 ----
  	initgroups(guest_name, guest_gid);
  #endif
  	
+ #ifdef WITH_DCE_WTS
+ 	set_sec_ctx(guest_uid, guest_gid, 0, 0, NULL, NULL);
+ #else
  	set_sec_ctx(guest_uid, guest_gid, 0, NULL, NULL);
+ #endif
+ 	
  	
  	current_user.conn = NULL;
  	current_user.vuid = UID_FIELD_INVALID;
***************
*** 146,151 ****
--- 151,163 ----
  		token = vuser->nt_user_token;
  	}
  
+ #ifdef WITH_DCE_WTS
+ 	if (vuser->dce_user)
+ 		current_user.dce_pag = vuser->dce_user->pag;
+ 	else
+ 		current_user.dce_pag = 0;
+ #endif
+ 	
  	/*
  	 * See if we should force group for this service.
  	 * If so this overrides any group set in the force
***************
*** 187,193 ****
--- 199,210 ----
  		must_free_token = True;
  	}
  	
+ #ifdef WITH_DCE_WTS
+ 	set_sec_ctx(uid, gid, current_user.dce_pag, current_user.ngroups, current_user.groups, token);
+ #else
  	set_sec_ctx(uid, gid, current_user.ngroups, current_user.groups, token);
+ #endif
+ 	
  
  	/*
  	 * Free the new token (as set_sec_ctx copies it).
***************
*** 218,223 ****
--- 235,243 ----
  
  	current_user.conn = NULL;
  	current_user.vuid = UID_FIELD_INVALID;
+ #ifdef WITH_DCE_WTS
+ 	current_user.dce_pag = 0;
+ #endif
  
  	return(True);
  }
***************
*** 236,243 ****
--- 256,268 ----
  		return False;
  	}
  
+ #ifdef WITH_DCE_WTS
+ 	set_sec_ctx(p->pipe_user.uid, p->pipe_user.gid, p->pipe_user.dce_pag,
+ 		    p->pipe_user.ngroups, p->pipe_user.groups, p->pipe_user.nt_user_token);
+ #else
  	set_sec_ctx(p->pipe_user.uid, p->pipe_user.gid, 
  		    p->pipe_user.ngroups, p->pipe_user.groups, p->pipe_user.nt_user_token);
+ #endif
  
  	return True;
  }
